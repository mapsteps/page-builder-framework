!function(e,t,i,n,a){var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r="function"==typeof l[n]&&l[n],d=r.cache||{},s="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function o(t,i){if(!d[t]){if(!e[t]){var a="function"==typeof l[n]&&l[n];if(!i&&a)return a(t,!0);if(r)return r(t,!0);if(s&&"string"==typeof t)return s(t);var u=Error("Cannot find module '"+t+"'");throw u.code="MODULE_NOT_FOUND",u}f.resolve=function(i){var n=e[t][1][i];return null!=n?n:i},f.cache={};var c=d[t]=new o.Module(t);e[t][0].call(c.exports,f,c,c.exports,l)}return d[t].exports;function f(e){var t=f.resolve(e);return!1===t?{}:o(t)}}o.isParcelRequire=!0,o.Module=function(e){this.id=e,this.bundle=o,this.exports={}},o.modules=e,o.cache=d,o.parent=r,o.register=function(t,i){e[t]=[function(e,t){t.exports=i},{}]},Object.defineProperty(o,"root",{get:function(){return l[n]}}),l[n]=o;for(var u=0;u<t.length;u++)o(t[u]);if(i){var c=o(i);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd&&define(function(){return c})}}({kkxt2:[function(e,t,i,n){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(i),window.wp.customize&&(window.wp.customize.controlConstructor["wpbf-responsive-builder"]=window.wp.customize.wpbfDynamicControl.extend({isSaving:!1,form:void 0,draggableData:void 0,emptyWidgetItemMarkup:"<div class='widget-item empty-widget-item'>&nbsp;</div>",availableWidgetsPanel:void 0,builderPanel:void 0,initWpbfControl:function(e){(e=e||this)&&(e.setting?.bind(t=>{e.updateComponentState?.(t)}),e.buildAvailableWidgetsPanel?.(),e.buildBuilderPanel?.(),e.initDraggable?.(),e.initDroppable?.(),window.setTimeout(()=>{e.initSortable?.()},1))},isSortableEmpty:function(e){let t=this.findHtmlEls?.(e,".widget-item");if(!t||!t.length)return!0;for(let e=0;e<t.length;e++){let i=t[e];if(!(i.classList.contains("empty-widget-item")||i.classList.contains("ui-sortable-placeholder"))&&!i.classList.contains("ui-sortable-helper"))return!1}return!0},isWidgetActive:function(e){return!!this.params&&this.params.builder.activeWidgetKeys.includes(e)},findWidgetByKey:function(e){if(!this.params)return;let t=this.params.builder.availableWidgets;if(t.length){for(let i of t)if(i.key===e)return i}},buildAvailableWidgetsPanel:function(){let e=this;if(!e.container)return;let t=e.params;if(!t)return;let i=e.findHtmlEl?.(e.container[0],".available-widgets-panel");if(!i)return;e.availableWidgetsPanel=i,jQuery(document.body).append('<div class="widget-drag-helper"></div>');let n=t.builder.availableWidgets,a=jQuery("<div></div>").addClass("builder-widgets available-widgets").appendTo(e.availableWidgetsPanel);n.forEach(t=>{let i=t.key;jQuery("<div></div>").addClass(`widget-item widget-item-${i} ${e.isWidgetActive?.(i)?"disabled":""}`).attr("data-widget-key",i).attr("draggable","true").html(`<span class="widget-label">${t.label}</span>`).on("click",function(i){e.handleWidgetClick?.(this,t)}).appendTo(a)})},buildBuilderPanel:function(){let e=this,t=e.params;if(!t)return;let i=t.builder.availableRows,n=t.builder.availableWidgets;if(!i||!n)return;let a=e.findHtmlEl?.("#customize-preview");if(!a)return;let l=jQuery("<div></div>").addClass(`wpbf-builder-panel ${t.id}-builder-panel`).attr("data-wpbf-builder-panel",t.id).insertAfter(a);i.forEach(i=>{let n=jQuery("<div></div>").addClass("builder-row").attr("data-row-key",i.key).appendTo(l),a=jQuery("<div></div>").addClass("builder-inner-row").appendTo(n);jQuery("<div></div>").addClass("row-label").attr("data-row-key",i.key).text(i.label).appendTo(n),jQuery("<button></button>").addClass("row-setting-button").attr("data-row-key",i.key).html('<i class="dashicons dashicons-admin-generic"></i>').on("click",()=>e.handleRowSettingClick?.(i.key)).appendTo(n);let r=t.value[i.key];i.columns.forEach((t,n)=>{let l="";t.key.endsWith("_start")?l="wpbf-content-start":t.key.endsWith("_end")?l="wpbf-content-end":0!==n&&n!==i.columns.length-1&&(l="wpbf-content-center column-middle"),0===n?l+=" column-start wpbf-content-start":n===i.columns.length-1&&(l+=" column-end wpbf-content-end");let d=jQuery("<div></div>").addClass(`builder-widgets builder-column sortable-widgets wpbf-flex ${l}`).attr("data-column-key",t.key).appendTo(a),s="empty-widget-list";if(!r||!Object.keys(r).length){d.addClass(s),d.html(e.emptyWidgetItemMarkup??"");return}let o=r[t.key];if(!o||!o.length){d.addClass(s),d.html(e.emptyWidgetItemMarkup??"");return}o.forEach(t=>{let i=e.createWidgetItem?.(t,!0);i&&d.append(i)})}),e.bindCustomizeSection?.(i.key)}),e.builderPanel=l[0]},handleRowSettingClick:function(e){window.wp.customize?.section(`wpbf_header_builder_${e}_section`,function(e){e.expand(e.params)})},bindCustomizeSection:function(e){window.wp.customize?.section(`wpbf_header_builder_${e}_section`,function(t){t.expanded.bind(function(t){let i=document.querySelector(`.builder-row[data-row-key="${e}"]`);i&&(t?i.classList.add("is-active"):i.classList.remove("is-active"))})})},handleWidgetClick:function(e,t){if(!e.classList.contains("ui-sortable-handle")&&!e.classList.contains("disabled")||!t.section)return;let i=window.wp.customize?.section(t.section);i&&i.params&&i.expand(i.params)},initDraggable:function(){let e=this;if(!e.params||!e.availableWidgetsPanel||!e.builderPanel)return;let t=e.findHtmlEl?.(".widget-drag-helper");if(!t)return;let i=e.findHtmlEls?.(e.availableWidgetsPanel,".widget-item");i&&i.length&&i.forEach(i=>{i instanceof HTMLElement&&(i.addEventListener("dragstart",function(n){if(!(n instanceof DragEvent))return;document.body.classList.add("is-dragging-widget"),i.classList.add("is-dragging"),t.classList.add("is-shown");let a=i.dataset.widgetKey;if(!a)return;e.draggableData={widgetKey:a},n.dataTransfer?.setData("text",JSON.stringify({widgetKey:a})),t.innerHTML=i.outerHTML;let l=i.getBoundingClientRect(),r=l.left,d=l.top;t.style.left=r+"px",t.style.top=d+"px";let s=e.findHtmlEl?.(t,".widget-item"),o=s?.getBoundingClientRect(),u=o?.width||80;t.style.width=u+"px",n.dataTransfer?.setDragImage(t,0,0),window.setTimeout(()=>{t.classList.remove("is-shown")},10)}),i.addEventListener("dragend",function(n){n instanceof DragEvent&&(n.preventDefault(),i.classList.remove("is-dragging"),document.body.classList.remove("is-dragging-widget"),t.classList.remove("is-shown"),t.innerHTML="",t.removeAttribute("style"),e.draggableData=void 0)}))})},initDroppable:function(){let e=this;if(!e.params||!e.availableWidgetsPanel||!e.builderPanel)return;let t=e.findHtmlEls?.(e.builderPanel,".builder-column");t&&t.length&&t.forEach(t=>{t.addEventListener("dragenter",function(e){e instanceof DragEvent&&(e.preventDefault(),t.classList.add("dragover"))}),t.addEventListener("dragover",function(e){e.preventDefault()}),t.addEventListener("dragleave",function(e){e instanceof DragEvent&&(e.preventDefault(),t.classList.remove("dragover"))}),t.addEventListener("drop",function(i){if(!(i instanceof DragEvent))return;i.preventDefault(),t.classList.remove("dragover");let n=e.getWidgetItemFromDraggableData?.(i);if(!n)return;let a=n.dataset.widgetKey;if(!a)return;let l=e.createWidgetItem?.(a,!0);if(!l)return;let r=t.querySelector(".ui-sortable-placeholder.from-available-widgets");r&&t.removeChild(r),t.classList.contains("column-end")?t.insertBefore(l,t.firstChild):t.appendChild(l);let d=t.querySelector(".empty-widget-item");d&&d.remove(),jQuery(t).sortable("refresh"),n.classList.add("disabled"),e.draggableData=void 0,e.updateCustomizerSetting?.()})})},parseDraggableData:function(e){let t;let i=e.dataTransfer?.getData("text");if(i){try{t=JSON.parse(i)}catch(e){console.error("Error parsing JSON data:",e)}if(t)return t}},getWidgetItemFromDraggableData:function(e){if(!e.dataTransfer?.getData("text"))return;let t=this.parseDraggableData?.(e);if(!t)return;let i=t.widgetKey;if(i)return this.findHtmlEl?.(this.availableWidgetsPanel,`.widget-item[data-widget-key="${i}"]`)},createWidgetItem:function(e,t){let i=this,n=i.findWidgetByKey?.(e);if(!n)return;let a=i.findHtmlEl?.(i.availableWidgetsPanel,`.widget-item[data-widget-key="${e}"]`);if(!a)return;let l=a.cloneNode(!0);if(l instanceof HTMLElement){if(l.classList.remove("disabled"),l.classList.remove("is-dragging"),l.removeAttribute("draggable"),t){let e=document.createElement("button");e.type="button",e.className="widget-button delete-widget-button",e.innerHTML='<i class="dashicons dashicons-no-alt"></i>',l.appendChild(e),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),i.handleDeleteActiveWidget?.(l,a)}),l.addEventListener("click",function(e){e.preventDefault(),i.handleWidgetClick?.(this,n)})}return l}},initSortable:function(){let e=this;e.params&&e.availableWidgetsPanel&&e.builderPanel&&(jQuery(".sortable-widgets").sortable({connectWith:".builder-column",placeholder:"widget-item",start:function(t,i){document.body.classList.add("is-sorting-widget");let n=e.findHtmlEl?.(i.item[0],".widget-label");n&&i.placeholder[0].appendChild(n.cloneNode(!0))},update:function(t,i){let n=t.target;n instanceof HTMLElement&&(e.checkSortableContent?.(n),e.updateCustomizerSetting?.())},stop:function(e,t){document.body.classList.remove("is-sorting-widget")}}),jQuery(".builder-column.column-middle").on("sortover",function(e,t){e.target.classList.remove("empty-widget-list")}),jQuery(".builder-column.column-middle").on("sortout",function(t,i){e.checkSortableContent?.(t.target)}))},handleDeleteActiveWidget:function(e,t){t?.classList.remove("disabled");let i=e.closest(".sortable-widgets");e.remove(),i instanceof HTMLElement&&this.checkSortableContent?.(i),i&&jQuery(i).sortable("refresh"),this.updateCustomizerSetting?.()},checkSortableContent:function(e){let t="empty-widget-list",i=e.querySelector(".empty-widget-item");this.isSortableEmpty?.(e)?(e.classList.add(t),i||jQuery(e).append(this.emptyWidgetItemMarkup??"")):(e.classList.remove(t),i&&i.remove())},destroySortable:function(){this.availableWidgetsPanel&&this.builderPanel&&jQuery(".builder-column").sortable("destroy")},updateCustomizerSetting:function(){let e=this;e.isSaving||(e.isSaving=!0,setTimeout(()=>{let t=e.findHtmlEls?.(e.builderPanel,".builder-row");if(!t||!t.length){e.isSaving=!1;return}let i={};t.forEach(t=>{let n=t.dataset.rowKey;if(!n)return;i[n]={};let a=e.findHtmlEls?.(t,".builder-column.sortable-widgets");a&&a.length&&a.forEach(t=>{let a=t.dataset.columnKey;if(!a)return;i[n][a]=[];let l=e.findHtmlEls?.(t,".widget-item");l&&l.length&&l.forEach(e=>{if(e.classList.contains("empty-widget-item")||e.classList.contains("ui-sortable-placeholder"))return;let t=e.dataset.widgetKey;t&&i[n][a].push(t)})})}),e.setting?.set(i),e.isSaving=!1},1))},updateComponentState:function(e){}}))},{"@parcel/transformer-js/src/esmodule-helpers.js":"3VvNb"}],"3VvNb":[function(e,t,i,n){i.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},i.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.exportAll=function(e,t){return Object.keys(e).forEach(function(i){"default"===i||"__esModule"===i||Object.prototype.hasOwnProperty.call(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[i]}})}),t},i.export=function(e,t,i){Object.defineProperty(e,t,{enumerable:!0,get:i})}},{}]},["kkxt2"],"kkxt2","parcelRequire94c2");
//# sourceMappingURL=responsive-builder-control-min.js.map
