{"version":3,"file":"controls-bundle-min.js","sources":["../../Base/src/control-dependencies.ts","../../Base/src/tooltips.ts","../../Base/src/base-control.ts","../../../../assets/js/utils/dom-util.js","../../Responsive/src/responsive-control.ts","../../Checkbox/src/checkbox-control.ts","../../../../node_modules/.pnpm/colord@2.9.3/node_modules/colord/index.mjs","../../Color/src/components/ColorPickerSwatches.tsx","../../Generic/src/number-util.ts","../../Color/src/utils/misc.ts","../../Color/src/components/ColorPickerInput.tsx","../../Color/src/hooks/useFocusOutside.ts","../../Color/src/hooks/useClickOutside.ts","../../../../node_modules/.pnpm/react-colorful@5.6.1_react-_49b246a3ee1fb7a92c96bf645deb1c98/node_modules/react-colorful/dist/index.mjs","../../Color/src/components/ColorPickerComponent.tsx","../../Color/src/components/ColorPickerCircleTrigger.tsx","../../Color/src/components/ControlLabel.tsx","../../Color/src/components/ControlHeader.tsx","../../Color/src/utils/convert-color-for-input.ts","../../Color/src/utils/convert-color-for-picker.ts","../../Color/src/ColorForm.tsx","../../Color/src/hooks/useWindowResize.ts","../../../../node_modules/.pnpm/react-dom@18.3.1_react@18.3.1/node_modules/react-dom/client.js","../../Color/src/utils/convert-color-for-customizer.ts","../../Color/src/ColorControl.tsx","../../Color/src/MulticolorForm.tsx","../../Color/src/MulticolorControl.tsx","../../Generic/src/string-util.ts","../../Responsive/src/responsive-util.ts","../../MarginPadding/src/margin-padding-util.ts","../../Responsive/src/DeviceButtons.tsx","../../MarginPadding/src/MarginPaddingForm.tsx","../../MarginPadding/src/MarginPaddingControl.tsx","../../Color/src/color-control.ts","../../Dimension/src/dimension-control.ts","../../Editor/src/editor-control.ts","../../Generic/src/generic-control.ts","../../Generic/src/assoc-array-control.ts","../../Generic/src/responsive-generic-control.ts","../../MarginPadding/src/margin-padding-control.ts","../../Media/src/image-control.ts","../../Radio/src/radio-control.ts","../../Repeater/src/repeater-row.tsx","../../Slider/src/SliderForm.tsx","../../Slider/src/slider-util.ts","../../Slider/src/InputSliderForm.tsx","../../Slider/src/ResponsiveInputSliderForm.tsx","../../Typography/src/typography-control.ts","../../Repeater/src/repeater-control.ts","../../Select/src/select-control.ts","../../Slider/src/slider-control.ts","../../Slider/src/SliderControl.tsx","../../Slider/src/input-slider-control.ts","../../Slider/src/InputSliderControl.tsx","../../Slider/src/responsive-input-slider-control.ts","../../Slider/src/ResponsiveInputSliderControl.tsx","../../Sortable/src/sortable-control.ts","../../Builder/src/builder-control.ts","../../Builder/src/responsive-builder-control.ts"],"sourcesContent":["import _ from \"lodash\";\r\nimport {\r\n\tWpbfControlDependencies,\r\n\tWpbfReversedControlDependencies,\r\n\tWpbfReversedControlDependency,\r\n} from \"./base-interface\";\r\n\r\nexport default function setupControlDependencies(\r\n\tglobalControlDependencies: WpbfControlDependencies,\r\n) {\r\n\tif (!window.wp.customize) return;\r\n\tconst reversedControlDependencies: WpbfReversedControlDependencies = {};\r\n\r\n\tfor (const dependantControlId in globalControlDependencies) {\r\n\t\tif (!globalControlDependencies.hasOwnProperty(dependantControlId)) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tconst controlDependencies = globalControlDependencies[dependantControlId];\r\n\r\n\t\tfor (const dependency of controlDependencies) {\r\n\t\t\tlet dependencySettingId = dependency.setting;\r\n\r\n\t\t\t// Backwards compatibility.\r\n\t\t\tif (!dependencySettingId && dependency.id) {\r\n\t\t\t\tdependencySettingId = dependency.id;\r\n\t\t\t}\r\n\r\n\t\t\tif (!dependencySettingId) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (!reversedControlDependencies[dependencySettingId]) {\r\n\t\t\t\treversedControlDependencies[dependencySettingId] = [];\r\n\t\t\t}\r\n\r\n\t\t\treversedControlDependencies[dependencySettingId].push({\r\n\t\t\t\tdependantControlId: dependantControlId,\r\n\t\t\t\toperator: dependency.operator,\r\n\t\t\t\tvalue: dependency.value,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconst customizer = window.wp.customize;\r\n\r\n\tcustomizer.bind(\"ready\", function () {\r\n\t\tfor (const dependencySettingId in reversedControlDependencies) {\r\n\t\t\tif (!reversedControlDependencies.hasOwnProperty(dependencySettingId)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlistenDependencyControl(dependencySettingId);\r\n\t\t}\r\n\t});\r\n\r\n\tfunction listenDependencyControl(dependencySettingId: string) {\r\n\t\tcustomizer(dependencySettingId, function (setting) {\r\n\t\t\tconst rules = reversedControlDependencies[dependencySettingId];\r\n\r\n\t\t\thandleRulesCondition(dependencySettingId, setting.get(), rules);\r\n\r\n\t\t\tsetting.bind(function (newValue: string) {\r\n\t\t\t\thandleRulesCondition(dependencySettingId, newValue, rules);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction handleRulesCondition(\r\n\t\tdependencySettingId: string,\r\n\t\tnewValue: string,\r\n\t\trules: WpbfReversedControlDependency[],\r\n\t) {\r\n\t\tfor (const ruleSet of rules) {\r\n\t\t\tlet isDependencySatisfied = isRuleSatisfied(\r\n\t\t\t\tnewValue,\r\n\t\t\t\truleSet.operator,\r\n\t\t\t\truleSet.value,\r\n\t\t\t);\r\n\r\n\t\t\tif (!isDependencySatisfied) {\r\n\t\t\t\thideControl(ruleSet.dependantControlId);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst dependantDependencies =\r\n\t\t\t\tglobalControlDependencies[ruleSet.dependantControlId];\r\n\r\n\t\t\tif (dependantDependencies.length < 2) {\r\n\t\t\t\tshowControl(ruleSet.dependantControlId);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet otherRulesSatisfied = true;\r\n\r\n\t\t\tfor (const dependantDependency of dependantDependencies) {\r\n\t\t\t\tlet dependantDependencySettingId = dependantDependency.setting;\r\n\r\n\t\t\t\t// Backwards compatibility.\r\n\t\t\t\tif (!dependantDependencySettingId && dependantDependency.id) {\r\n\t\t\t\t\tdependantDependencySettingId = dependantDependency.id;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!dependantDependencySettingId) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dependantDependencySettingId === dependencySettingId) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst dependantDependencyValue = customizer(\r\n\t\t\t\t\tdependantDependencySettingId,\r\n\t\t\t\t).get();\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t!isRuleSatisfied(\r\n\t\t\t\t\t\tdependantDependencyValue,\r\n\t\t\t\t\t\tdependantDependency.operator,\r\n\t\t\t\t\t\tdependantDependency.value,\r\n\t\t\t\t\t)\r\n\t\t\t\t) {\r\n\t\t\t\t\totherRulesSatisfied = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!otherRulesSatisfied) {\r\n\t\t\t\thideControl(ruleSet.dependantControlId);\r\n\t\t\t} else {\r\n\t\t\t\tshowControl(ruleSet.dependantControlId);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction hideControl(controlId: string) {\r\n\t\tif (insideInactiveTab(customizer.control(controlId)?.container[0])) {\r\n\t\t\tcustomizer\r\n\t\t\t\t.control(controlId)\r\n\t\t\t\t?.container.removeClass(\"wpbf-tab-item-hidden\");\r\n\r\n\t\t\tcustomizer\r\n\t\t\t\t.control(controlId)\r\n\t\t\t\t?.container.addClass(\"wpbf-tab-item-invisible\");\r\n\t\t}\r\n\r\n\t\tcustomizer.control(controlId)?.onChangeActive(false, {\r\n\t\t\tcompleteCallback: () => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tcustomizer\r\n\t\t\t\t\t\t.control(controlId)\r\n\t\t\t\t\t\t?.container.hasClass(\"wpbf-tab-item-invisible\")\r\n\t\t\t\t) {\r\n\t\t\t\t\tcustomizer\r\n\t\t\t\t\t\t.control(controlId)\r\n\t\t\t\t\t\t?.container.removeClass(\"wpbf-tab-item-invisible\");\r\n\r\n\t\t\t\t\tcustomizer\r\n\t\t\t\t\t\t.control(controlId)\r\n\t\t\t\t\t\t?.container.addClass(\"wpbf-tab-item-hidden\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tfunction showControl(controlId: string) {\r\n\t\tcustomizer.control(controlId)?.onChangeActive(true, {});\r\n\t}\r\n}\r\n\r\nfunction insideInactiveTab(el: HTMLElement | undefined | null) {\r\n\tif (!el) return false;\r\n\tif (!el.dataset.wpbfParentTabId) return false;\r\n\tif (!el.classList.contains(\"wpbf-tab-item-hidden\")) return false;\r\n\treturn true;\r\n}\r\n\r\nexport function isRuleSatisfied(\r\n\tactualValue: any,\r\n\toperator: string,\r\n\texpectedValue: any,\r\n): boolean {\r\n\toperator = operator.trim().toLowerCase();\r\n\r\n\tswitch (operator) {\r\n\t\tcase \"==\":\r\n\t\t\treturn actualValue == expectedValue;\r\n\t\tcase \"===\":\r\n\t\t\treturn actualValue === expectedValue;\r\n\t\tcase \"!=\":\r\n\t\t\treturn actualValue != expectedValue;\r\n\t\tcase \"!==\":\r\n\t\t\treturn actualValue !== expectedValue;\r\n\t\tcase \">\":\r\n\t\t\treturn actualValue > expectedValue;\r\n\t\tcase \">=\":\r\n\t\t\treturn actualValue >= expectedValue;\r\n\t\tcase \"<\":\r\n\t\t\treturn actualValue < expectedValue;\r\n\t\tcase \"<=\":\r\n\t\t\treturn actualValue <= expectedValue;\r\n\t\tcase \"in\":\r\n\t\t\treturn compareInOperator(actualValue, expectedValue);\r\n\t\tcase \"not in\":\r\n\t\t\treturn !compareInOperator(actualValue, expectedValue);\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction compareInOperator(actualValue: any, expectedValue: any): boolean {\r\n\tif (Array.isArray(expectedValue)) {\r\n\t\tconst expectedValueArray: any[] = expectedValue;\r\n\t\tlet found = false;\r\n\r\n\t\tif (Array.isArray(actualValue)) {\r\n\t\t\tconst actualValueArray: any[] = actualValue;\r\n\r\n\t\t\tfor (let i = 0; i < actualValueArray.length; ++i) {\r\n\t\t\t\tif (expectedValueArray.includes(actualValueArray[i])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (expectedValueArray.includes(actualValue)) {\r\n\t\t\t\tfound = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn found;\r\n\t}\r\n\r\n\tif (Array.isArray(actualValue)) {\r\n\t\tconst actualValueArray: any[] = actualValue;\r\n\t\treturn actualValueArray.includes(expectedValue);\r\n\t}\r\n\r\n\tif (_.isObject(actualValue)) {\r\n\t\tconst actualValueObj: Record<string, any> = actualValue;\r\n\r\n\t\tif (!_.isUndefined(actualValueObj[expectedValue])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfor (const prop in actualValueObj) {\r\n\t\t\tif (!actualValueObj.hasOwnProperty(prop)) continue;\r\n\r\n\t\t\tif (actualValueObj[prop] === expectedValue) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (\"string\" === typeof actualValue) {\r\n\t\tif (\"string\" === typeof expectedValue) {\r\n\t\t\treturn (\r\n\t\t\t\t-1 < expectedValue.indexOf(actualValue) &&\r\n\t\t\t\t-1 < actualValue.indexOf(expectedValue)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn -1 < expectedValue.indexOf(actualValue);\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n","import { WpbfCustomizeControl, WpbfCustomizeControlParams } from \"./base-interface\";\r\nimport _ from \"lodash\";\r\n\r\ndeclare var wpbfCustomizerTooltips: {\r\n\tid: string;\r\n\tcontent: string;\r\n}[];\r\n\r\nexport function wpbfSetupTooltips(customizer: WpbfCustomize) {\r\n\tlet sectionNames: string[] = [];\r\n\r\n\tcustomizer.control.each(function (\r\n\t\tcontrol: WpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>,\r\n\t) {\r\n\t\tif (!sectionNames.includes(control.section())) {\r\n\t\t\tsectionNames.push(control.section());\r\n\t\t}\r\n\r\n\t\tcustomizer.section(control.section(), function (section) {\r\n\t\t\tif (\r\n\t\t\t\tsection.expanded() ||\r\n\t\t\t\tcustomizer.settings.autofocus.control === control.id\r\n\t\t\t) {\r\n\t\t\t\twpbfInjectTooltip(control);\r\n\t\t\t} else {\r\n\t\t\t\tsection.expanded.bind(function (expanded) {\r\n\t\t\t\t\tif (expanded) {\r\n\t\t\t\t\t\twpbfInjectTooltip(control);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tconst tooltipStyleTag = document.createElement(\"style\");\r\n\tconst sidebarOverlay = document.querySelector(\r\n\t\t\".wp-full-overlay-sidebar-content\",\r\n\t);\r\n\r\n\ttooltipStyleTag.classList.add(\"wpbf-tooltip-inline-styles\");\r\n\tdocument.head.appendChild(tooltipStyleTag);\r\n\r\n\tsectionNames.forEach(function (sectionName) {\r\n\t\tif (!sidebarOverlay) return;\r\n\r\n\t\tcustomizer.section(sectionName, function (section) {\r\n\t\t\tsection.expanded.bind(function (expanded) {\r\n\t\t\t\tif (expanded) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tsection.contentContainer &&\r\n\t\t\t\t\t\tsection.contentContainer[0].scrollHeight >\r\n\t\t\t\t\t\t\tsidebarOverlay.clientHeight\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\ttooltipStyleTag.innerHTML =\r\n\t\t\t\t\t\t\t\".wpbf-tooltip-wrapper span.tooltip-content {min-width: 258px;}\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttooltipStyleTag.innerHTML = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction wpbfInjectTooltip(\r\n\tcontrol: WpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>,\r\n) {\r\n\t_.each(wpbfCustomizerTooltips, function (tooltip) {\r\n\t\tif (tooltip.id !== control.id) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (control.container.find(\".tooltip-content\").length) return;\r\n\r\n\t\tconst target = document.querySelector(\r\n\t\t\t\"#customize-control-\" + tooltip.id + \" .customize-control-title\",\r\n\t\t);\r\n\r\n\t\tif (!target) return;\r\n\t\ttarget.classList.add(\"wpbf-tooltip-wrapper\");\r\n\r\n\t\t// Build the tooltip trigger.\r\n\t\tconst trigger = document.createElement(\"span\");\r\n\t\ttrigger.classList.add(\"tooltip-trigger\");\r\n\t\ttrigger.innerHTML = '<span class=\"dashicons dashicons-editor-help\"></span>';\r\n\r\n\t\t// Build the tooltip content.\r\n\t\tconst content = document.createElement(\"span\");\r\n\t\tcontent.classList.add(\"tooltip-content\");\r\n\t\tcontent.innerHTML = tooltip.content;\r\n\r\n\t\t// Append the trigger & content next to the control's title.\r\n\t\ttarget.appendChild(trigger);\r\n\t\ttarget.appendChild(content);\r\n\t});\r\n}\r\n","import _ from \"lodash\";\n\nimport setupControlDependencies from \"./control-dependencies\";\nimport { wpbfSetupTooltips } from \"./tooltips\";\nimport {\n\tWpbfCustomizeControl,\n\tWpbfCustomizeControlParams,\n\tWpbfCustomizeElement,\n} from \"./base-interface\";\n\n/**\n * This file was taken from Kirki.\n *\n * The majority of the code in this file\n * is derived from the wp-customize-posts plugin\n * and the work of @westonruter to whom I am very grateful.\n *\n * @see https://github.com/xwp/wp-customize-posts\n */\n\n(function (customizer) {\n\tif (!customizer) return;\n\n\tcustomizer.wpbfDynamicControl = customizer.Control.extend<\n\t\tWpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>\n\t>({\n\t\tinitialize: function initialize(\n\t\t\tthis: WpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>,\n\t\t\tid: string,\n\t\t\tparams: WpbfCustomizeControlParams<any>,\n\t\t) {\n\t\t\tconst control = this;\n\n\t\t\tif (!params.type) {\n\t\t\t\tparams.type = \"wpbf-generic\";\n\t\t\t}\n\n\t\t\tlet className = \"\";\n\n\t\t\tif (params.content) {\n\t\t\t\tlet splits = params.content.split('class=\"');\n\t\t\t\tsplits = splits[1].split('\"');\n\t\t\t\tclassName = splits[0];\n\t\t\t} else {\n\t\t\t\tclassName = \"customize-control customize-control-\" + params.type;\n\t\t\t}\n\n\t\t\tif (params.content) {\n\t\t\t\tconst $content = jQuery(params.content);\n\t\t\t\t$content.attr(\n\t\t\t\t\t\"id\",\n\t\t\t\t\t\"customize-control-\" + id.replace(/]/g, \"\").replace(/\\[/g, \"-\"),\n\t\t\t\t);\n\t\t\t\t$content.attr(\"class\", className);\n\n\t\t\t\tconst wrapperAttrs = params[\"wrapperAttrs\"] ?? {};\n\n\t\t\t\t_.each(wrapperAttrs, function (val: any, key: string) {\n\t\t\t\t\tif (\"class\" === key) {\n\t\t\t\t\t\tval = val.replace(\"{default_class}\", className);\n\t\t\t\t\t}\n\n\t\t\t\t\t$content.attr(key, val);\n\t\t\t\t});\n\n\t\t\t\t// Hijack the container to add wrapperAttrs.\n\t\t\t\tparams.content = $content.prop(\"outerHTML\");\n\t\t\t}\n\n\t\t\tcontrol.propertyElements = [];\n\t\t\tcustomizer.Control.prototype.initialize.call(control, id, params);\n\t\t\twindow.wp.hooks.doAction(\n\t\t\t\t\"wpbf.dynamicControl.init.after\",\n\t\t\t\tid,\n\t\t\t\tcontrol,\n\t\t\t\tparams,\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Add bidirectional data binding links between inputs and the setting(s).\n\t\t *\n\t\t * This is copied from api.Control.prototype.initialize(). It\n\t\t * should be changed in Core to be applied once the control is embedded.\n\t\t */\n\t\t_setUpSettingRootLinks: function _setUpSettingRootLinks(\n\t\t\tthis: WpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>,\n\t\t) {\n\t\t\tconst control = this;\n\t\t\tconst nodes = control.container.find(\"[data-customize-setting-link]\");\n\n\t\t\tnodes.each(function (i, el) {\n\t\t\t\tconst node = jQuery(this);\n\t\t\t\tconst settingKey = this.dataset.customizeSettingLink;\n\t\t\t\tif (!settingKey) return;\n\n\t\t\t\tcustomizer(settingKey, function (setting) {\n\t\t\t\t\t// @ts-ignore The `new` operator has TS error (not runtime error).\n\t\t\t\t\tconst element = new customizer.Element(node);\n\t\t\t\t\tcontrol.elements.push(element);\n\t\t\t\t\telement.sync(setting);\n\t\t\t\t\telement.set(setting());\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Add bidirectional data binding links between inputs and the setting properties.\n\t\t */\n\t\t_setUpSettingPropertyLinks: function _setUpSettingPropertyLinks(\n\t\t\tthis: WpbfCustomizeControl<any, WpbfCustomizeControlParams<any>>,\n\t\t) {\n\t\t\tconst control = this;\n\t\t\tlet nodes;\n\n\t\t\tif (!control.setting) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnodes = control.container.find(\"[data-customize-setting-property-link]\");\n\n\t\t\tnodes.each(function () {\n\t\t\t\tconst node = jQuery(this);\n\t\t\t\tlet element: WpbfCustomizeElement;\n\t\t\t\tlet propertyName = node.data(\"customizeSettingPropertyLink\");\n\n\t\t\t\t// @ts-ignore The `new` operator has TS error (not runtime error).\n\t\t\t\telement = new customizer.Element(node);\n\t\t\t\tcontrol.propertyElements.push(element);\n\n\t\t\t\tif (!control.setting || typeof control.setting !== \"function\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\telement.set(control.setting()[propertyName]);\n\n\t\t\t\telement.bind(function (newPropertyValue) {\n\t\t\t\t\tif (!control.setting || typeof control.setting !== \"function\") {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet newSetting = control.setting();\n\n\t\t\t\t\tif (newPropertyValue === newSetting[propertyName]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tnewSetting = _.clone(newSetting);\n\t\t\t\t\tnewSetting[propertyName] = newPropertyValue;\n\t\t\t\t\tcontrol.setting.set(newSetting);\n\t\t\t\t});\n\n\t\t\t\tcontrol.setting.bind(function (newValue) {\n\t\t\t\t\tif (newValue[propertyName] !== element.get()) {\n\t\t\t\t\t\telement.set(newValue[propertyName]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * @inheritdoc\n\t\t */\n\t\tready: function ready() {\n\t\t\tthis._setUpSettingRootLinks?.();\n\t\t\tthis._setUpSettingPropertyLinks?.();\n\n\t\t\tcustomizer.Control.prototype.ready.call(this);\n\n\t\t\tthis.deferred?.embedded.done(() => {\n\t\t\t\tthis.initWpbfControl?.();\n\n\t\t\t\twindow.wp.hooks.doAction(\n\t\t\t\t\t\"wpbf.dynamicControl.ready.deferred.embedded.done\",\n\t\t\t\t\tthis,\n\t\t\t\t);\n\t\t\t});\n\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.ready.after\", this);\n\t\t},\n\n\t\t/**\n\t\t * Embed the control in the document.\n\t\t *\n\t\t * Override the embed() method to do nothing,\n\t\t * so that the control isn't embedded on load,\n\t\t * unless the containing section is already expanded.\n\t\t */\n\t\tembed: function embed() {\n\t\t\tlet sectionId = this.section?.();\n\t\t\tif (!sectionId) return;\n\n\t\t\tcustomizer.section(sectionId, (section) => {\n\t\t\t\tif (\n\t\t\t\t\t\"wpbf-expanded\" === section.params.type ||\n\t\t\t\t\tsection.expanded() ||\n\t\t\t\t\tcustomizer.settings.autofocus.control === this.id\n\t\t\t\t) {\n\t\t\t\t\tthis.actuallyEmbed?.();\n\t\t\t\t} else {\n\t\t\t\t\tsection.expanded.bind((expanded) => {\n\t\t\t\t\t\tif (expanded) this.actuallyEmbed?.();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.embed.after\", this);\n\t\t},\n\n\t\t/**\n\t\t * Deferred embedding of control when actually\n\t\t *\n\t\t * This function is called in Section.onChangeExpanded() so the control\n\t\t * will only get embedded when the Section is first expanded.\n\t\t */\n\t\tactuallyEmbed: function actuallyEmbed() {\n\t\t\t// Already embedded - skip.\n\t\t\tif (this.isEmbedded) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if this is a re-embed (was previously embedded then destroyed).\n\t\t\tconst isReembed = this.wasEmbedded === true;\n\n\t\t\tif (isReembed) {\n\t\t\t\t// Re-embed: call reinitialize instead of full init flow.\n\t\t\t\tthis.reinitialize?.();\n\t\t\t\tthis.isEmbedded = true;\n\t\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.actuallyEmbed.reembed\", this);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// First embed: full initialization flow.\n\t\t\tthis.renderContent?.();\n\n\t\t\t// This triggers control.ready().\n\t\t\tthis.deferred?.embedded.resolve();\n\t\t\tthis.isEmbedded = true;\n\t\t\tthis.wasEmbedded = true;\n\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.actuallyEmbed.after\", this);\n\t\t},\n\n\t\t/**\n\t\t * Re-initialize the control after being destroyed.\n\t\t * Override this in controls that need custom re-initialization.\n\t\t */\n\t\treinitialize: function reinitialize() {\n\t\t\tthis.renderContent?.();\n\t\t\tthis.initWpbfControl?.();\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.reinitialize.after\", this);\n\t\t},\n\n\t\t/**\n\t\t * This is not working with autofocus.\n\t\t */\n\t\tfocus: function focus(args: Record<string, any>) {\n\t\t\tthis.actuallyEmbed?.();\n\t\t\tcustomizer.Control.prototype.focus.call(this, args);\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.focus.after\", this);\n\t\t},\n\n\t\t/**\n\t\t * Additional actions that run on ready.\n\t\t */\n\t\tinitWpbfControl: function initWpbfControl(ctrl) {\n\t\t\twindow.wp.hooks.doAction(\"wpbf.dynamicControl.initWpbfControl\", this);\n\n\t\t\tconst control = this;\n\n\t\t\t// Save the value\n\t\t\tthis.container?.on(\"change input paste click\", \"input\", function () {\n\t\t\t\tcontrol.setting?.set(this.value);\n\t\t\t});\n\t\t},\n\n\t\tdestroy: function () {\n\t\t\tthis.container?.off(\"change input paste click\", \"input\");\n\t\t\tthis.isEmbedded = false;\n\t\t},\n\n\t\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\n\t\t\tthis.setting?.set(val);\n\t\t},\n\n\t\tfindHtmlEl: function findHtmlEl(elOrSelector, selector) {\n\t\t\tif (!elOrSelector) return undefined;\n\n\t\t\tif (typeof elOrSelector === \"string\") {\n\t\t\t\tconst result = document.querySelector(elOrSelector);\n\n\t\t\t\treturn result instanceof HTMLElement ? result : undefined;\n\t\t\t}\n\n\t\t\tif (!selector) return undefined;\n\n\t\t\tconst result = elOrSelector.querySelector(selector);\n\n\t\t\treturn result instanceof HTMLElement ? result : undefined;\n\t\t},\n\n\t\tfindHtmlEls: function findHtmlEls(elOrSelector, selector) {\n\t\t\tif (!elOrSelector) return [];\n\n\t\t\tif (typeof elOrSelector === \"string\") {\n\t\t\t\tconst result = document.querySelectorAll(elOrSelector);\n\n\t\t\t\treturn Array.from(result).filter((el) => el instanceof HTMLElement);\n\t\t\t}\n\n\t\t\tif (!selector) return [];\n\n\t\t\tconst result = elOrSelector.querySelectorAll(selector);\n\n\t\t\treturn Array.from(result).filter((el) => el instanceof HTMLElement);\n\t\t},\n\t});\n\n\tcustomizer.bind(\"ready\", () => {\n\t\twpbfSetupTooltips(customizer);\n\t});\n\n\tif (window.wpbfCustomizerControlDependencies) {\n\t\tsetupControlDependencies(window.wpbfCustomizerControlDependencies);\n\t}\n\n\t/**\n\t * Set the value and trigger all bound callbacks.\n\t */\n\tcustomizer.Value.prototype.set = function (to: any) {\n\t\tconst from = this._value;\n\n\t\tto = this._setter.apply(this, arguments);\n\t\tto = this.validate(to);\n\n\t\t// Bail if the sanitized value is null or unchanged.\n\t\tif (null === to || _.isEqual(from, to)) {\n\t\t\treturn this;\n\t\t}\n\n\t\t/**\n\t\t * This was brought from Kirki.\n\t\t * But this is too much for now.\n\t\t *\n\t\t * Start Kirki mod.\n\t\t */\n\t\t/*\n\t\tlet parentSetting;\n\t\tlet newVal;\n\t\tif (this.id && api.control(this.id) && api.control(this.id).params && api.control(this.id).params.parent_setting) {\n\t\t\tparentSetting = api.control(this.id).params.parent_setting;\n\t\t\tnewVal = {};\n\t\t\tnewVal[this.id.replace(parentSetting + '[', '').replace(']', '')] = to;\n\t\t\tapi.control(parentSetting).setting.set(jQuery.extend({}, api.control(parentSetting).setting._value, newVal));\n\t\t}\n\t\t*/\n\n\t\t// End Kirki mod.\n\n\t\tthis._value = to;\n\t\tthis._dirty = true;\n\n\t\tthis.callbacks.fireWith(this, [to, from]);\n\n\t\treturn this;\n\t};\n\n\t/**\n\t * Get the value.\n\t */\n\tcustomizer.Value.prototype.get = function () {\n\t\t/**\n\t\t * This was brought from Kirki.\n\t\t * But this is too much for now.\n\t\t *\n\t\t * Start Kirki mod.\n\t\t */\n\t\t/*\n\t\tlet parentSetting;\n\n\t\tif (this.id && api.control(this.id) && api.control(this.id).params && api.control(this.id).params.parent_setting) {\n\t\t\tparentSetting = api.control(this.id).params.parent_setting;\n\t\t\treturn api.control(parentSetting).setting.get()[this.id.replace(parentSetting + '[', '').replace(']', '')];\n\t\t}\n\t\t*/\n\t\t// End Kirki mod.\n\n\t\treturn this._value;\n\t};\n})(window.wp.customize);\n","/**\r\n * Iterates over a collection of elements and applies a function to each.\r\n *\r\n * @param {string|NodeListOf<Element>|HTMLElement[]} selector - Either a NodeList obtained from document.querySelectorAll() or a CSS selector string.\r\n * @param {function(Element): void} handler - The function to be applied to each element. Accepts one parameter, which is the element.\r\n *\r\n * @returns {void}\r\n */\r\nexport function forEachEl(selector, handler) {\r\n\tif (\r\n\t\t!(selector instanceof NodeList) &&\r\n\t\t!Array.isArray(selector) &&\r\n\t\ttypeof selector !== \"string\"\r\n\t) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (typeof handler !== \"function\") return;\r\n\r\n\tconst elms =\r\n\t\tselector instanceof NodeList || Array.isArray(selector)\r\n\t\t\t? selector\r\n\t\t\t: document.querySelectorAll(selector);\r\n\r\n\tif (!elms.length) return;\r\n\r\n\tfor (let i = 0; i < elms.length; i++) {\r\n\t\tconst elm = elms[i];\r\n\r\n\t\tif (elm instanceof HTMLElement) {\r\n\t\t\thandler(elm);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Check whether we're inside customizer or not.\r\n *\r\n * @returns {boolean} Whether we're inside customizer or not.\r\n */\r\nexport function isInsideCustomizer() {\r\n\treturn window.wp && window.wp.customize ? true : false;\r\n}\r\n\r\n/**\r\n * @type {WpbfBreakpoints}\r\n */\r\nconst defaultBreakpoints = {\r\n\tdesktop: 1024,\r\n\ttablet: 768,\r\n\tmobile: 480,\r\n};\r\n\r\n/**\r\n * Get breakpoint by device type.\r\n *\r\n * Retrieve breakpoint based on body class,\r\n * then set it as the value of top level `breakpoints` variable.\r\n *\r\n * @param {\"desktop\"|\"tablet\"|\"mobile\"} device - The device type. Accepts 'desktop', 'tablet', or 'mobile'.\r\n * @returns {number} The breakpoint value.\r\n */\r\nfunction getBreakpointValue(device) {\r\n\tlet breakpoint = defaultBreakpoints[device] || 0;\r\n\r\n\tconst matchRule = \"wpbf-\" + device + \"-breakpoint-[\\\\w-]*\\\\b\";\r\n\tconst breakpointClassMatch = document.body.className.match(matchRule);\r\n\r\n\tif (!breakpointClassMatch) {\r\n\t\treturn breakpoint;\r\n\t}\r\n\r\n\tconst breakpointMatch = breakpointClassMatch.toString().match(/\\d+/);\r\n\r\n\tconst breakpointValue = Array.isArray(breakpointMatch)\r\n\t\t? parseInt(breakpointMatch[0], 10)\r\n\t\t: 0;\r\n\r\n\treturn breakpointValue;\r\n}\r\n\r\n/**\r\n * Get breakpoint values for desktop, tablet, and mobile.\r\n *\r\n * @returns {WpbfBreakpoints} breakpoints The breakpoints object.\r\n */\r\nexport function getBreakpoints() {\r\n\tlet breakpoints = defaultBreakpoints;\r\n\r\n\tbreakpoints.desktop = getBreakpointValue(\"desktop\");\r\n\tbreakpoints.tablet = getBreakpointValue(\"tablet\");\r\n\tbreakpoints.mobile = getBreakpointValue(\"mobile\");\r\n\r\n\treturn breakpoints;\r\n}\r\n\r\n/**\r\n * Get the current active breakpoint.\r\n *\r\n * @returns {string} - The active breakpoint. Accepts 'desktop', 'tablet', or 'mobile'.\r\n */\r\nexport function getActiveBreakpoint() {\r\n\tconst breakpoints = getBreakpoints();\r\n\tconst windowWidth = document.documentElement.clientWidth;\r\n\r\n\tlet activeBreakpoint = \"desktop\";\r\n\r\n\tif (windowWidth > breakpoints.desktop) {\r\n\t\treturn activeBreakpoint;\r\n\t}\r\n\r\n\tif (windowWidth > breakpoints.tablet) {\r\n\t\tactiveBreakpoint = \"tablet\";\r\n\t} else {\r\n\t\tactiveBreakpoint = \"mobile\";\r\n\t}\r\n\r\n\treturn activeBreakpoint;\r\n}\r\n","import { forEachEl } from \"../../../../assets/js/utils/dom-util\";\n\ndeclare var wp: {\n\tcustomize: WpbfCustomize;\n};\n\nwp.customize.bind(\"ready\", function () {\n\tinit();\n});\n\nfunction init() {\n\tlistenDevicePreviewSwitch();\n\n\t// Loop through wpbf device buttons and assign the event.\n\tjQuery(document).on(\n\t\t\"click\",\n\t\t\".wpbf-device-buttons .wpbf-device-button\",\n\t\tfunction (e) {\n\t\t\tconst device = (this as HTMLButtonElement).dataset.wpbfDevice;\n\t\t\tif (!device) return;\n\n\t\t\tswitchPreviewButtons(device);\n\n\t\t\t// Trigger WordPress device event.\n\t\t\twp.customize.previewedDevice.set(device);\n\t\t},\n\t);\n}\n\n/**\n * Listen device switch event and switch our device buttons accordingly.\n */\nfunction listenDevicePreviewSwitch() {\n\t// Bind device changes from WordPress default.\n\twp.customize.previewedDevice.bind(function (device: string) {\n\t\tswitchPreviewButtons(device);\n\t});\n}\n\n/**\n * Setup WPBF device preview.\n *\n * @param string device The device (mobile, tablet, or desktop).\n */\nfunction switchPreviewButtons(device: string) {\n\tforEachEl(\".wpbf-device-buttons .wpbf-device-button\", function (el) {\n\t\tif (!(el instanceof HTMLButtonElement)) return;\n\n\t\tif (device === el.dataset.wpbfDevice) {\n\t\t\tel.classList.add(\"is-active\");\n\t\t} else {\n\t\t\tel.classList.remove(\"is-active\");\n\t\t}\n\t});\n\n\tforEachEl(\".wpbf-control-device\", function (el) {\n\t\tif (!(el instanceof HTMLButtonElement)) return;\n\n\t\tif (device === el.dataset.wpbfDevice) {\n\t\t\tel.classList.add(\"is-active\");\n\t\t} else {\n\t\t\tel.classList.remove(\"is-active\");\n\t\t}\n\t});\n\n\t// Switch the label to target first input field in current device mode.\n\tforEachEl(\".responsive-control\", function (el) {\n\t\tif (!(el instanceof HTMLButtonElement)) return;\n\n\t\tconst setting = el.dataset.wpbfSetting;\n\t\tconst id = `${setting ?? \"\"}-${device}`;\n\t\tconst label = el.querySelector(\"label.customize-control-label\");\n\n\t\tif (label && label instanceof HTMLLabelElement) {\n\t\t\tlabel.htmlFor = id;\n\t\t}\n\t});\n}\n","import {\r\n\tWpbfCheckboxButtonsetControl,\r\n\tWpbfCheckboxControl,\r\n} from \"./checkbox-interface\";\r\n\r\n((customizer: WpbfCustomize | undefined) => {\r\n\tif (!customizer) return;\r\n\r\n\tcustomizer.controlConstructor[\"wpbf-checkbox\"] =\r\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfCheckboxControl>({\r\n\t\t\tinitWpbfControl: function (ctrl) {\r\n\t\t\t\tconst control = ctrl || this;\r\n\r\n\t\t\t\tcontrol.container?.on(\"change\", \"input\", function () {\r\n\t\t\t\t\tcontrol.setting?.set(jQuery(this).is(\":checked\"));\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n\r\n\tcustomizer.controlConstructor[\"wpbf-toggle\"] =\r\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfCheckboxControl>({\r\n\t\t\tinitWpbfControl: function (ctrl) {\r\n\t\t\t\tconst control = ctrl || this;\r\n\r\n\t\t\t\tcontrol.container?.on(\"change\", \"input\", function () {\r\n\t\t\t\t\tcontrol.setting?.set(jQuery(this).is(\":checked\"));\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n\r\n\tcustomizer.controlConstructor[\"wpbf-checkbox-buttonset\"] =\r\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfCheckboxButtonsetControl>({\r\n\t\t\tcurrentValue: undefined,\r\n\r\n\t\t\tinitWpbfControl: function (ctrl) {},\r\n\r\n\t\t\tready: function () {\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tthis.currentValue = this.setting?.get();\r\n\r\n\t\t\t\tthis.container?.on(\"change\", \".switch-input\", (e) => {\r\n\t\t\t\t\tconst values: string[] = [];\r\n\r\n\t\t\t\t\tif (!control.container) return values;\r\n\r\n\t\t\t\t\tconst fields = control.container[0].querySelectorAll(\r\n\t\t\t\t\t\t\".switch-input:checked\",\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\t\tif (!(field instanceof HTMLInputElement)) return;\r\n\t\t\t\t\t\tvalues.push(field.value);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tcontrol.setting?.set(values);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.setting?.bind((val) => {\r\n\t\t\t\t\tcontrol.updateComponentState?.(val);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tupdateComponentState: function (val) {\r\n\t\t\t\tif (this.currentValue === val) return;\r\n\t\t\t\tif (!this.container) return;\r\n\r\n\t\t\t\tconst fields = this.container[0].querySelectorAll(\".switch-input\");\r\n\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\tif (!(field instanceof HTMLInputElement)) return;\r\n\t\t\t\t\tfield.checked = val.includes(field.value);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n})(window.wp.customize);\r\n","var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(r){return\"string\"==typeof r?r.length>0:\"number\"==typeof r},n=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*r)/n+0},e=function(r,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),r>n?n:r>t?r:t},u=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},a=function(r){return{r:e(r.r,0,255),g:e(r.g,0,255),b:e(r.b,0,255),a:e(r.a)}},o=function(r){return{r:n(r.r),g:n(r.g),b:n(r.b),a:n(r.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(r){var t=r.toString(16);return t.length<2?\"0\"+t:t},h=function(r){var t=r.r,n=r.g,e=r.b,u=r.a,a=Math.max(t,n,e),o=a-Math.min(t,n,e),i=o?a===t?(n-e)/o:a===n?2+(e-t)/o:4+(t-n)/o:0;return{h:60*(i<0?i+6:i),s:a?o/a*100:0,v:a/255*100,a:u}},b=function(r){var t=r.h,n=r.s,e=r.v,u=r.a;t=t/360*6,n/=100,e/=100;var a=Math.floor(t),o=e*(1-n),i=e*(1-(t-a)*n),s=e*(1-(1-t+a)*n),h=a%6;return{r:255*[e,i,o,o,s,e][h],g:255*[s,e,e,i,o,o][h],b:255*[o,o,s,e,e,i][h],a:u}},g=function(r){return{h:u(r.h),s:e(r.s,0,100),l:e(r.l,0,100),a:e(r.a)}},d=function(r){return{h:n(r.h),s:n(r.s),l:n(r.l),a:n(r.a,3)}},f=function(r){return b((n=(t=r).s,{h:t.h,s:(n*=((e=t.l)<50?e:100-e)/100)>0?2*n/(e+n)*100:0,v:e+n,a:t.a}));var t,n,e},c=function(r){return{h:(t=h(r)).h,s:(u=(200-(n=t.s))*(e=t.v)/100)>0&&u<200?n*e/100/(u<=100?u:200-u)*100:0,l:u/2,a:t.a};var t,n,e,u},l=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*,\\s*([+-]?\\d*\\.?\\d+)%\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,p=/^hsla?\\(\\s*([+-]?\\d*\\.?\\d+)(deg|rad|grad|turn)?\\s+([+-]?\\d*\\.?\\d+)%\\s+([+-]?\\d*\\.?\\d+)%\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,v=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*(?:,\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,m=/^rgba?\\(\\s*([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s+([+-]?\\d*\\.?\\d+)(%)?\\s*(?:\\/\\s*([+-]?\\d*\\.?\\d+)(%)?\\s*)?\\)$/i,y={string:[[function(r){var t=i.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:4===r.length?n(parseInt(r[3]+r[3],16)/255,2):1}:6===r.length||8===r.length?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:8===r.length?n(parseInt(r.substr(6,2),16)/255,2):1}:null:null},\"hex\"],[function(r){var t=v.exec(r)||m.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},\"rgb\"],[function(t){var n=l.exec(t)||p.exec(t);if(!n)return null;var e,u,a=g({h:(e=n[1],u=n[2],void 0===u&&(u=\"deg\"),Number(e)*(r[u]||1)),s:Number(n[3]),l:Number(n[4]),a:void 0===n[5]?1:Number(n[5])/(n[6]?100:1)});return f(a)},\"hsl\"]],object:[[function(r){var n=r.r,e=r.g,u=r.b,o=r.a,i=void 0===o?1:o;return t(n)&&t(e)&&t(u)?a({r:Number(n),g:Number(e),b:Number(u),a:Number(i)}):null},\"rgb\"],[function(r){var n=r.h,e=r.s,u=r.l,a=r.a,o=void 0===a?1:a;if(!t(n)||!t(e)||!t(u))return null;var i=g({h:Number(n),s:Number(e),l:Number(u),a:Number(o)});return f(i)},\"hsl\"],[function(r){var n=r.h,a=r.s,o=r.v,i=r.a,s=void 0===i?1:i;if(!t(n)||!t(a)||!t(o))return null;var h=function(r){return{h:u(r.h),s:e(r.s,0,100),v:e(r.v,0,100),a:e(r.a)}}({h:Number(n),s:Number(a),v:Number(o),a:Number(s)});return b(h)},\"hsv\"]]},N=function(r,t){for(var n=0;n<t.length;n++){var e=t[n][0](r);if(e)return[e,t[n][1]]}return[null,void 0]},x=function(r){return\"string\"==typeof r?N(r.trim(),y.string):\"object\"==typeof r&&null!==r?N(r,y.object):[null,void 0]},I=function(r){return x(r)[1]},M=function(r,t){var n=c(r);return{h:n.h,s:e(n.s+100*t,0,100),l:n.l,a:n.a}},H=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},$=function(r,t){var n=c(r);return{h:n.h,s:n.s,l:e(n.l+100*t,0,100),a:n.a}},j=function(){function r(r){this.parsed=x(r)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return null!==this.parsed},r.prototype.brightness=function(){return n(H(this.rgba),2)},r.prototype.isDark=function(){return H(this.rgba)<.5},r.prototype.isLight=function(){return H(this.rgba)>=.5},r.prototype.toHex=function(){return r=o(this.rgba),t=r.r,e=r.g,u=r.b,i=(a=r.a)<1?s(n(255*a)):\"\",\"#\"+s(t)+s(e)+s(u)+i;var r,t,e,u,a,i},r.prototype.toRgb=function(){return o(this.rgba)},r.prototype.toRgbString=function(){return r=o(this.rgba),t=r.r,n=r.g,e=r.b,(u=r.a)<1?\"rgba(\"+t+\", \"+n+\", \"+e+\", \"+u+\")\":\"rgb(\"+t+\", \"+n+\", \"+e+\")\";var r,t,n,e,u},r.prototype.toHsl=function(){return d(c(this.rgba))},r.prototype.toHslString=function(){return r=d(c(this.rgba)),t=r.h,n=r.s,e=r.l,(u=r.a)<1?\"hsla(\"+t+\", \"+n+\"%, \"+e+\"%, \"+u+\")\":\"hsl(\"+t+\", \"+n+\"%, \"+e+\"%)\";var r,t,n,e,u},r.prototype.toHsv=function(){return r=h(this.rgba),{h:n(r.h),s:n(r.s),v:n(r.v),a:n(r.a,3)};var r},r.prototype.invert=function(){return w({r:255-(r=this.rgba).r,g:255-r.g,b:255-r.b,a:r.a});var r},r.prototype.saturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,r))},r.prototype.desaturate=function(r){return void 0===r&&(r=.1),w(M(this.rgba,-r))},r.prototype.grayscale=function(){return w(M(this.rgba,-1))},r.prototype.lighten=function(r){return void 0===r&&(r=.1),w($(this.rgba,r))},r.prototype.darken=function(r){return void 0===r&&(r=.1),w($(this.rgba,-r))},r.prototype.rotate=function(r){return void 0===r&&(r=15),this.hue(this.hue()+r)},r.prototype.alpha=function(r){return\"number\"==typeof r?w({r:(t=this.rgba).r,g:t.g,b:t.b,a:r}):n(this.rgba.a,3);var t},r.prototype.hue=function(r){var t=c(this.rgba);return\"number\"==typeof r?w({h:r,s:t.s,l:t.l,a:t.a}):n(t.h)},r.prototype.isEqual=function(r){return this.toHex()===w(r).toHex()},r}(),w=function(r){return r instanceof j?r:new j(r)},S=[],k=function(r){r.forEach(function(r){S.indexOf(r)<0&&(r(j,y),S.push(r))})},E=function(){return new j({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})};export{j as Colord,w as colord,k as extend,I as getFormat,E as random};\n","export default function ColorPickerSwatches(props: {\r\n\tcolors: Array<string | { color: string } | undefined>;\r\n\tonClick: (color: string) => void;\r\n}) {\r\n\tconst { colors, onClick } = props;\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`wpbf-color-swatches${colors && colors.length < 7 ? \" no-stretch\" : \"\"}`}\r\n\t\t>\r\n\t\t\t{colors.map((clr, index) => {\r\n\t\t\t\tconst color =\r\n\t\t\t\t\ttypeof clr === \"string\" ? clr : clr && clr.color ? clr.color : \"\";\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tkey={index.toString()}\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tclassName=\"wpbf-color-swatch\"\r\n\t\t\t\t\t\tdata-wpbf-color={color}\r\n\t\t\t\t\t\tstyle={{ backgroundColor: color }}\r\n\t\t\t\t\t\tonClick={() => onClick(color)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { NumberUnitPair } from \"../../Responsive/src/responsive-interface\";\r\n\r\nexport function normalizeMaxValue(\r\n\tmin: number | null | undefined,\r\n\tmax: number | null | undefined,\r\n): number | null | undefined {\r\n\tif (\"undefined\" === typeof min || \"undefined\" === typeof max) {\r\n\t\treturn max;\r\n\t}\r\n\r\n\tif (null === min || null === max) {\r\n\t\treturn max;\r\n\t}\r\n\r\n\treturn Math.max(min, max);\r\n}\r\n\r\n/**\r\n * Check if the provided value is a numeric.\r\n *\r\n * Thanks to Dan (https://stackoverflow.com/users/17121/dan) for his answer on StackOverflow:\r\n * @see https://stackoverflow.com/questions/175739/built-in-way-in-javascript-to-check-if-a-string-is-a-valid-number#answer-175787\r\n */\r\nexport function isNumeric(char: unknown): boolean {\r\n\t// Number is a numeric.\r\n\tif (\"number\" === typeof char) return true;\r\n\r\n\t// We only process strings.\r\n\tif (\"string\" !== typeof char) return false;\r\n\r\n\treturn !isNaN(parseFloat(char));\r\n}\r\n\r\nexport function improperNumeric(value: any): boolean {\r\n\tif (\r\n\t\t(typeof value !== \"string\" && typeof value !== \"number\") ||\r\n\t\t(typeof value === \"string\" && isNaN(parseFloat(value)))\r\n\t) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Limit number based on the min and max values.\r\n *\r\n * @param {string | number} value - The value to parse.\r\n * @param {number | null | undefined} min - The minimum value. Null or undefined if not set.\r\n * @param {number | null | undefined} max - The maximum value. Null or undefined if not set.\r\n *\r\n * @return {number | \"\"} The returned value can be either `number` or empty string.\r\n */\r\nexport function limitNumber(\r\n\tvalue: string | number,\r\n\tmin?: number | null,\r\n\tmax?: number | null,\r\n): number | \"\" {\r\n\tif (value === \"\") {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tif (improperNumeric(value)) {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tlet parsedValue = typeof value === \"string\" ? parseFloat(value) : value;\r\n\r\n\tif (\"number\" === typeof min) {\r\n\t\tif (parsedValue < min) {\r\n\t\t\tparsedValue = min;\r\n\t\t}\r\n\t}\r\n\r\n\tif (\"number\" === typeof max) {\r\n\t\tif (parsedValue > max) {\r\n\t\t\tparsedValue = max;\r\n\t\t}\r\n\t}\r\n\r\n\treturn parsedValue;\r\n}\r\n\r\n/**\r\n * Get unit from a value.\r\n *\r\n * @param {any} value The value to get unit from.\r\n *\r\n * @return {string} The unit or empty string if there's no unit.\r\n */\r\nexport function getUnit(value: any): string {\r\n\tif (!value) {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tconst strValue = String(value);\r\n\tconst unitPattern = /[a-z%]+$/i;\r\n\tconst unitMatch = strValue.match(unitPattern);\r\n\r\n\treturn unitMatch ? unitMatch[0] : \"\";\r\n}\r\n\r\n/**\r\n * Separate number and unit.\r\n *\r\n * @param {string | number | null} value The value to separate.\r\n *\r\n * @return {NumberUnitPair} The returned value will be a pair of `unit` and `number`.\r\n */\r\nexport function makeNumberUnitPair(\r\n\tvalue: string | number | null,\r\n): NumberUnitPair {\r\n\t// We support empty string.\r\n\tif (value === \"\" || value === null) {\r\n\t\treturn {\r\n\t\t\tnumber: \"\",\r\n\t\t\tunit: \"\",\r\n\t\t};\r\n\t}\r\n\r\n\tif (improperNumeric(value)) {\r\n\t\treturn {\r\n\t\t\tnumber: \"\",\r\n\t\t\tunit: \"\",\r\n\t\t};\r\n\t}\r\n\r\n\tlet strValue = String(value).trim();\r\n\tconst negativeSign = -1 < strValue.indexOf(\"-\") ? \"-\" : \"\";\r\n\tstrValue = strValue.replace(negativeSign, \"\");\r\n\r\n\tconst unit = getUnit(strValue);\r\n\tlet numeric = unit ? strValue.replace(unit, \"\") : strValue;\r\n\tnumeric = numeric.trim();\r\n\r\n\tif (\"\" === numeric) {\r\n\t\treturn {\r\n\t\t\tnumber: \"\",\r\n\t\t\tunit: unit,\r\n\t\t};\r\n\t}\r\n\r\n\tconst hasTrailingDot = numeric.endsWith(\".\");\r\n\tnumeric = negativeSign + numeric;\r\n\tconst number = parseFloat(numeric);\r\n\r\n\tif (isNaN(number)) {\r\n\t\treturn {\r\n\t\t\tnumber: \"\",\r\n\t\t\tunit: unit,\r\n\t\t};\r\n\t}\r\n\r\n\treturn {\r\n\t\tnumber: number,\r\n\t\tunit: unit,\r\n\t\thasTrailingDotBeforeUnit: unit && hasTrailingDot ? true : false,\r\n\t};\r\n}\r\n\r\n/**\r\n * Make a `NumberUnitPair` object from a string or number.\r\n *\r\n * @export\r\n *\r\n * @param {(string | number)} val - The value to convert.\r\n * @param {number} min - The minimum value.\r\n * @param {number} max - The maximum value.\r\n *\r\n * @return {NumberUnitPair} The `NumberUnitPair` object.\r\n */\r\nexport function makeLimitedNumberUnitPair(\r\n\tval: string | number,\r\n\tmin: number,\r\n\tmax: number,\r\n): NumberUnitPair {\r\n\tconst valueObject = makeNumberUnitPair(val);\r\n\r\n\tif (\"\" === valueObject.number) {\r\n\t\treturn valueObject;\r\n\t}\r\n\r\n\tconst number = limitNumber(valueObject.number, min, max);\r\n\r\n\treturn {\r\n\t\tnumber: number,\r\n\t\tunit: valueObject.unit,\r\n\t\thasTrailingDotBeforeUnit: valueObject.hasTrailingDotBeforeUnit,\r\n\t};\r\n}\r\n\r\n/**\r\n * Limit number with unit based on the min and max values.\r\n *\r\n * Currently only used in `initWpbfControl` in generic-control.ts and responsive-generic-control.ts files.\r\n * Meaning, this function doesn't need to take account of the `hasTrailingDotBeforeUnit` property.\r\n *\r\n * @param {string | number} value The value to parse.\r\n * @param {number | null | undefined} min The minimum value. Null or undefined if not set.\r\n * @param {number | null | undefined} max The maximum value. Null or undefined if not set.\r\n *\r\n * @return {string | number} The returned value can be either `number`, `string`, or concatenation between value and unit.\r\n */\r\nexport function limitNumberWithUnit(\r\n\tvalue: string | number,\r\n\tmin?: number | null,\r\n\tmax?: number | null,\r\n): string | number {\r\n\tif (value === \"\") {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tif (improperNumeric(value)) {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tconst numberAndUnit = makeNumberUnitPair(value);\r\n\r\n\tconst number = numberAndUnit.number;\r\n\tconst unit = numberAndUnit.unit;\r\n\r\n\tif (number === \"\") {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tconst limitedNumber = limitNumber(number, min, max);\r\n\r\n\tif (!unit) {\r\n\t\treturn limitedNumber;\r\n\t}\r\n\r\n\treturn `${limitedNumber}${unit}`;\r\n}\r\n","import { colord } from \"colord\";\r\nimport { WpbfColorControlValue } from \"../color-interface\";\r\nimport { isNumeric } from \"../../../Generic/src/number-util\";\r\n\r\n// Thanks to Blocksy for their base64 image data in their color picker control.\r\nexport const colorBgImgData =\r\n\t\"data:image/webp;base64,UklGRjIAAABXRUJQVlA4TCUAAAAvE8AEAA9w7/97/9/7f/7jAYraNmI6AJQ/1xvvMojof2BSvVEBAA==\";\r\n\r\nexport function parseHueModeValue(value: WpbfColorControlValue) {\r\n\tlet hueValue = 0;\r\n\r\n\tif (isNumeric(value)) {\r\n\t\thueValue = Number(value);\r\n\t} else if (typeof value === \"object\" && \"h\" in value) {\r\n\t\thueValue = value.h;\r\n\t} else {\r\n\t\thueValue = typeof value !== \"number\" ? colord(value).toHsl().h : 0;\r\n\t}\r\n\r\n\thueValue = hueValue < 0 ? 0 : hueValue;\r\n\r\n\treturn hueValue > 360 ? 360 : hueValue;\r\n}\r\n\r\nexport function hexColorFromHueModeValue(value: WpbfColorControlValue) {\r\n\tconst hue = parseHueModeValue(value);\r\n\treturn colord({ h: hue, s: 100, l: 50 }).toHex();\r\n}\r\n","import { ChangeEvent, useCallback, useEffect, useState } from \"react\";\r\nimport { colorBgImgData } from \"../utils/misc\";\r\n\r\nexport default function ColorPickerInput(props: {\r\n\tonChange: (color: string) => void;\r\n\tpickerComponent: string;\r\n\tuseHueMode: boolean;\r\n\tcolor?: string | number;\r\n}) {\r\n\tconst { onChange, pickerComponent, useHueMode } = props;\r\n\tconst [value, setValue] = useState(() => props.color);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetValue(props.color);\r\n\t}, [props.color]);\r\n\r\n\tconst handleInputChange = useCallback(\r\n\t\t(e: ChangeEvent) => {\r\n\t\t\tconst target = e.target as HTMLInputElement | undefined;\r\n\t\t\tlet val = target?.value ?? \"\";\r\n\r\n\t\t\tif (2 === val.length) {\r\n\t\t\t\tif (!val.includes(\"#\") && !val.includes(\"rg\") && !val.includes(\"hs\")) {\r\n\t\t\t\t\tval = \"#\" + val;\r\n\t\t\t\t}\r\n\t\t\t} else if (3 === val.length || 6 === val.length) {\r\n\t\t\t\tif (!val.includes(\"#\") && !val.includes(\"rg\") && !val.includes(\"hs\")) {\r\n\t\t\t\t\tval = \"#\" + val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tval = val.toLowerCase();\r\n\r\n\t\t\t// Thank you: https://regexr.com/39cgj\r\n\t\t\tconst pattern = new RegExp(\r\n\t\t\t\t/(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6}|[a-f0-9]{8})\\b|(?:rgb|hsl)a?\\([^)]*\\)/,\r\n\t\t\t);\r\n\r\n\t\t\tif (\"\" === val || pattern.test(val)) {\r\n\t\t\t\t// Run onChange handler passed by `ColorForm` component.\r\n\t\t\t\tonChange(val);\r\n\t\t\t}\r\n\r\n\t\t\tsetValue(val);\r\n\t\t},\r\n\t\t[onChange],\r\n\t);\r\n\r\n\tconst pickersWithAlpha = [\r\n\t\t\"RgbaColorPicker\",\r\n\t\t\"RgbaStringColorPicker\",\r\n\t\t\"HslaColorPicker\",\r\n\t\t\"HslaStringColorPicker\",\r\n\t\t\"HsvaColorPicker\",\r\n\t\t\"HsvaStringColorPicker\",\r\n\t];\r\n\r\n\tconst previewWrapperBgImg = pickersWithAlpha.includes(pickerComponent)\r\n\t\t? `url(\"${colorBgImgData}\")`\r\n\t\t: \"none\";\r\n\r\n\t/**\r\n\t * Parse value to be used as background color.\r\n\t *\r\n\t * This is only used for non-hue mode.\r\n\t */\r\n\tfunction parseBgColorValue() {\r\n\t\tif (useHueMode || typeof value === \"number\") {\r\n\t\t\treturn \"transparent\";\r\n\t\t}\r\n\r\n\t\treturn value ?? \"transparent\";\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"wpbf-color-input-wrapper\">\r\n\t\t\t<div className=\"wpbf-color-input-control\">\r\n\t\t\t\t{!useHueMode && (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"wpbf-color-preview-wrapper\"\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackgroundImage: previewWrapperBgImg,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tclassName=\"wpbf-color-preview\"\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tbackgroundColor: parseBgColorValue(),\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t></button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tvalue={value ?? \"\"}\r\n\t\t\t\t\tclassName=\"wpbf-color-input\"\r\n\t\t\t\t\tspellCheck=\"false\"\r\n\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { useEffect } from \"react\";\r\n\r\nexport default function useFocusOutside(ref: any, handler: any) {\r\n\tuseEffect(() => {\r\n\t\tconst listener = (e: any) => {\r\n\t\t\t// Do nothing if the component hasn't been mounted.\r\n\t\t\tif (!ref.current) return;\r\n\r\n\t\t\t// Do nothing if the focused element is inside the ref or the ref itself.\r\n\t\t\tif (ref.current.contains(e.target)) return;\r\n\r\n\t\t\thandler();\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"focus\", listener, true);\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"focus\", listener, true);\r\n\t\t};\r\n\t}, [ref, handler]);\r\n}\r\n","import { useEffect } from \"react\";\r\n\r\n/**\r\n * Code was taken and then modified from https://codesandbox.io/s/opmco?file=/src/useClickOutside.js:0-1192\r\n * It was improved version of https://usehooks.com/useOnClickOutside/\r\n */\r\nexport default function useClickOutside(\r\n\tpickerRef: any,\r\n\tresetRef: any,\r\n\thandler: any,\r\n) {\r\n\tuseEffect(() => {\r\n\t\tlet startedWhenMounted = false;\r\n\t\tlet startedInside = false;\r\n\r\n\t\tconst listener = (event: any) => {\r\n\t\t\t// Do nothing if `mousedown` or `touchstart` started either inside resetRef or pickerRef element\r\n\t\t\tif (!startedWhenMounted || startedInside) return;\r\n\r\n\t\t\t// Do nothing if clicking resetRef's element or descendent elements\r\n\t\t\tif (!resetRef.current || resetRef.current.contains(event.target)) return;\r\n\r\n\t\t\t// Do nothing if clicking pickerRef's element or descendent elements\r\n\t\t\tif (!pickerRef.current || pickerRef.current.contains(event.target))\r\n\t\t\t\treturn;\r\n\r\n\t\t\thandler();\r\n\t\t};\r\n\r\n\t\tconst validateEventStart = (event: any) => {\r\n\t\t\tstartedWhenMounted = resetRef.current && pickerRef.current;\r\n\t\t\tstartedInside =\r\n\t\t\t\t(resetRef.current && resetRef.current.contains(event.target)) ||\r\n\t\t\t\t(pickerRef.current && pickerRef.current.contains(event.target));\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"mousedown\", validateEventStart);\r\n\t\tdocument.addEventListener(\"touchstart\", validateEventStart);\r\n\t\tdocument.addEventListener(\"click\", listener);\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", validateEventStart);\r\n\t\t\tdocument.removeEventListener(\"touchstart\", validateEventStart);\r\n\t\t\tdocument.removeEventListener(\"click\", listener);\r\n\t\t};\r\n\t}, [resetRef, pickerRef, handler]);\r\n}\r\n","import e,{useRef as r,useMemo as t,useEffect as n,useState as o,useCallback as a,useLayoutEffect as l}from\"react\";function u(){return(u=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function c(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r.indexOf(t=a[n])>=0||(o[t]=e[t]);return o}function i(e){var t=r(e),n=r(function(e){t.current&&t.current(e)});return t.current=e,n.current}var s=function(e,r,t){return void 0===r&&(r=0),void 0===t&&(t=1),e>t?t:e<r?r:e},f=function(e){return\"touches\"in e},v=function(e){return e&&e.ownerDocument.defaultView||self},d=function(e,r,t){var n=e.getBoundingClientRect(),o=f(r)?function(e,r){for(var t=0;t<e.length;t++)if(e[t].identifier===r)return e[t];return e[0]}(r.touches,t):r;return{left:s((o.pageX-(n.left+v(e).pageXOffset))/n.width),top:s((o.pageY-(n.top+v(e).pageYOffset))/n.height)}},h=function(e){!f(e)&&e.preventDefault()},m=e.memo(function(o){var a=o.onMove,l=o.onKey,s=c(o,[\"onMove\",\"onKey\"]),m=r(null),g=i(a),p=i(l),b=r(null),_=r(!1),x=t(function(){var e=function(e){h(e),(f(e)?e.touches.length>0:e.buttons>0)&&m.current?g(d(m.current,e,b.current)):t(!1)},r=function(){return t(!1)};function t(t){var n=_.current,o=v(m.current),a=t?o.addEventListener:o.removeEventListener;a(n?\"touchmove\":\"mousemove\",e),a(n?\"touchend\":\"mouseup\",r)}return[function(e){var r=e.nativeEvent,n=m.current;if(n&&(h(r),!function(e,r){return r&&!f(e)}(r,_.current)&&n)){if(f(r)){_.current=!0;var o=r.changedTouches||[];o.length&&(b.current=o[0].identifier)}n.focus(),g(d(n,r,b.current)),t(!0)}},function(e){var r=e.which||e.keyCode;r<37||r>40||(e.preventDefault(),p({left:39===r?.05:37===r?-.05:0,top:40===r?.05:38===r?-.05:0}))},t]},[p,g]),C=x[0],E=x[1],H=x[2];return n(function(){return H},[H]),e.createElement(\"div\",u({},s,{onTouchStart:C,onMouseDown:C,className:\"react-colorful__interactive\",ref:m,onKeyDown:E,tabIndex:0,role:\"slider\"}))}),g=function(e){return e.filter(Boolean).join(\" \")},p=function(r){var t=r.color,n=r.left,o=r.top,a=void 0===o?.5:o,l=g([\"react-colorful__pointer\",r.className]);return e.createElement(\"div\",{className:l,style:{top:100*a+\"%\",left:100*n+\"%\"}},e.createElement(\"div\",{className:\"react-colorful__pointer-fill\",style:{backgroundColor:t}}))},b=function(e,r,t){return void 0===r&&(r=0),void 0===t&&(t=Math.pow(10,r)),Math.round(t*e)/t},_={grad:.9,turn:360,rad:360/(2*Math.PI)},x=function(e){return L(C(e))},C=function(e){return\"#\"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?b(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?b(parseInt(e.substring(6,8),16)/255,2):1}},E=function(e,r){return void 0===r&&(r=\"deg\"),Number(e)*(_[r]||1)},H=function(e){var r=/hsla?\\(?\\s*(-?\\d*\\.?\\d+)(deg|rad|grad|turn)?[,\\s]+(-?\\d*\\.?\\d+)%?[,\\s]+(-?\\d*\\.?\\d+)%?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i.exec(e);return r?N({h:E(r[1],r[2]),s:Number(r[3]),l:Number(r[4]),a:void 0===r[5]?1:Number(r[5])/(r[6]?100:1)}):{h:0,s:0,v:0,a:1}},M=H,N=function(e){var r=e.s,t=e.l;return{h:e.h,s:(r*=(t<50?t:100-t)/100)>0?2*r/(t+r)*100:0,v:t+r,a:e.a}},w=function(e){return K(I(e))},y=function(e){var r=e.s,t=e.v,n=e.a,o=(200-r)*t/100;return{h:b(e.h),s:b(o>0&&o<200?r*t/100/(o<=100?o:200-o)*100:0),l:b(o/2),a:b(n,2)}},q=function(e){var r=y(e);return\"hsl(\"+r.h+\", \"+r.s+\"%, \"+r.l+\"%)\"},k=function(e){var r=y(e);return\"hsla(\"+r.h+\", \"+r.s+\"%, \"+r.l+\"%, \"+r.a+\")\"},I=function(e){var r=e.h,t=e.s,n=e.v,o=e.a;r=r/360*6,t/=100,n/=100;var a=Math.floor(r),l=n*(1-t),u=n*(1-(r-a)*t),c=n*(1-(1-r+a)*t),i=a%6;return{r:b(255*[n,u,l,l,c,n][i]),g:b(255*[c,n,n,u,l,l][i]),b:b(255*[l,l,c,n,n,u][i]),a:b(o,2)}},O=function(e){var r=/hsva?\\(?\\s*(-?\\d*\\.?\\d+)(deg|rad|grad|turn)?[,\\s]+(-?\\d*\\.?\\d+)%?[,\\s]+(-?\\d*\\.?\\d+)%?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i.exec(e);return r?A({h:E(r[1],r[2]),s:Number(r[3]),v:Number(r[4]),a:void 0===r[5]?1:Number(r[5])/(r[6]?100:1)}):{h:0,s:0,v:0,a:1}},j=O,z=function(e){var r=/rgba?\\(?\\s*(-?\\d*\\.?\\d+)(%)?[,\\s]+(-?\\d*\\.?\\d+)(%)?[,\\s]+(-?\\d*\\.?\\d+)(%)?,?\\s*[/\\s]*(-?\\d*\\.?\\d+)?(%)?\\s*\\)?/i.exec(e);return r?L({r:Number(r[1])/(r[2]?100/255:1),g:Number(r[3])/(r[4]?100/255:1),b:Number(r[5])/(r[6]?100/255:1),a:void 0===r[7]?1:Number(r[7])/(r[8]?100:1)}):{h:0,s:0,v:0,a:1}},B=z,D=function(e){var r=e.toString(16);return r.length<2?\"0\"+r:r},K=function(e){var r=e.r,t=e.g,n=e.b,o=e.a,a=o<1?D(b(255*o)):\"\";return\"#\"+D(r)+D(t)+D(n)+a},L=function(e){var r=e.r,t=e.g,n=e.b,o=e.a,a=Math.max(r,t,n),l=a-Math.min(r,t,n),u=l?a===r?(t-n)/l:a===t?2+(n-r)/l:4+(r-t)/l:0;return{h:b(60*(u<0?u+6:u)),s:b(a?l/a*100:0),v:b(a/255*100),a:o}},A=function(e){return{h:b(e.h),s:b(e.s),v:b(e.v),a:b(e.a,2)}},S=e.memo(function(r){var t=r.hue,n=r.onChange,o=g([\"react-colorful__hue\",r.className]);return e.createElement(\"div\",{className:o},e.createElement(m,{onMove:function(e){n({h:360*e.left})},onKey:function(e){n({h:s(t+360*e.left,0,360)})},\"aria-label\":\"Hue\",\"aria-valuenow\":b(t),\"aria-valuemax\":\"360\",\"aria-valuemin\":\"0\"},e.createElement(p,{className:\"react-colorful__hue-pointer\",left:t/360,color:q({h:t,s:100,v:100,a:1})})))}),T=e.memo(function(r){var t=r.hsva,n=r.onChange,o={backgroundColor:q({h:t.h,s:100,v:100,a:1})};return e.createElement(\"div\",{className:\"react-colorful__saturation\",style:o},e.createElement(m,{onMove:function(e){n({s:100*e.left,v:100-100*e.top})},onKey:function(e){n({s:s(t.s+100*e.left,0,100),v:s(t.v-100*e.top,0,100)})},\"aria-label\":\"Color\",\"aria-valuetext\":\"Saturation \"+b(t.s)+\"%, Brightness \"+b(t.v)+\"%\"},e.createElement(p,{className:\"react-colorful__saturation-pointer\",top:1-t.v/100,left:t.s/100,color:q(t)})))}),F=function(e,r){if(e===r)return!0;for(var t in e)if(e[t]!==r[t])return!1;return!0},P=function(e,r){return e.replace(/\\s/g,\"\")===r.replace(/\\s/g,\"\")},X=function(e,r){return e.toLowerCase()===r.toLowerCase()||F(C(e),C(r))};function Y(e,t,l){var u=i(l),c=o(function(){return e.toHsva(t)}),s=c[0],f=c[1],v=r({color:t,hsva:s});n(function(){if(!e.equal(t,v.current.color)){var r=e.toHsva(t);v.current={hsva:r,color:t},f(r)}},[t,e]),n(function(){var r;F(s,v.current.hsva)||e.equal(r=e.fromHsva(s),v.current.color)||(v.current={hsva:s,color:r},u(r))},[s,e,u]);var d=a(function(e){f(function(r){return Object.assign({},r,e)})},[]);return[s,d]}var R,V=\"undefined\"!=typeof window?l:n,$=function(){return R||(\"undefined\"!=typeof __webpack_nonce__?__webpack_nonce__:void 0)},G=function(e){R=e},J=new Map,Q=function(e){V(function(){var r=e.current?e.current.ownerDocument:document;if(void 0!==r&&!J.has(r)){var t=r.createElement(\"style\");t.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:\"\";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\\'data:image/svg+xml;charset=utf-8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill-opacity=\".05\"><path d=\"M8 0h8v8H8zM0 8h8v8H0z\"/></svg>\\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',J.set(r,t);var n=$();n&&t.setAttribute(\"nonce\",n),r.head.appendChild(t)}},[])},U=function(t){var n=t.className,o=t.colorModel,a=t.color,l=void 0===a?o.defaultColor:a,i=t.onChange,s=c(t,[\"className\",\"colorModel\",\"color\",\"onChange\"]),f=r(null);Q(f);var v=Y(o,l,i),d=v[0],h=v[1],m=g([\"react-colorful\",n]);return e.createElement(\"div\",u({},s,{ref:f,className:m}),e.createElement(T,{hsva:d,onChange:h}),e.createElement(S,{hue:d.h,onChange:h,className:\"react-colorful__last-control\"}))},W={defaultColor:\"000\",toHsva:x,fromHsva:function(e){return w({h:e.h,s:e.s,v:e.v,a:1})},equal:X},Z=function(r){return e.createElement(U,u({},r,{colorModel:W}))},ee=function(r){var t=r.className,n=r.hsva,o=r.onChange,a={backgroundImage:\"linear-gradient(90deg, \"+k(Object.assign({},n,{a:0}))+\", \"+k(Object.assign({},n,{a:1}))+\")\"},l=g([\"react-colorful__alpha\",t]),u=b(100*n.a);return e.createElement(\"div\",{className:l},e.createElement(\"div\",{className:\"react-colorful__alpha-gradient\",style:a}),e.createElement(m,{onMove:function(e){o({a:e.left})},onKey:function(e){o({a:s(n.a+e.left)})},\"aria-label\":\"Alpha\",\"aria-valuetext\":u+\"%\",\"aria-valuenow\":u,\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\"},e.createElement(p,{className:\"react-colorful__alpha-pointer\",left:n.a,color:k(n)})))},re=function(t){var n=t.className,o=t.colorModel,a=t.color,l=void 0===a?o.defaultColor:a,i=t.onChange,s=c(t,[\"className\",\"colorModel\",\"color\",\"onChange\"]),f=r(null);Q(f);var v=Y(o,l,i),d=v[0],h=v[1],m=g([\"react-colorful\",n]);return e.createElement(\"div\",u({},s,{ref:f,className:m}),e.createElement(T,{hsva:d,onChange:h}),e.createElement(S,{hue:d.h,onChange:h}),e.createElement(ee,{hsva:d,onChange:h,className:\"react-colorful__last-control\"}))},te={defaultColor:\"0001\",toHsva:x,fromHsva:w,equal:X},ne=function(r){return e.createElement(re,u({},r,{colorModel:te}))},oe={defaultColor:{h:0,s:0,l:0,a:1},toHsva:N,fromHsva:y,equal:F},ae=function(r){return e.createElement(re,u({},r,{colorModel:oe}))},le={defaultColor:\"hsla(0, 0%, 0%, 1)\",toHsva:H,fromHsva:k,equal:P},ue=function(r){return e.createElement(re,u({},r,{colorModel:le}))},ce={defaultColor:{h:0,s:0,l:0},toHsva:function(e){return N({h:e.h,s:e.s,l:e.l,a:1})},fromHsva:function(e){return{h:(r=y(e)).h,s:r.s,l:r.l};var r},equal:F},ie=function(r){return e.createElement(U,u({},r,{colorModel:ce}))},se={defaultColor:\"hsl(0, 0%, 0%)\",toHsva:M,fromHsva:q,equal:P},fe=function(r){return e.createElement(U,u({},r,{colorModel:se}))},ve={defaultColor:{h:0,s:0,v:0,a:1},toHsva:function(e){return e},fromHsva:A,equal:F},de=function(r){return e.createElement(re,u({},r,{colorModel:ve}))},he={defaultColor:\"hsva(0, 0%, 0%, 1)\",toHsva:O,fromHsva:function(e){var r=A(e);return\"hsva(\"+r.h+\", \"+r.s+\"%, \"+r.v+\"%, \"+r.a+\")\"},equal:P},me=function(r){return e.createElement(re,u({},r,{colorModel:he}))},ge={defaultColor:{h:0,s:0,v:0},toHsva:function(e){return{h:e.h,s:e.s,v:e.v,a:1}},fromHsva:function(e){var r=A(e);return{h:r.h,s:r.s,v:r.v}},equal:F},pe=function(r){return e.createElement(U,u({},r,{colorModel:ge}))},be={defaultColor:\"hsv(0, 0%, 0%)\",toHsva:j,fromHsva:function(e){var r=A(e);return\"hsv(\"+r.h+\", \"+r.s+\"%, \"+r.v+\"%)\"},equal:P},_e=function(r){return e.createElement(U,u({},r,{colorModel:be}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L,fromHsva:I,equal:F},Ce=function(r){return e.createElement(re,u({},r,{colorModel:xe}))},Ee={defaultColor:\"rgba(0, 0, 0, 1)\",toHsva:z,fromHsva:function(e){var r=I(e);return\"rgba(\"+r.r+\", \"+r.g+\", \"+r.b+\", \"+r.a+\")\"},equal:P},He=function(r){return e.createElement(re,u({},r,{colorModel:Ee}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(e){return L({r:e.r,g:e.g,b:e.b,a:1})},fromHsva:function(e){return{r:(r=I(e)).r,g:r.g,b:r.b};var r},equal:F},Ne=function(r){return e.createElement(U,u({},r,{colorModel:Me}))},we={defaultColor:\"rgb(0, 0, 0)\",toHsva:B,fromHsva:function(e){var r=I(e);return\"rgb(\"+r.r+\", \"+r.g+\", \"+r.b+\")\"},equal:P},ye=function(r){return e.createElement(U,u({},r,{colorModel:we}))},qe=/^#?([0-9A-F]{3,8})$/i,ke=function(r){var t=r.color,l=void 0===t?\"\":t,s=r.onChange,f=r.onBlur,v=r.escape,d=r.validate,h=r.format,m=r.process,g=c(r,[\"color\",\"onChange\",\"onBlur\",\"escape\",\"validate\",\"format\",\"process\"]),p=o(function(){return v(l)}),b=p[0],_=p[1],x=i(s),C=i(f),E=a(function(e){var r=v(e.target.value);_(r),d(r)&&x(m?m(r):r)},[v,m,d,x]),H=a(function(e){d(e.target.value)||_(v(l)),C(e)},[l,v,d,C]);return n(function(){_(v(l))},[l,v]),e.createElement(\"input\",u({},g,{value:h?h(b):b,spellCheck:\"false\",onChange:E,onBlur:H}))},Ie=function(e){return\"#\"+e},Oe=function(r){var t=r.prefixed,n=r.alpha,o=c(r,[\"prefixed\",\"alpha\"]),l=a(function(e){return e.replace(/([^0-9A-F]+)/gi,\"\").substring(0,n?8:6)},[n]),i=a(function(e){return function(e,r){var t=qe.exec(e),n=t?t[1].length:0;return 3===n||6===n||!!r&&4===n||!!r&&8===n}(e,n)},[n]);return e.createElement(ke,u({},o,{escape:l,format:t?Ie:void 0,process:Ie,validate:i}))};export{ne as HexAlphaColorPicker,Oe as HexColorInput,Z as HexColorPicker,ie as HslColorPicker,fe as HslStringColorPicker,ae as HslaColorPicker,ue as HslaStringColorPicker,pe as HsvColorPicker,_e as HsvStringColorPicker,de as HsvaColorPicker,me as HsvaStringColorPicker,Ne as RgbColorPicker,ye as RgbStringColorPicker,Ce as RgbaColorPicker,He as RgbaStringColorPicker,G as setNonce};\n//# sourceMappingURL=index.module.js.map\n","import {\r\n\tHexColorPicker,\r\n\tHslaColorPicker,\r\n\tHslaStringColorPicker,\r\n\tHslColorPicker,\r\n\tHslStringColorPicker,\r\n\tHsvaColorPicker,\r\n\tHsvaStringColorPicker,\r\n\tHsvColorPicker,\r\n\tHsvStringColorPicker,\r\n\tRgbaColorPicker,\r\n\tRgbaStringColorPicker,\r\n\tRgbColorPicker,\r\n\tRgbStringColorPicker,\r\n} from \"react-colorful\";\r\nimport {\r\n\tHslaColor,\r\n\tHslColor,\r\n\tHsvaColor,\r\n\tHsvColor,\r\n\tRgbaColor,\r\n\tRgbColor,\r\n} from \"colord\";\r\nimport { WpbfColorPickerValue } from \"../color-interface\";\r\n\r\nexport default function ColorPickerComponent(props: {\r\n\tpickerComponent: string;\r\n\tvalue: WpbfColorPickerValue;\r\n\tonChange: (e: WpbfColorPickerValue) => void;\r\n}) {\r\n\tconst { pickerComponent, value, onChange } = props;\r\n\r\n\tswitch (pickerComponent) {\r\n\t\tcase \"HexColorPicker\":\r\n\t\t\treturn <HexColorPicker color={value as string} onChange={onChange} />;\r\n\t\tcase \"RgbColorPicker\":\r\n\t\t\treturn <RgbColorPicker color={value as RgbColor} onChange={onChange} />;\r\n\t\tcase \"RgbStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<RgbStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\tcase \"RgbaColorPicker\":\r\n\t\t\treturn <RgbaColorPicker color={value as RgbaColor} onChange={onChange} />;\r\n\t\tcase \"RgbaStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<RgbaStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\t// We treat HueColorPicker (hue mode) as HslColorPicker.\r\n\t\tcase \"HueColorPicker\":\r\n\t\t\treturn <HslColorPicker color={value as HslColor} onChange={onChange} />;\r\n\t\tcase \"HslColorPicker\":\r\n\t\t\treturn <HslColorPicker color={value as HslColor} onChange={onChange} />;\r\n\t\tcase \"HslStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<HslStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\tcase \"HslaColorPicker\":\r\n\t\t\treturn <HslaColorPicker color={value as HslaColor} onChange={onChange} />;\r\n\t\tcase \"HslaStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<HslaStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\tcase \"HsvColorPicker\":\r\n\t\t\treturn <HsvColorPicker color={value as HsvColor} onChange={onChange} />;\r\n\t\tcase \"HsvStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<HsvStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\tcase \"HsvaColorPicker\":\r\n\t\t\treturn <HsvaColorPicker color={value as HsvaColor} onChange={onChange} />;\r\n\t\tcase \"HsvaStringColorPicker\":\r\n\t\t\treturn (\r\n\t\t\t\t<HsvaStringColorPicker color={value as string} onChange={onChange} />\r\n\t\t\t);\r\n\t\tdefault:\r\n\t\t\treturn <HexColorPicker color={value as string} onChange={onChange} />;\r\n\t}\r\n}\r\n","import { colorBgImgData } from \"../utils/misc\";\r\n\r\nexport default function ColorPickerCirleTrigger(props: {\r\n\tcolor: string;\r\n\tisPopupOpen: boolean;\r\n\ttooltip?: JSX.Element | string;\r\n\tresetRef?: React.MutableRefObject<HTMLButtonElement | null>;\r\n\tonResetButtonClick?: () => void;\r\n\tonToggleButtonClick?: () => void;\r\n}) {\r\n\tconst {\r\n\t\tisPopupOpen,\r\n\t\ttooltip,\r\n\t\tresetRef,\r\n\t\tonResetButtonClick,\r\n\t\tonToggleButtonClick,\r\n\t} = props;\r\n\r\n\tconst triggerButtonBgImage = `url(\"${colorBgImgData}\")`;\r\n\r\n\tfunction hasResetButton() {\r\n\t\treturn resetRef && onResetButtonClick;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{hasResetButton() && (\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tref={resetRef}\r\n\t\t\t\t\tclassName={`wpbf-control-reset${isPopupOpen ? \" is-shown\" : \"\"}`}\r\n\t\t\t\t\tonClick={onResetButtonClick}\r\n\t\t\t\t>\r\n\t\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className=\"wpbf-trigger-circle-wrapper\">\r\n\t\t\t\t{tooltip && <div className=\"wpbf-label-tooltip\">{tooltip}</div>}\r\n\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tclassName=\"wpbf-trigger-circle\"\r\n\t\t\t\t\tonClick={onToggleButtonClick}\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackgroundImage: triggerButtonBgImage,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"wpbf-color-preview\"\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tbackgroundColor: props.color ? props.color : \"transparent\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","export default function ControlLabel(props: {\r\n\tlabel: string;\r\n\tdescription: string;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tconst { label, description, setNotificationContainer } = props;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{label || description ? (\r\n\t\t\t\t<label className=\"wpbf-control-label\">\r\n\t\t\t\t\t{label && (\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName=\"customize-control-title\"\r\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: label }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{description && (\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName=\"description customize-control-description\"\r\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: description }}\r\n\t\t\t\t\t\t></span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</label>\r\n\t\t\t) : (\r\n\t\t\t\t\"\"\r\n\t\t\t)}\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"customize-control-notifications-container\"\r\n\t\t\t\tref={setNotificationContainer}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n}\r\n","import ColorPickerCirleTrigger from \"./ColorPickerCircleTrigger\";\r\nimport ControlLabel from \"./ControlLabel\";\r\nimport { hexColorFromHueModeValue } from \"../utils/misc\";\r\nimport { ColorControlLabelStyle } from \"../color-interface\";\r\n\r\nexport default function ControlHeader(props: {\r\n\tlabel: string;\r\n\tdescription: string;\r\n\tlabelStyle: ColorControlLabelStyle;\r\n\tpickerComponent: string;\r\n\tuseHueMode: boolean;\r\n\tinputValue?: string | number;\r\n\tisPopupOpen?: boolean;\r\n\ttogglePicker?: () => void;\r\n\tresetRef?: React.MutableRefObject<HTMLButtonElement | null>;\r\n\tonResetButtonClick: () => void;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tconst { label, description, labelStyle, setNotificationContainer } = props;\r\n\r\n\tfunction renderLabel() {\r\n\t\treturn (\r\n\t\t\t<ControlLabel\r\n\t\t\t\tlabel={label}\r\n\t\t\t\tdescription={description}\r\n\t\t\t\tsetNotificationContainer={setNotificationContainer}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n\r\n\tfunction renderTrigger(useTooltip?: boolean) {\r\n\t\tif (\r\n\t\t\ttypeof props.inputValue === \"undefined\" ||\r\n\t\t\ttypeof props.isPopupOpen === \"undefined\"\r\n\t\t) {\r\n\t\t\treturn <></>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"wpbf-buttons\">\r\n\t\t\t\t<ColorPickerCirleTrigger\r\n\t\t\t\t\tcolor={String(\r\n\t\t\t\t\t\tprops.useHueMode\r\n\t\t\t\t\t\t\t? hexColorFromHueModeValue(props.inputValue)\r\n\t\t\t\t\t\t\t: props.inputValue,\r\n\t\t\t\t\t)}\r\n\t\t\t\t\tisPopupOpen={props.isPopupOpen}\r\n\t\t\t\t\tresetRef={props.resetRef}\r\n\t\t\t\t\tonToggleButtonClick={props.togglePicker}\r\n\t\t\t\t\tonResetButtonClick={props.onResetButtonClick}\r\n\t\t\t\t\ttooltip={useTooltip && !props.isPopupOpen ? label : undefined}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tswitch (labelStyle) {\r\n\t\tcase \"tooltip\":\r\n\t\t\treturn <>{renderTrigger(true)}</>;\r\n\r\n\t\tcase \"top\":\r\n\t\t\treturn (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{renderLabel()}\r\n\t\t\t\t\t{renderTrigger()}\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\r\n\t\tcase \"label_only\":\r\n\t\t\treturn renderLabel();\r\n\r\n\t\tcase \"none\":\r\n\t\t\treturn renderTrigger();\r\n\r\n\t\tdefault:\r\n\t\t\treturn (\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t\t\t<div className=\"wpbf-control-left-col\">{renderLabel()}</div>\r\n\t\t\t\t\t\t<div className=\"wpbf-control-right-col\">{renderTrigger()}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t}\r\n}\r\n","import { colord } from \"colord\";\r\nimport { WpbfColorControlValue } from \"../color-interface\";\r\nimport { parseHueModeValue } from \"./misc\";\r\n\r\n/**\r\n * Convert the value for the color input.\r\n *\r\n * @param {WpbfColorControlValue} value - The value to be converted.\r\n * @param {string} pickerComponent - The picker component name.\r\n * @param {string|undefined} formComponent - The form component name.\r\n *\r\n * @returns {string} The converted value.\r\n */\r\nexport default function convertColorForInput(\r\n\tvalue: WpbfColorControlValue,\r\n\tuseHueMode: boolean,\r\n\tpickerComponent: string,\r\n\tformComponent?: string,\r\n): string {\r\n\tif (\"\" === value) return \"\";\r\n\r\n\tif (useHueMode) {\r\n\t\treturn String(parseHueModeValue(value));\r\n\t}\r\n\r\n\t// If hudeMode is false, but value is a number, then return empty string.\r\n\tif (typeof value === \"number\") return \"\";\r\n\r\n\tlet rgba;\r\n\tlet hsv;\r\n\tlet hsva;\r\n\tlet convertedValue;\r\n\r\n\tswitch (pickerComponent) {\r\n\t\t/**\r\n\t\t * The HexColorPicker is used by these condition:\r\n\t\t * 1. When formComponent is defined with HexColorPicker as the value.\r\n\t\t * 2. When formComponent is not defined but the \"alpha\" choice is not set or set to false (the old way).\r\n\t\t */\r\n\t\tcase \"HexColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"#\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHex();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"rgb(\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toRgbString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbStringColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"rgba\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toRgbString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbaColorPicker\":\r\n\t\t\trgba = colord(value).toRgb();\r\n\r\n\t\t\tif (rgba.a < 1) {\r\n\t\t\t\tconvertedValue =\r\n\t\t\t\t\t\"string\" === typeof value && value.includes(\"rgba\")\r\n\t\t\t\t\t\t? value\r\n\t\t\t\t\t\t: colord(value).toRgbString();\r\n\t\t\t} else {\r\n\t\t\t\tconvertedValue = colord(value).toRgbString();\r\n\r\n\t\t\t\t// Force to set the alpha value.\r\n\t\t\t\tif (\r\n\t\t\t\t\tconvertedValue.includes(\"rgb\") &&\r\n\t\t\t\t\t!convertedValue.includes(\"rgba\")\r\n\t\t\t\t) {\r\n\t\t\t\t\tconvertedValue = convertedValue.replace(\"rgb\", \"rgba\");\r\n\t\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t/**\r\n\t\t * The RgbaStringColorPicker is used by these condition:\r\n\t\t * 1. When formComponent is defined with RgbaColorPicker as the value.\r\n\t\t * 2. When formComponent is not defined but the \"alpha\" choice is set to true.\r\n\t\t */\r\n\t\tcase \"RgbaStringColorPicker\":\r\n\t\t\trgba = colord(value).toRgb();\r\n\r\n\t\t\t// When it uses the 2nd condition above, then the expected value is \"hex\".\r\n\t\t\tif (rgba.a == 1 && !formComponent) {\r\n\t\t\t\tconvertedValue =\r\n\t\t\t\t\t\"string\" === typeof value && value.includes(\"#\")\r\n\t\t\t\t\t\t? value\r\n\t\t\t\t\t\t: colord(value).toHex();\r\n\t\t\t} else {\r\n\t\t\t\tconvertedValue = colord(value).toRgbString();\r\n\r\n\t\t\t\t// Force to set the alpha value.\r\n\t\t\t\tif (\r\n\t\t\t\t\tconvertedValue.includes(\"rgb\") &&\r\n\t\t\t\t\t!convertedValue.includes(\"rgba\")\r\n\t\t\t\t) {\r\n\t\t\t\t\tconvertedValue = convertedValue.replace(\"rgb\", \"rgba\");\r\n\t\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"hsl(\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHslString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslStringColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"hsl(\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHslString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHslString();\r\n\r\n\t\t\t// Force to set the alpha value.\r\n\t\t\tif (convertedValue.includes(\"hsl\") && !convertedValue.includes(\"hsla\")) {\r\n\t\t\t\tconvertedValue = convertedValue.replace(\"hsl\", \"hsla\");\r\n\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHslString();\r\n\r\n\t\t\t// Force to set the alpha value.\r\n\t\t\tif (convertedValue.includes(\"hsl\") && !convertedValue.includes(\"hsla\")) {\r\n\t\t\t\tconvertedValue = convertedValue.replace(\"hsl\", \"hsla\");\r\n\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\t/**\r\n\t\t * The colord library doesn't provide .toHsvString() method yet.\r\n\t\t * This manual value-building will apply to \"hsv\" and \"hsva\" stuff below.\r\n\t\t */\r\n\t\tcase \"HsvColorPicker\":\r\n\t\t\thsv = colord(value).toHsv();\r\n\t\t\tconvertedValue = \"hsv(\" + hsv.h + \", \" + hsv.s + \"%, \" + hsv.v + \"%)\";\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvStringColorPicker\":\r\n\t\t\thsv = colord(value).toHsv();\r\n\t\t\tconvertedValue = \"hsv(\" + hsv.h + \", \" + hsv.s + \"%, \" + hsv.v + \"%)\";\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaColorPicker\":\r\n\t\t\thsva = colord(value).toHsv();\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"hsva(\" +\r\n\t\t\t\thsva.h +\r\n\t\t\t\t\", \" +\r\n\t\t\t\thsva.s +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.v +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.a +\r\n\t\t\t\t\")\";\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaStringColorPicker\":\r\n\t\t\thsva = colord(value).toHsv();\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"hsva(\" +\r\n\t\t\t\thsva.h +\r\n\t\t\t\t\", \" +\r\n\t\t\t\thsva.s +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.v +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.a +\r\n\t\t\t\t\")\";\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tconvertedValue = colord(value).toHex();\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\treturn convertedValue.replace(\";\", \"\");\r\n}\r\n","import { colord } from \"colord\";\r\nimport {\r\n\tWpbfColorPickerValue,\r\n\tWpbfColorControlValue,\r\n} from \"../color-interface\";\r\nimport { parseHueModeValue } from \"./misc\";\r\n\r\n/**\r\n * Convert the value for the color picker.\r\n *\r\n * @param {WpbfColorControlValue} value - The value to be converted.\r\n * @param {string} pickerComponent - The picker component name.\r\n *\r\n * @returns {WpbfColorPickerValue} The converted value.\r\n */\r\nexport default function convertColorForPicker(\r\n\tvalue: WpbfColorControlValue,\r\n\tuseHueMode: boolean,\r\n\tpickerComponent: string,\r\n): WpbfColorPickerValue {\r\n\tlet convertedValue;\r\n\r\n\tif (useHueMode) {\r\n\t\tconst hueValue = parseHueModeValue(value);\r\n\r\n\t\t// Hard coded saturation and lightness when using hue mode.\r\n\t\treturn { h: hueValue, s: 100, l: 50 };\r\n\t}\r\n\r\n\t// If hudeMode is false, but value is a number, then hardcode the value to #000000.\r\n\tif (typeof value === \"number\") {\r\n\t\tvalue = \"#000000\";\r\n\t}\r\n\r\n\tswitch (pickerComponent) {\r\n\t\tcase \"HexColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHex();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toRgb();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\tr: convertedValue.r,\r\n\t\t\t\tg: convertedValue.g,\r\n\t\t\t\tb: convertedValue.b,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toRgbString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toRgb();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbaStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toRgbString();\r\n\r\n\t\t\t// Force to set the alpha channel value.\r\n\t\t\tif (convertedValue.includes(\"rgb\") && !convertedValue.includes(\"rgba\")) {\r\n\t\t\t\tconvertedValue = convertedValue.replace(\"rgb\", \"rgba\");\r\n\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsl();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\th: convertedValue.h,\r\n\t\t\t\ts: convertedValue.s,\r\n\t\t\t\tl: convertedValue.l,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHslString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsl();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHslString();\r\n\r\n\t\t\t// Force to set the alpha channel value.\r\n\t\t\tif (convertedValue.includes(\"hsl\") && !convertedValue.includes(\"hsla\")) {\r\n\t\t\t\tconvertedValue = convertedValue.replace(\"hsl\", \"hsla\");\r\n\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsv();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\th: convertedValue.h,\r\n\t\t\t\ts: convertedValue.s,\r\n\t\t\t\tv: convertedValue.v,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvStringColorPicker\":\r\n\t\t\tconst hsv = colord(value).toHsv();\r\n\t\t\tconvertedValue = \"hsv(\" + hsv.h + \", \" + hsv.s + \"%, \" + hsv.v + \"%)\";\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsv();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaStringColorPicker\":\r\n\t\t\t// colord library doesn't provide .toHsvString() method yet.\r\n\t\t\tconst hsva = colord(value).toHsv();\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"hsva(\" +\r\n\t\t\t\thsva.h +\r\n\t\t\t\t\", \" +\r\n\t\t\t\thsva.s +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.v +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.a +\r\n\t\t\t\t\")\";\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tconvertedValue = colord(value).toHex();\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\treturn convertedValue;\r\n}\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { colord } from \"colord\";\r\nimport ColorPickerSwatches from \"./components/ColorPickerSwatches\";\r\nimport ColorPickerInput from \"./components/ColorPickerInput\";\r\nimport useWindowResize from \"./hooks/useWindowResize\";\r\nimport useFocusOutside from \"./hooks/useFocusOutside\";\r\nimport useClickOutside from \"./hooks/useClickOutside\";\r\nimport ColorPickerComponent from \"./components/ColorPickerComponent\";\r\nimport ControlHeader from \"./components/ControlHeader\";\r\nimport {\r\n\tColorControlLabelStyle,\r\n\tWpbfColorControlValue,\r\n} from \"./color-interface\";\r\nimport convertColorForInput from \"./utils/convert-color-for-input\";\r\nimport convertColorForPicker from \"./utils/convert-color-for-picker\";\r\n\r\n/**\r\n * The form component of Kirki React Colorful.\r\n */\r\nexport default function ColorForm(props: {\r\n\ttype: string;\r\n\tcontainer: HTMLElement;\r\n\tlabel: string;\r\n\tdescription: string;\r\n\tuseHueMode: boolean;\r\n\tpickerComponent: string;\r\n\tlabelStyle: ColorControlLabelStyle;\r\n\tcolorSwatches: Array<string | { color: string } | undefined>;\r\n\tvalue: WpbfColorControlValue;\r\n\tdefault: WpbfColorControlValue;\r\n\tformComponent?: string;\r\n\tremoveHeader?: boolean;\r\n\tisPopupOpen?: boolean;\r\n\tuseExternalPopupToggle?: boolean;\r\n\tonChange?: (value: WpbfColorControlValue) => void;\r\n\tonReset?: () => void;\r\n\toverrideUpdateComponentStateFn?: (\r\n\t\tfn: (val: WpbfColorControlValue) => void,\r\n\t) => void;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tconst {\r\n\t\tcontainer,\r\n\t\tuseHueMode,\r\n\t\tpickerComponent,\r\n\t\tformComponent,\r\n\t\tlabel,\r\n\t\tdescription,\r\n\t\tlabelStyle,\r\n\t\tuseExternalPopupToggle,\r\n\t} = props;\r\n\r\n\tconst [inputValue, setInputValue] = useState(() => {\r\n\t\treturn convertColorForInput(\r\n\t\t\tprops.value,\r\n\t\t\tuseHueMode,\r\n\t\t\tpickerComponent,\r\n\t\t\tformComponent,\r\n\t\t);\r\n\t});\r\n\r\n\tconst [pickerValue, setPickerValue] = useState(() => {\r\n\t\treturn convertColorForPicker(props.value, useHueMode, pickerComponent);\r\n\t});\r\n\r\n\tlet currentInputValue = inputValue;\r\n\tlet currentPickerValue = pickerValue;\r\n\r\n\t// This function will be called when this control's customizer value is changed.\r\n\tfunction updateComponentState(value: WpbfColorControlValue) {\r\n\t\tconst valueForInput = convertColorForInput(\r\n\t\t\tvalue,\r\n\t\t\tuseHueMode,\r\n\t\t\tpickerComponent,\r\n\t\t\tformComponent,\r\n\t\t);\r\n\r\n\t\tlet shouldChangeInputValue = false;\r\n\r\n\t\tif (typeof valueForInput === \"string\" || useHueMode) {\r\n\t\t\tshouldChangeInputValue = valueForInput !== inputValue;\r\n\t\t} else {\r\n\t\t\tshouldChangeInputValue =\r\n\t\t\t\tJSON.stringify(valueForInput) !== JSON.stringify(currentInputValue);\r\n\t\t}\r\n\r\n\t\tif (shouldChangeInputValue) {\r\n\t\t\tsetInputValue(valueForInput);\r\n\t\t}\r\n\r\n\t\tconst valueForPicker = convertColorForPicker(\r\n\t\t\tvalue,\r\n\t\t\tuseHueMode,\r\n\t\t\tpickerComponent,\r\n\t\t);\r\n\r\n\t\tlet shouldChangePickerValue: boolean;\r\n\r\n\t\tif (typeof valueForPicker === \"string\" || useHueMode) {\r\n\t\t\tshouldChangePickerValue = valueForPicker !== pickerValue;\r\n\t\t} else {\r\n\t\t\tshouldChangePickerValue =\r\n\t\t\t\tJSON.stringify(valueForPicker) !== JSON.stringify(currentPickerValue);\r\n\t\t}\r\n\r\n\t\tif (shouldChangePickerValue) {\r\n\t\t\tsetPickerValue(valueForPicker);\r\n\t\t}\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tconst initialColor =\r\n\t\t\"\" !== props.default && \"undefined\" !== typeof props.default\r\n\t\t\t? props.default\r\n\t\t\t: props.value;\r\n\r\n\tfunction handleWindowResize() {\r\n\t\tsetPickerContainerStyle(getPickerContainerStyle());\r\n\t}\r\n\r\n\t// Reference to the form div.\r\n\tconst formRef = useRef<HTMLDivElement | null>(null);\r\n\r\n\t// Reference to the color picker popup.\r\n\tconst pickerRef = useRef<HTMLDivElement | null>(null);\r\n\r\n\t// Reference to the reset button.\r\n\tconst resetRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n\tconst [isPopupOpen, setIsPopupOpen] = useState(props.isPopupOpen ?? false);\r\n\r\n\t// On multicolor control, listen to `value` && `isPopupOpen` properties change.\r\n\tif (props.type && props.type === \"wpbf-multicolor\") {\r\n\t\tuseEffect(() => {\r\n\t\t\tsetInputValue(\r\n\t\t\t\tconvertColorForInput(\r\n\t\t\t\t\tprops.value,\r\n\t\t\t\t\tuseHueMode,\r\n\t\t\t\t\tpickerComponent,\r\n\t\t\t\t\tformComponent,\r\n\t\t\t\t),\r\n\t\t\t);\r\n\r\n\t\t\tsetPickerValue(\r\n\t\t\t\tconvertColorForPicker(props.value, useHueMode, pickerComponent),\r\n\t\t\t);\r\n\t\t}, [props.value]);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tsetIsPopupOpen(props.isPopupOpen ?? false);\r\n\t\t}, [props.isPopupOpen]);\r\n\t}\r\n\r\n\tconst [pickerContainerStyle, setPickerContainerStyle] = useState({});\r\n\r\n\tconst getPickerContainerStyle = () => {\r\n\t\tlet pickerContainerStyle: Record<string, any> = {};\r\n\r\n\t\tif (\"default\" === labelStyle) {\r\n\t\t\treturn pickerContainerStyle;\r\n\t\t}\r\n\r\n\t\tconst rawPadding = window.getComputedStyle(\r\n\t\t\tcontainer.parentNode as HTMLElement,\r\n\t\t).paddingLeft;\r\n\r\n\t\tconst padding = parseInt(rawPadding, 10) * 2;\r\n\r\n\t\tpickerContainerStyle.width =\r\n\t\t\t(container.parentNode as HTMLElement).getBoundingClientRect().width -\r\n\t\t\tpadding;\r\n\r\n\t\tconst controlLeftOffset = (container.offsetLeft - 9) * -1;\r\n\r\n\t\tpickerContainerStyle.left = controlLeftOffset + \"px\";\r\n\r\n\t\treturn pickerContainerStyle;\r\n\t};\r\n\r\n\tfunction convertInputValueTo6Digits() {\r\n\t\tif (\r\n\t\t\ttypeof inputValue === \"string\" &&\r\n\t\t\t4 === inputValue.length &&\r\n\t\t\tinputValue.includes(\"#\")\r\n\t\t) {\r\n\t\t\tsetInputValue(colord(inputValue).toHex());\r\n\t\t}\r\n\t}\r\n\r\n\tfunction togglePopup() {\r\n\t\tif (useExternalPopupToggle) return;\r\n\r\n\t\tif (isPopupOpen) {\r\n\t\t\tclosePopup();\r\n\t\t} else {\r\n\t\t\topenPopup();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction openPopup() {\r\n\t\tif (isPopupOpen) return;\r\n\r\n\t\tsetPickerContainerStyle(getPickerContainerStyle());\r\n\t\tconvertInputValueTo6Digits();\r\n\t\tsetIsPopupOpen(true);\r\n\t}\r\n\r\n\tfunction closePopup() {\r\n\t\tif (!isPopupOpen) return;\r\n\r\n\t\tsetIsPopupOpen(false);\r\n\t\tsetTimeout(convertInputValueTo6Digits, 200);\r\n\t}\r\n\r\n\tuseWindowResize(handleWindowResize);\r\n\r\n\tif (!useExternalPopupToggle) {\r\n\t\t// Handle outside focus to close the picker popup.\r\n\t\tuseFocusOutside(formRef, closePopup);\r\n\r\n\t\t// Handle outside click to close the picker popup.\r\n\t\tuseClickOutside(pickerRef, resetRef, closePopup);\r\n\t}\r\n\r\n\tlet colorSwatches = props.colorSwatches;\r\n\r\n\tif (jQuery.wp && jQuery.wp.wpColorPicker) {\r\n\t\tconst wpColorPickerSwatches =\r\n\t\t\tjQuery.wp.wpColorPicker.prototype.options.palettes;\r\n\r\n\t\t// If 3rd parties applied custom colors to wpColorPicker swatches, let's use them.\r\n\t\tif (Array.isArray(wpColorPickerSwatches)) {\r\n\t\t\tif (wpColorPickerSwatches.length < 8) {\r\n\t\t\t\tfor (let i = wpColorPickerSwatches.length; i < 8; i++) {\r\n\t\t\t\t\tif (wpColorPickerSwatches[i]) {\r\n\t\t\t\t\t\twpColorPickerSwatches.push(colorSwatches[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcolorSwatches = wpColorPickerSwatches;\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div\r\n\t\t\t\tclassName={`wpbf-control-form ${useHueMode ? \"use-hue-mode\" : \"\"} has-${labelStyle}-label-style`}\r\n\t\t\t\tref={formRef}\r\n\t\t\t\ttabIndex={1}\r\n\t\t\t>\r\n\t\t\t\t{!props.removeHeader && (\r\n\t\t\t\t\t<ControlHeader\r\n\t\t\t\t\t\tlabel={label}\r\n\t\t\t\t\t\tdescription={description}\r\n\t\t\t\t\t\tlabelStyle={labelStyle}\r\n\t\t\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\t\t\tuseHueMode={useHueMode}\r\n\t\t\t\t\t\tinputValue={inputValue}\r\n\t\t\t\t\t\tisPopupOpen={isPopupOpen}\r\n\t\t\t\t\t\ttogglePicker={togglePopup}\r\n\t\t\t\t\t\tresetRef={resetRef}\r\n\t\t\t\t\t\tonResetButtonClick={() => {\r\n\t\t\t\t\t\t\tif (!initialColor) {\r\n\t\t\t\t\t\t\t\tcurrentInputValue = \"\";\r\n\t\t\t\t\t\t\t\tcurrentPickerValue = \"\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tprops.onReset?.();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tsetNotificationContainer={props.setNotificationContainer}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tref={pickerRef}\r\n\t\t\t\t\tclassName={`${pickerComponent} colorPickerContainer ${isPopupOpen ? \"is-open\" : \"\"}`}\r\n\t\t\t\t\tstyle={pickerContainerStyle}\r\n\t\t\t\t>\r\n\t\t\t\t\t{!useHueMode && (\r\n\t\t\t\t\t\t<ColorPickerSwatches\r\n\t\t\t\t\t\t\tcolors={colorSwatches}\r\n\t\t\t\t\t\t\tonClick={(color) => {\r\n\t\t\t\t\t\t\t\tprops.onChange?.(color);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<ColorPickerComponent\r\n\t\t\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\t\t\tvalue={pickerValue}\r\n\t\t\t\t\t\tonChange={(color) => {\r\n\t\t\t\t\t\t\tcurrentPickerValue = color;\r\n\t\t\t\t\t\t\tprops.onChange?.(color);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<ColorPickerInput\r\n\t\t\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\t\t\tuseHueMode={useHueMode}\r\n\t\t\t\t\t\tcolor={inputValue}\r\n\t\t\t\t\t\tonChange={(value) => {\r\n\t\t\t\t\t\t\tcurrentInputValue = value;\r\n\t\t\t\t\t\t\tprops.onChange?.(value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { useEffect } from \"react\";\r\n\r\nexport default function useWindowResize(handler: any) {\r\n\tuseEffect(() => {\r\n\t\tconst listener = (_e: any) => {\r\n\t\t\thandler();\r\n\t\t};\r\n\r\n\t\twindow.addEventListener(\"resize\", listener, true);\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", listener, true);\r\n\t\t};\r\n\t}, [handler]);\r\n}\r\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import { colord } from \"colord\";\r\nimport { WpbfColorControlValue } from \"../color-interface\";\r\nimport { parseHueModeValue } from \"./misc\";\r\n\r\n/**\r\n * Convert the value for the customizer.\r\n *\r\n * @param {WpbfColorControlValue} value - The value to be converted.\r\n * @param {string} pickerComponent - The picker component name.\r\n * @param {string|undefined} formComponent - The form component name.\r\n *\r\n * @returns {WpbfColorControlValue} The converted value.\r\n */\r\nexport default function convertColorForCustomizer(\r\n\tvalue: WpbfColorControlValue,\r\n\tuseHueMode: boolean,\r\n\tpickerComponent: string,\r\n\tformComponent?: string,\r\n): WpbfColorControlValue {\r\n\tif (\"\" === value) return \"\";\r\n\r\n\tif (useHueMode) {\r\n\t\treturn parseHueModeValue(value);\r\n\t}\r\n\r\n\t// If hudeMode is false, but value is a number, then return empty string.\r\n\tif (typeof value === \"number\") return \"\";\r\n\r\n\tlet rgba;\r\n\tlet hsv;\r\n\tlet hsva;\r\n\tlet convertedValue;\r\n\r\n\tswitch (pickerComponent) {\r\n\t\t/**\r\n\t\t * The HexColorPicker is used by these condition:\r\n\t\t * 1. When formComponent is defined with HexColorPicker as the value.\r\n\t\t * 2. When formComponent is not defined but the \"alpha\" choice is not set or set to false (the old way).\r\n\t\t */\r\n\t\tcase \"HexColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"#\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHex();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toRgb();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\tr: convertedValue.r,\r\n\t\t\t\tg: convertedValue.g,\r\n\t\t\t\tb: convertedValue.b,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbStringColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"rgb(\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toRgbString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"RgbaColorPicker\":\r\n\t\t\trgba = colord(value).toRgb();\r\n\t\t\tconvertedValue = rgba;\r\n\t\t\tbreak;\r\n\r\n\t\t/**\r\n\t\t * The RgbaStringColorPicker is used by these condition:\r\n\t\t * 1. When formComponent is defined with RgbaColorPicker as the value.\r\n\t\t * 2. When formComponent is not defined but the \"alpha\" choice is set to true.\r\n\t\t */\r\n\t\tcase \"RgbaStringColorPicker\":\r\n\t\t\trgba = colord(value).toRgb();\r\n\r\n\t\t\tif (rgba.a < 1) {\r\n\t\t\t\tconvertedValue =\r\n\t\t\t\t\t\"string\" === typeof value && value.includes(\"rgba\")\r\n\t\t\t\t\t\t? value\r\n\t\t\t\t\t\t: colord(value).toRgbString();\r\n\t\t\t} else {\r\n\t\t\t\t// When it uses the 2nd condition above, then the expected value is \"hex\".\r\n\t\t\t\tif (!formComponent) {\r\n\t\t\t\t\tconvertedValue =\r\n\t\t\t\t\t\t\"string\" === typeof value && value.includes(\"#\")\r\n\t\t\t\t\t\t\t? value\r\n\t\t\t\t\t\t\t: colord(value).toHex();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconvertedValue = colord(value).toRgbString();\r\n\r\n\t\t\t\t\t// Force to set the alpha channel value.\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tconvertedValue.includes(\"rgb\") &&\r\n\t\t\t\t\t\t!convertedValue.includes(\"rgba\")\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tconvertedValue = convertedValue.replace(\"rgb\", \"rgba\");\r\n\t\t\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsl();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\th: convertedValue.h,\r\n\t\t\t\ts: convertedValue.s,\r\n\t\t\t\tl: convertedValue.l,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslStringColorPicker\":\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"hsl(\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHslString();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsl();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HslaStringColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHslString();\r\n\r\n\t\t\t// Force to set the alpha channel value.\r\n\t\t\tif (convertedValue.includes(\"hsl\") && !convertedValue.includes(\"hsla\")) {\r\n\t\t\t\tconvertedValue = convertedValue.replace(\"hsl\", \"hsla\");\r\n\t\t\t\tconvertedValue = convertedValue.replace(\")\", \", 1)\");\r\n\t\t\t}\r\n\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsv();\r\n\t\t\tconvertedValue = {\r\n\t\t\t\th: convertedValue.h,\r\n\t\t\t\ts: convertedValue.s,\r\n\t\t\t\tv: convertedValue.v,\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\r\n\t\t/**\r\n\t\t * The colord library doesn't provide .toHsvString() method yet.\r\n\t\t * This manual value-building will apply to \"HsvStringColorPicker\" and \"HsvaStringColorPicker\" stuff below.\r\n\t\t */\r\n\t\tcase \"HsvStringColorPicker\":\r\n\t\t\thsv = colord(value).toHsv();\r\n\t\t\tconvertedValue = \"hsv(\" + hsv.h + \", \" + hsv.s + \"%, \" + hsv.v + \"%)\";\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaColorPicker\":\r\n\t\t\tconvertedValue = colord(value).toHsv();\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"HsvaStringColorPicker\":\r\n\t\t\thsva = colord(value).toHsv();\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"hsva(\" +\r\n\t\t\t\thsva.h +\r\n\t\t\t\t\", \" +\r\n\t\t\t\thsva.s +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.v +\r\n\t\t\t\t\"%, \" +\r\n\t\t\t\thsva.a +\r\n\t\t\t\t\")\";\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tconvertedValue =\r\n\t\t\t\t\"string\" === typeof value && value.includes(\"#\")\r\n\t\t\t\t\t? value\r\n\t\t\t\t\t: colord(value).toHex();\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\treturn convertedValue;\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { WpbfColorControl, WpbfColorControlValue } from \"./color-interface\";\r\nimport ColorForm from \"./ColorForm\";\r\nimport { createRoot } from \"react-dom/client\";\r\nimport convertColorForCustomizer from \"./utils/convert-color-for-customizer\";\r\n\r\nconst ColorControl = window.wp.customize?.Control.extend<WpbfColorControl>({\r\n\tinitialize: function initialize(id, params) {\r\n\t\t// Bind functions to this control context for passing as React props.\r\n\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\r\n\t\tthis.overrideUpdateComponentStateFn =\r\n\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\r\n\t\tthis.onChange = this.onChange?.bind(this);\r\n\t\tthis.onReset = this.onReset?.bind(this);\r\n\r\n\t\twindow.wp.customize?.Control.prototype.initialize.call(this, id, params);\r\n\r\n\t\tconst control = this;\r\n\r\n\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\tfunction handleOnRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\tif (control === removedControl) {\r\n\t\t\t\tif (control.destroy) control.destroy();\r\n\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\twindow.wp.customize?.control.unbind(\"removed\", handleOnRemoved);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.wp.customize?.control.bind(\"removed\", handleOnRemoved);\r\n\t},\r\n\r\n\t/**\r\n\t * Set notification container and render.\r\n\t *\r\n\t * This is called when the React component is mounted.\r\n\t */\r\n\tsetNotificationContainer: function setNotificationContainer(el) {\r\n\t\tif (this.notifications) {\r\n\t\t\tthis.notifications.container = jQuery(el);\r\n\t\t\tthis.notifications.render();\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Render the control into the DOM.\r\n\t *\r\n\t * This will be called from the Control#embed() method in the parent class.\r\n\t */\r\n\trenderContent: function renderContent() {\r\n\t\tif (!this.params) return;\r\n\t\tif (!this.container || !this.container.length) return;\r\n\r\n\t\tconst mode = this.params.mode;\r\n\t\tconst useHueMode = \"hue\" === mode;\r\n\t\tconst formComponent = this.params.formComponent;\r\n\r\n\t\tlet pickerComponent = \"\";\r\n\r\n\t\tif (formComponent) {\r\n\t\t\tpickerComponent = formComponent;\r\n\t\t} else {\r\n\t\t\tpickerComponent =\r\n\t\t\t\tmode === \"alpha\" ? \"RgbaStringColorPicker\" : \"HexColorPicker\";\r\n\t\t}\r\n\r\n\t\tpickerComponent = useHueMode ? \"HueColorPicker\" : pickerComponent;\r\n\r\n\t\tif (!this.root && this.container) {\r\n\t\t\tthis.root = createRoot(this.container[0]);\r\n\t\t}\r\n\r\n\t\tthis.root?.render(\r\n\t\t\t<ColorForm\r\n\t\t\t\ttype={this.params?.type}\r\n\t\t\t\tcontainer={this.container[0]}\r\n\t\t\t\tlabel={this.params.label}\r\n\t\t\t\tdescription={this.params.description}\r\n\t\t\t\tuseHueMode={useHueMode}\r\n\t\t\t\tformComponent={formComponent}\r\n\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\tlabelStyle={this.params.labelStyle}\r\n\t\t\t\tcolorSwatches={this.params.colorSwatches}\r\n\t\t\t\tvalue={this.params.value}\r\n\t\t\t\tdefault={this.params.default}\r\n\t\t\t\tonChange={(value) => this.onChange?.(value)}\r\n\t\t\t\tonReset={() => this.onReset?.()}\r\n\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\r\n\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\r\n\t\t\t/>,\r\n\t\t);\r\n\t},\r\n\r\n\t/**\r\n\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t *\r\n\t * React is available to be used here instead of the customizer.Element abstraction.\r\n\t */\r\n\tready: function ready() {\r\n\t\tconst control = this;\r\n\r\n\t\t/**\r\n\t\t * Update component state when customizer setting changes.\r\n\t\t *\r\n\t\t * There was an issue (that's fixed):\r\n\t\t *\r\n\t\t * Let's say we have other color picker (\"x\" color picker) and this current color picker (\"y\" color picker).\r\n\t\t * Let's say there's a script that bind to that \"x\" color picker to make change to this \"y\" color picker.\r\n\t\t *\r\n\t\t * When \"x\" color picker is changed fast (by dragging the color, for example),\r\n\t\t * then the re-render of this \"y\" color picker will be messy.\r\n\t\t * There was something like \"function-call race\" between component re-render and function call inside the component.\r\n\t\t *\r\n\t\t * When that happens, the \"x\" color picker becomes unresponsive and un-usable.\r\n\t\t *\r\n\t\t * How we fixed that:\r\n\t\t * - Provide a updateColorPicker property to this file.\r\n\t\t * - Inside the component, assign the updateColorPicker with a function to update some states.\r\n\t\t * - Then inside the binding below, call updateColorPicker instead of re-rendering the component.\r\n\t\t *\r\n\t\t * The result: Even though the \"x\" color picker becomes very slow, it's still usable and responsive enough.\r\n\t\t */\r\n\t\tthis.setting?.bind((val: WpbfColorControlValue) => {\r\n\t\t\tcontrol.updateComponentState?.(val);\r\n\t\t});\r\n\t},\r\n\r\n\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\r\n\t\tif (typeof val === \"undefined\") return;\r\n\t\tconst params = this.params;\r\n\t\tif (!params) return;\r\n\r\n\t\tconst mode = params.mode;\r\n\t\tconst useHueMode = \"hue\" === mode;\r\n\t\tconst formComponent = params.formComponent;\r\n\r\n\t\tlet pickerComponent = \"\";\r\n\r\n\t\tif (formComponent) {\r\n\t\t\tpickerComponent = formComponent;\r\n\t\t} else {\r\n\t\t\tpickerComponent =\r\n\t\t\t\tmode === \"alpha\" ? \"RgbaStringColorPicker\" : \"HexColorPicker\";\r\n\t\t}\r\n\r\n\t\tthis.setting?.set(\r\n\t\t\tconvertColorForCustomizer(\r\n\t\t\t\tval,\r\n\t\t\t\tuseHueMode,\r\n\t\t\t\tpickerComponent,\r\n\t\t\t\tformComponent,\r\n\t\t\t),\r\n\t\t);\r\n\t},\r\n\r\n\tonChange: function onChange(val) {\r\n\t\tthis.updateCustomizerSetting?.(val);\r\n\t},\r\n\r\n\tonReset: function onReset() {\r\n\t\tconst params = this.params;\r\n\t\tif (!params) return;\r\n\r\n\t\tconst initialColor =\r\n\t\t\t\"\" !== params.default && \"undefined\" !== typeof params.default\r\n\t\t\t\t? params.default\r\n\t\t\t\t: params.value;\r\n\r\n\t\tthis.updateCustomizerSetting?.(initialColor);\r\n\t},\r\n\r\n\t/**\r\n\t * This method will be overriden by the rendered component via overrideUpdateComponentStateFn.\r\n\t */\r\n\tupdateComponentState: function (val) {},\r\n\r\n\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(fn) {\r\n\t\tthis.updateComponentState = fn;\r\n\t},\r\n\r\n\t/**\r\n\t * Handle removal/de-registration of the control.\r\n\t *\r\n\t * This is essentially the inverse of the Control#embed() method.\r\n\t */\r\n\tdestroy: function destroy() {\r\n\t\tthis.root?.unmount();\r\n\t\tthis.root = undefined;\r\n\r\n\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\twindow.wp.customize?.Control.prototype.destroy?.call(this);\r\n\t},\r\n});\r\n\r\nexport default ColorControl;\r\n","import { useRef, useState } from \"react\";\r\nimport ColorForm from \"./ColorForm\";\r\nimport {\r\n\tWpbfMulticolorControlValue,\r\n\tColorControlLabelStyle,\r\n} from \"./color-interface\";\r\nimport ControlLabel from \"./components/ControlLabel\";\r\nimport ColorPickerCirleTrigger from \"./components/ColorPickerCircleTrigger\";\r\nimport convertColorForInput from \"./utils/convert-color-for-input\";\r\nimport useFocusOutside from \"./hooks/useFocusOutside\";\r\nimport useClickOutside from \"./hooks/useClickOutside\";\r\n\r\nexport default function MulticolorForm(props: {\r\n\tid: string;\r\n\tcontainer: HTMLElement;\r\n\tchoices: Record<string, string>;\r\n\tkeys: string[];\r\n\tlabel: string;\r\n\tdescription: string;\r\n\tuseHueMode: boolean;\r\n\tpickerComponent: string;\r\n\tlabelStyle: ColorControlLabelStyle;\r\n\tcolorSwatches: Array<string | { color: string } | undefined>;\r\n\tvalue: WpbfMulticolorControlValue;\r\n\tdefault: WpbfMulticolorControlValue;\r\n\tformComponent?: string;\r\n\tonChange?: (value: WpbfMulticolorControlValue) => void;\r\n\tonReset?: () => void;\r\n\toverrideUpdateComponentStateFn?: (\r\n\t\tfn: (val: WpbfMulticolorControlValue) => void,\r\n\t) => void;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tconst {\r\n\t\tcontainer,\r\n\t\tchoices,\r\n\t\tsetNotificationContainer,\r\n\t\tuseHueMode,\r\n\t\tpickerComponent,\r\n\t\tformComponent,\r\n\t\tlabel,\r\n\t\tdescription,\r\n\t} = props;\r\n\r\n\tconst [value, setValue] = useState<WpbfMulticolorControlValue>(props.value);\r\n\r\n\tconst [openedPopupKey, setOpenedPopupKey] = useState<string | undefined>(\r\n\t\tundefined,\r\n\t);\r\n\r\n\t// This function will be called when this control's customizer value is changed.\r\n\tfunction updateComponentState(value: WpbfMulticolorControlValue) {\r\n\t\tsetValue(value);\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tfunction togglePopup(key: string) {\r\n\t\tif (openedPopupKey) {\r\n\t\t\tsetOpenedPopupKey(undefined);\r\n\t\t} else {\r\n\t\t\tsetOpenedPopupKey(key);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction closePopup() {\r\n\t\tsetOpenedPopupKey(undefined);\r\n\t}\r\n\r\n\t// Reference to the form div.\r\n\tconst formRef = useRef<HTMLDivElement | null>(null);\r\n\r\n\t// Reference to the color picker popup.\r\n\tconst pickerRef = useRef<HTMLDivElement | null>(null);\r\n\r\n\t// Reference to the reset button.\r\n\tconst resetRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n\t// Handle outside focus to close the picker popup.\r\n\tuseFocusOutside(formRef, closePopup);\r\n\r\n\t// Handle outside click to close the picker popup.\r\n\tuseClickOutside(pickerRef, resetRef, closePopup);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"wpbf-multicolor\" ref={formRef}>\r\n\t\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t\t<div className=\"wpbf-control-left-col\">\r\n\t\t\t\t\t\t<ControlLabel\r\n\t\t\t\t\t\t\tlabel={label}\r\n\t\t\t\t\t\t\tdescription={description}\r\n\t\t\t\t\t\t\tsetNotificationContainer={setNotificationContainer}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"wpbf-control-right-col\">\r\n\t\t\t\t\t\t<div className=\"wpbf-buttons\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tref={resetRef}\r\n\t\t\t\t\t\t\t\tclassName={`wpbf-control-reset${openedPopupKey ? \" is-shown\" : \"\"}`}\r\n\t\t\t\t\t\t\t\ttitle=\"Reset colors set\"\r\n\t\t\t\t\t\t\t\tonClick={() => props.onReset?.()}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t{props.keys.map((key, i) => {\r\n\t\t\t\t\t\t\t\tconst circleColor = convertColorForInput(\r\n\t\t\t\t\t\t\t\t\tvalue[key] ?? \"\",\r\n\t\t\t\t\t\t\t\t\tuseHueMode,\r\n\t\t\t\t\t\t\t\t\tpickerComponent,\r\n\t\t\t\t\t\t\t\t\tformComponent,\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<ColorPickerCirleTrigger\r\n\t\t\t\t\t\t\t\t\t\tkey={`${key}-${i}`}\r\n\t\t\t\t\t\t\t\t\t\tcolor={circleColor}\r\n\t\t\t\t\t\t\t\t\t\tisPopupOpen={openedPopupKey === key}\r\n\t\t\t\t\t\t\t\t\t\ttooltip={choices[key] ?? undefined}\r\n\t\t\t\t\t\t\t\t\t\tonToggleButtonClick={() => togglePopup(key)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div ref={pickerRef} className=\"wpbf-color-picker-popup\">\r\n\t\t\t\t\t{props.keys.map((key, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<ColorForm\r\n\t\t\t\t\t\t\t\tkey={`${key}-${i}`}\r\n\t\t\t\t\t\t\t\ttype=\"wpbf-multicolor\"\r\n\t\t\t\t\t\t\t\tcontainer={container}\r\n\t\t\t\t\t\t\t\tlabel={props.label}\r\n\t\t\t\t\t\t\t\tdescription={props.description}\r\n\t\t\t\t\t\t\t\tuseHueMode={useHueMode}\r\n\t\t\t\t\t\t\t\tformComponent={formComponent}\r\n\t\t\t\t\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\t\t\t\t\tlabelStyle=\"none\"\r\n\t\t\t\t\t\t\t\tcolorSwatches={props.colorSwatches}\r\n\t\t\t\t\t\t\t\tvalue={value[key] ?? \"\"}\r\n\t\t\t\t\t\t\t\tdefault={props.default[key]}\r\n\t\t\t\t\t\t\t\tsetNotificationContainer={props.setNotificationContainer}\r\n\t\t\t\t\t\t\t\tremoveHeader={true}\r\n\t\t\t\t\t\t\t\tisPopupOpen={openedPopupKey === key}\r\n\t\t\t\t\t\t\t\tuseExternalPopupToggle={true}\r\n\t\t\t\t\t\t\t\tonChange={(newValue) => {\r\n\t\t\t\t\t\t\t\t\tconst val = { ...value };\r\n\t\t\t\t\t\t\t\t\tval[key] = newValue;\r\n\r\n\t\t\t\t\t\t\t\t\tprops.onChange?.(val);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport {\r\n\tWpbfMulticolorControlValue,\r\n\tWpbfMulticolorControl,\r\n} from \"./color-interface\";\r\nimport MulticolorForm from \"./MulticolorForm\";\r\nimport { createRoot } from \"react-dom/client\";\r\nimport convertColorForCustomizer from \"./utils/convert-color-for-customizer\";\r\n\r\nconst MulticolorControl =\r\n\twindow.wp.customize?.Control.extend<WpbfMulticolorControl>({\r\n\t\tinitialize: function initialize(id, params) {\r\n\t\t\t// Bind functions to this control context for passing as React props.\r\n\t\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\r\n\t\t\tthis.overrideUpdateComponentStateFn =\r\n\t\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\r\n\t\t\tthis.onChange = this.onChange?.bind(this);\r\n\t\t\tthis.onReset = this.onReset?.bind(this);\r\n\r\n\t\t\twindow.wp.customize?.Control.prototype.initialize.call(this, id, params);\r\n\r\n\t\t\tconst control = this;\r\n\r\n\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\tfunction handleOnRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\tif (control === removedControl) {\r\n\t\t\t\t\tif (control.destroy) control.destroy();\r\n\t\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\t\twindow.wp.customize?.control.unbind(\"removed\", handleOnRemoved);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\twindow.wp.customize?.control.bind(\"removed\", handleOnRemoved);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set notification container and render.\r\n\t\t *\r\n\t\t * This is called when the React component is mounted.\r\n\t\t */\r\n\t\tsetNotificationContainer: function setNotificationContainer(el) {\r\n\t\t\tif (this.notifications) {\r\n\t\t\t\tthis.notifications.container = jQuery(el);\r\n\t\t\t\tthis.notifications.render();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Render the control into the DOM.\r\n\t\t *\r\n\t\t * This will be called from the Control#embed() method in the parent class.\r\n\t\t */\r\n\t\trenderContent: function renderContent() {\r\n\t\t\tif (!this.params) return;\r\n\t\t\tif (!this.container || !this.container.length) return;\r\n\r\n\t\t\tconst mode = this.params.mode;\r\n\t\t\tconst useHueMode = \"hue\" === mode;\r\n\t\t\tconst formComponent = this.params.formComponent;\r\n\r\n\t\t\tlet pickerComponent = \"\";\r\n\r\n\t\t\tif (formComponent) {\r\n\t\t\t\tpickerComponent = formComponent;\r\n\t\t\t} else {\r\n\t\t\t\tpickerComponent =\r\n\t\t\t\t\tmode === \"alpha\" ? \"RgbaStringColorPicker\" : \"HexColorPicker\";\r\n\t\t\t}\r\n\r\n\t\t\tpickerComponent = useHueMode ? \"HueColorPicker\" : pickerComponent;\r\n\r\n\t\t\tif (!this.root && this.container) {\r\n\t\t\t\tthis.root = createRoot(this.container[0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.root?.render(\r\n\t\t\t\t<MulticolorForm\r\n\t\t\t\t\tid={this.setting?.id ?? \"\"}\r\n\t\t\t\t\tcontainer={this.container[0]}\r\n\t\t\t\t\tchoices={this.params.choices}\r\n\t\t\t\t\tkeys={Object.keys(this.params.choices)}\r\n\t\t\t\t\tlabel={this.params.label}\r\n\t\t\t\t\tdescription={this.params.description}\r\n\t\t\t\t\tuseHueMode={useHueMode}\r\n\t\t\t\t\tformComponent={formComponent}\r\n\t\t\t\t\tpickerComponent={pickerComponent}\r\n\t\t\t\t\tlabelStyle={this.params.labelStyle}\r\n\t\t\t\t\tcolorSwatches={this.params.colorSwatches}\r\n\t\t\t\t\tvalue={this.params.value}\r\n\t\t\t\t\tdefault={this.params.default}\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonReset={this.onReset}\r\n\t\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\r\n\t\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\r\n\t\t\t\t/>,\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t\t *\r\n\t\t * React is available to be used here instead of the window.wp.customize?.Element abstraction.\r\n\t\t */\r\n\t\tready: function ready() {\r\n\t\t\t/**\r\n\t\t\t * Update component state when customizer setting changes.\r\n\t\t\t */\r\n\t\t\tthis.setting?.bind((val: WpbfMulticolorControlValue) => {\r\n\t\t\t\tthis.updateComponentState?.(val);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tonChange: function (val) {\r\n\t\t\tthis.updateCustomizerSetting?.(val);\r\n\t\t},\r\n\r\n\t\tonReset: function () {\r\n\t\t\tconst params = this.params;\r\n\t\t\tif (!params) return;\r\n\r\n\t\t\tconst initialColor =\r\n\t\t\t\t\"undefined\" !== typeof params.default &&\r\n\t\t\t\tObject.keys(params.default).length > 0\r\n\t\t\t\t\t? params.default\r\n\t\t\t\t\t: params.value;\r\n\r\n\t\t\tthis.updateCustomizerSetting?.(initialColor);\r\n\t\t},\r\n\r\n\t\tupdateCustomizerSetting: function (val) {\r\n\t\t\tif (typeof val === \"undefined\") return;\r\n\t\t\tconst params = this.params;\r\n\t\t\tif (!params) return;\r\n\r\n\t\t\tconst mode = params.mode;\r\n\t\t\tconst useHueMode = \"hue\" === mode;\r\n\t\t\tconst formComponent = params.formComponent;\r\n\r\n\t\t\tlet pickerComponent = \"\";\r\n\r\n\t\t\tif (formComponent) {\r\n\t\t\t\tpickerComponent = formComponent;\r\n\t\t\t} else {\r\n\t\t\t\tpickerComponent =\r\n\t\t\t\t\tmode === \"alpha\" ? \"RgbaStringColorPicker\" : \"HexColorPicker\";\r\n\t\t\t}\r\n\r\n\t\t\tconst value: WpbfMulticolorControlValue = {};\r\n\r\n\t\t\tfor (const key in val) {\r\n\t\t\t\tif (!val.hasOwnProperty(key)) continue;\r\n\r\n\t\t\t\tvalue[key] = convertColorForCustomizer(\r\n\t\t\t\t\tval[key],\r\n\t\t\t\t\tuseHueMode,\r\n\t\t\t\t\tpickerComponent,\r\n\t\t\t\t\tformComponent,\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.setting?.set(value);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * This method will be overriden by the rendered component via overrideUpdateComponentStateFn.\r\n\t\t */\r\n\t\tupdateComponentState: function (val) {},\r\n\r\n\t\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(\r\n\t\t\tfn,\r\n\t\t) {\r\n\t\t\tthis.updateComponentState = fn;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle removal/de-registration of the control.\r\n\t\t *\r\n\t\t * This is essentially the inverse of the Control#embed() method.\r\n\t\t */\r\n\t\tdestroy: function destroy() {\r\n\t\t\tthis.root?.unmount();\r\n\t\t\tthis.root = undefined;\r\n\r\n\t\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\t\tif (window.wp.customize?.Control.prototype.destroy) {\r\n\t\t\t\twindow.wp.customize?.Control.prototype.destroy.call(this);\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n\r\nexport default MulticolorControl;\r\n","/**\r\n * Encode a specific type of object as JSON string or return an empty string if failed.\r\n *\r\n * @param {T} value - The value to encode.\r\n * @return {string} The JSON encoded version of the value.\r\n */\r\nexport function encodeJsonOrDefault<T>(value: T): string {\r\n\ttry {\r\n\t\treturn JSON.stringify(value);\r\n\t} catch (e) {\r\n\t\treturn \"\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Parse a JSON string or return undefined if failed.\r\n *\r\n * @param {string | null | undefined} jsonStr - The JSON string to parse.\r\n * @return {T | undefined} The parsed value or undefined if failed.\r\n */\r\nexport function parseJsonOrUndefined<T>(\r\n\tjsonStr: string | null | undefined | T,\r\n): T | undefined {\r\n\tif (\"\" === jsonStr || !jsonStr) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tif (typeof jsonStr !== \"string\") {\r\n\t\treturn jsonStr;\r\n\t}\r\n\r\n\ttry {\r\n\t\treturn JSON.parse(jsonStr);\r\n\t} catch (e) {\r\n\t\treturn undefined;\r\n\t}\r\n}\r\n","import { limitNumber, makeNumberUnitPair } from \"../../Generic/src/number-util\";\r\nimport { parseJsonOrUndefined } from \"../../Generic/src/string-util\";\r\nimport { DevicesValue } from \"./responsive-interface\";\r\n\r\n/**\r\n * Make an empty `DevicesValue` object.\r\n *\r\n * @param {string[]} devices - The allowed devices.\r\n *\r\n * @return {DevicesValue} Empty `DevicesValue` object.\r\n */\r\nfunction makeEmptyDevicesValue(devices: string[]): DevicesValue {\r\n\tconst value: DevicesValue = {};\r\n\r\n\tdevices.forEach((device) => {\r\n\t\tvalue[device] = \"\";\r\n\t});\r\n\r\n\treturn value;\r\n}\r\n\r\n/**\r\n * Make a `DevicesValue` object from a JSON encoded string or `DevicesValue` object.\r\n *\r\n * @export\r\n *\r\n * @param {string[]} devices - The allowed devices.\r\n * @param {(string | DevicesValue)} value - The value to convert.\r\n * @param {number|undefined|null} min - The minimum value.\r\n * @param {number|undefined|null} max - The maximum value.\r\n *\r\n * @return {DevicesValue}\r\n */\r\nexport function makeDevicesValue(\r\n\tfieldType: string,\r\n\tdevices: string[],\r\n\tvalue: string | DevicesValue,\r\n\tmin?: number | null,\r\n\tmax?: number | null,\r\n): DevicesValue {\r\n\tconst valueObject =\r\n\t\t\"string\" === typeof value\r\n\t\t\t? parseJsonOrUndefined<DevicesValue>(value)\r\n\t\t\t: value;\r\n\r\n\tif (!valueObject) {\r\n\t\treturn makeEmptyDevicesValue(devices);\r\n\t}\r\n\r\n\tconst devicesValue: DevicesValue = {};\r\n\r\n\tdevices.forEach((device) => {\r\n\t\tif (!valueObject.hasOwnProperty(device)) {\r\n\t\t\tdevicesValue[device] = \"\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet val = valueObject[device];\r\n\r\n\t\tif (fieldType === \"number\") {\r\n\t\t\tval = parseNumberValue(valueObject[device], min, max);\r\n\t\t}\r\n\r\n\t\tdevicesValue[device] =\r\n\t\t\t\"string\" !== typeof val && \"number\" !== typeof val ? \"\" : val;\r\n\t});\r\n\r\n\treturn devicesValue;\r\n}\r\n\r\n/**\r\n * Make a value for an input field.\r\n *\r\n * @export\r\n *\r\n * @param {string | number} value - The value to convert.\r\n * @param {number|undefined|null} min - The minimum value.\r\n * @param {number|undefined|null} max - The maximum value.\r\n *\r\n * @return {string|number} The value for the input field.\r\n */\r\nexport function parseNumberValue(\r\n\tvalue: string | number,\r\n\tmin?: number | null,\r\n\tmax?: number | null,\r\n): string | number {\r\n\tlet strValue = String(value).trim();\r\n\r\n\tif (strValue === \"\") {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tconst startTypingNegative = strValue === \"-\";\r\n\tif (startTypingNegative) return \"-\";\r\n\r\n\tconst startTypingDecimal = strValue.endsWith(\".\");\r\n\tstrValue = startTypingDecimal ? strValue.replace(\".\", \"\") : strValue;\r\n\r\n\tconst valueObject = makeNumberUnitPair(value);\r\n\r\n\tif (\"\" === valueObject.number) {\r\n\t\treturn startTypingDecimal ? \"0.\" : \"\";\r\n\t}\r\n\r\n\tlet numeric: number | \"\" = valueObject.number;\r\n\r\n\tif (\"number\" === typeof min || \"number\" === typeof max) {\r\n\t\tnumeric = limitNumber(numeric, min, max);\r\n\t}\r\n\r\n\treturn startTypingDecimal ? numeric + \".\" : numeric;\r\n}\r\n","import { makeNumberUnitPair } from \"../../Generic/src/number-util\";\r\nimport { parseJsonOrUndefined } from \"../../Generic/src/string-util\";\r\nimport { MarginPaddingDimension, MarginPaddingValue } from \"./margin-padding-interface\";\r\n\r\n/**\r\n * Make a value for an input number field in margin/padding control.\r\n *\r\n * It shouldn't contain unit because it's a number field.\r\n *\r\n * @export\r\n *\r\n * @param {string | number} value - The value to convert.\r\n * @return {string|number} The value for the input field.\r\n */\r\nexport function makeMarginPaddingFieldValue(\r\n\tvalue: string | number,\r\n): string | number {\r\n\tlet strValue = String(value).trim();\r\n\r\n\tif (strValue === \"\") {\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tconst startTypingNegative = strValue === \"-\";\r\n\tif (startTypingNegative) return \"-\";\r\n\r\n\tconst startTypingDecimal = strValue.endsWith(\".\");\r\n\tstrValue = startTypingDecimal ? strValue.replace(\".\", \"\") : strValue;\r\n\r\n\tconst valueObject = makeNumberUnitPair(value);\r\n\r\n\tif (\"\" === valueObject.number) {\r\n\t\treturn startTypingDecimal ? \"0.\" : \"\";\r\n\t}\r\n\r\n\tlet numeric = String(valueObject.number);\r\n\r\n\treturn startTypingDecimal ? numeric + \".\" : numeric;\r\n}\r\n\r\n/**\r\n * Create a `MarginPaddingValue` object without unit.\r\n *\r\n * Used for the input field's values in the customizer control.\r\n *\r\n * @param {string[]} dimensions - The allowed dimensions.\r\n * @param {MarginPaddingValue} value - The value to parse.\r\n *\r\n * @return {MarginPaddingValue} - The value as object (without unit).\r\n */\r\nexport function makeObjValueWithoutUnit(\r\n\tdimensions: string[],\r\n\tvalue: MarginPaddingValue,\r\n): MarginPaddingValue {\r\n\tconst newValue: Record<string, number | string> = {};\r\n\r\n\tfor (let i = 0; i < dimensions.length; i++) {\r\n\t\tconst dimension = dimensions[i];\r\n\t\tnewValue[dimension] = dimensions[i];\r\n\t}\r\n\r\n\tfor (const position in value) {\r\n\t\tif (!dimensions.includes(position)) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (!value.hasOwnProperty(position)) continue;\r\n\t\tif (!newValue.hasOwnProperty(position)) continue;\r\n\r\n\t\tconst positionValue = value[position];\r\n\r\n\t\tif (\"\" !== positionValue) {\r\n\t\t\tnewValue[position] = makeMarginPaddingFieldValue(positionValue);\r\n\t\t}\r\n\t}\r\n\r\n\treturn newValue as MarginPaddingValue;\r\n}\r\n\r\n/**\r\n * Create a `MarginPaddingValue` object with unit.\r\n *\r\n * Used for the customizer setting's value.\r\n *\r\n * @param {string[]} dimensions - The allowed dimensions.\r\n * @param {string} unit - The unit.\r\n * @param {MarginPaddingValue} value - The value to parse.\r\n *\r\n * @return {MarginPaddingValue} - The value as object (with unit).\r\n */\r\nexport function makeObjValueWithUnit(\r\n\tdimensions: string[],\r\n\tunit: string,\r\n\tvalue: MarginPaddingValue,\r\n): MarginPaddingValue {\r\n\tconst newValue: Record<string, number | string> = {};\r\n\r\n\tfor (let i = 0; i < dimensions.length; i++) {\r\n\t\tconst dimension = dimensions[i];\r\n\t\tnewValue[dimension] = dimensions[i];\r\n\t}\r\n\r\n\tfor (const position in value) {\r\n\t\tif (!dimensions.includes(position)) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (!newValue.hasOwnProperty(position)) continue;\r\n\r\n\t\tconst positionValue = value[position as MarginPaddingDimension];\r\n\r\n\t\tif (\"\" !== positionValue) {\r\n\t\t\tconst singleValue = makeMarginPaddingFieldValue(positionValue);\r\n\t\t\tnewValue[position] = singleValue + unit;\r\n\t\t}\r\n\t}\r\n\r\n\treturn newValue as MarginPaddingValue;\r\n}\r\n\r\nexport function makeObjValueWithoutUnitFromJson(\r\n\tdimensions: string[],\r\n\tjsonStr: string | null | undefined,\r\n): MarginPaddingValue {\r\n\tconst value = parseJsonOrUndefined<MarginPaddingValue>(jsonStr);\r\n\r\n\tif (!value) {\r\n\t\treturn makeEmptyValueObj(dimensions);\r\n\t}\r\n\r\n\treturn makeObjValueWithoutUnit(dimensions, value);\r\n}\r\n\r\nexport function makeEmptyValueObj(dimensions: string[]): MarginPaddingValue {\r\n\tconst value: Record<string, number | string> = {};\r\n\r\n\tfor (let i = 0; i < dimensions.length; i++) {\r\n\t\tconst dimension = dimensions[i];\r\n\r\n\t\t// We allow empty strings for each dimension.\r\n\t\tvalue[dimension] = \"\";\r\n\t}\r\n\r\n\treturn value as MarginPaddingValue;\r\n}\r\n","export default function DeviceButtons(props: { devices: string[] }) {\r\n\treturn (\r\n\t\t<div className=\"wpbf-device-buttons\">\r\n\t\t\t{props.devices.map((device, index) => {\r\n\t\t\t\tconst deviceClassName = `dashicons dashicons-${device === \"mobile\" ? \"smartphone\" : device}`;\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tclassName={`wpbf-device-button wpbf-device-button-${device} ${0 === index ? \" is-active\" : \"\"}`}\r\n\t\t\t\t\t\tdata-wpbf-device={device}\r\n\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i className={deviceClassName}></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React, { useRef, useState } from \"react\";\r\nimport {\r\n\tMarginPaddingDimension,\r\n\tMarginPaddingDimensionValuePair,\r\n\tMarginPaddingValue,\r\n} from \"./margin-padding-interface\";\r\nimport {\r\n\tmakeObjValueWithoutUnit,\r\n\tmakeObjValueWithoutUnitFromJson,\r\n\tmakeObjValueWithUnit,\r\n} from \"./margin-padding-util\";\r\nimport DeviceButtons from \"../../Responsive/src/DeviceButtons\";\r\nimport { encodeJsonOrDefault } from \"../../Generic/src/string-util\";\r\n\r\nexport default function MarginPaddingForm(props: {\r\n\tid: string;\r\n\ttype: string;\r\n\tsubtype: string;\r\n\tlabel?: string;\r\n\tdescription?: string;\r\n\tdefault?: any;\r\n\tdefaultArray: MarginPaddingValue;\r\n\tvalueArray: MarginPaddingValue;\r\n\tunit: string;\r\n\tsaveAsJson: boolean;\r\n\tdontSaveUnit: boolean;\r\n\tdimensions: string[];\r\n\tdevices?: string[] | undefined;\r\n\tisResponsive: boolean;\r\n\tupdateCustomizerSetting?: (val: string | MarginPaddingValue) => void;\r\n\toverrideUpdateComponentStateFn?: (\r\n\t\tfn: (val: string | MarginPaddingValue) => void,\r\n\t) => void;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tconst [inputValues, setInputValues] = useState(() => {\r\n\t\treturn props.valueArray;\r\n\t});\r\n\r\n\tconst defaultDefined =\r\n\t\t\"\" !== props.default && \"undefined\" !== typeof props.default;\r\n\r\n\tfunction updateComponentState(val: string | MarginPaddingValue) {\r\n\t\tconst newVal =\r\n\t\t\ttypeof val === \"string\"\r\n\t\t\t\t? makeObjValueWithoutUnitFromJson(props.dimensions, val)\r\n\t\t\t\t: makeObjValueWithoutUnit(props.dimensions, val);\r\n\r\n\t\tsetInputValues(newVal);\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tfunction handleInputChange(\r\n\t\te: React.ChangeEvent<HTMLInputElement>,\r\n\t\tdimension: string,\r\n\t) {\r\n\t\tif (!props.dimensions.includes(dimension)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!e.target) return;\r\n\r\n\t\tconst values = { ...inputValues };\r\n\t\tif (!values.hasOwnProperty(dimension)) return;\r\n\r\n\t\t/**\r\n\t\t * On input change, the value comes from a number field.\r\n\t\t * That means we can just use its value without the need to parse it.\r\n\t\t */\r\n\t\tvalues[dimension as MarginPaddingDimension] = e.target.value;\r\n\r\n\t\tsetInputValues(values);\r\n\t\tsaveToCustomizerSetting(values);\r\n\t}\r\n\r\n\tfunction handleResetButtonClick(\r\n\t\t_e: React.MouseEvent<HTMLButtonElement>,\r\n\t\tdevice?: string,\r\n\t) {\r\n\t\tconst defaultValues = defaultDefined\r\n\t\t\t? props.defaultArray\r\n\t\t\t: props.valueArray;\r\n\r\n\t\tif (!device) {\r\n\t\t\tsaveToCustomizerSetting(defaultValues);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst existingValues = { ...inputValues };\r\n\r\n\t\tfor (const dimension in existingValues) {\r\n\t\t\tif (!existingValues.hasOwnProperty(dimension)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst hasDeviceStr = dimension.includes(device + \"_\");\r\n\t\t\tif (!hasDeviceStr) continue;\r\n\r\n\t\t\tif (!defaultValues.hasOwnProperty(dimension)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\texistingValues[dimension as MarginPaddingDimension] =\r\n\t\t\t\tdefaultValues[dimension as MarginPaddingDimension];\r\n\t\t}\r\n\r\n\t\tsaveToCustomizerSetting(existingValues);\r\n\t}\r\n\r\n\tfunction saveToCustomizerSetting(val: MarginPaddingValue) {\r\n\t\t/**\r\n\t\t * The \"dontSaveUnit\" option is used to support PBF's old \"responsive_padding\" control.\r\n\t\t */\r\n\t\tconst newVal = props.dontSaveUnit\r\n\t\t\t? makeObjValueWithoutUnit(props.dimensions, val)\r\n\t\t\t: makeObjValueWithUnit(props.dimensions, props.unit, val);\r\n\r\n\t\t/**\r\n\t\t * The \"saveAsJson\" option is used to support PBF's old \"responsive_padding\" control.\r\n\t\t */\r\n\t\tif (props.saveAsJson) {\r\n\t\t\tprops.updateCustomizerSetting?.(\r\n\t\t\t\tencodeJsonOrDefault<MarginPaddingValue>(val),\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tprops.updateCustomizerSetting?.(newVal);\r\n\t}\r\n\r\n\tfunction makeMappable(device?: string) {\r\n\t\tconst items: MarginPaddingDimensionValuePair[] = [];\r\n\r\n\t\tfor (const dimension in inputValues) {\r\n\t\t\tif (!inputValues.hasOwnProperty(dimension)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (!device) {\r\n\t\t\t\titems.push({\r\n\t\t\t\t\tdimension: dimension as MarginPaddingDimension,\r\n\t\t\t\t\tvalue: inputValues[dimension as MarginPaddingDimension],\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst hasDeviceStr = dimension.includes(device + \"_\");\r\n\t\t\tif (!hasDeviceStr) continue;\r\n\r\n\t\t\titems.push({\r\n\t\t\t\tdimension: dimension as MarginPaddingDimension,\r\n\t\t\t\tvalue: inputValues[dimension as MarginPaddingDimension],\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn items;\r\n\t}\r\n\r\n\tfunction renderFields(\r\n\t\tdevice: string,\r\n\t\tgroup: MarginPaddingDimensionValuePair[],\r\n\t) {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tclassName=\"wpbf-control-reset\"\r\n\t\t\t\t\tonClick={(e) => handleResetButtonClick(e, device)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t\t<div className=\"wpbf-control-left-col\">\r\n\t\t\t\t\t\t<div className=\"wpbf-control-fields\">\r\n\t\t\t\t\t\t\t{group.map((item, i) => {\r\n\t\t\t\t\t\t\t\tconst inputClassName = `wpbf-control-input wpbf-control-input${device ? `-${device}` : \"\"}-${item.dimension}`;\r\n\t\t\t\t\t\t\t\tconst inputId = `_customize-input-${props.id}${device ? `-${device}` : \"\"}-${item.dimension}`;\r\n\t\t\t\t\t\t\t\tconst label = device\r\n\t\t\t\t\t\t\t\t\t? item.dimension.replace(device + \"_\", \"\")\r\n\t\t\t\t\t\t\t\t\t: item.dimension;\r\n\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div className=\"wpbf-control-field\" key={i}>\r\n\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\tid={inputId}\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={item.value || 0 === item.value ? item.value : \"\"}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={inputClassName}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleInputChange(e, item.dimension)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<label className=\"wpbf-control-sublabel\" htmlFor={inputId}>\r\n\t\t\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"wpbf-control-right-col\">\r\n\t\t\t\t\t\t<span ref={unitRef} className=\"wpbf-control-unit\">\r\n\t\t\t\t\t\t\t{props.unit}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tfunction renderFieldGroups() {\r\n\t\tif (!props.isResponsive || !props.devices || !props.devices.length) {\r\n\t\t\treturn renderFields(\"\", makeMappable());\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t{props.devices.map((device, index) => {\r\n\t\t\t\t\tconst isActive = 0 === index;\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`wpbf-control-device wpbf-control-${device} ${isActive ? \"is-active\" : \"\"}`}\r\n\t\t\t\t\t\t\tdata-wpbf-device={device}\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{renderFields(device, makeMappable(device))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\r\n\tfunction renderDeviceButtons() {\r\n\t\tif (!props.isResponsive || !props.devices || !props.devices.length) {\r\n\t\t\treturn <></>;\r\n\t\t}\r\n\r\n\t\treturn <DeviceButtons devices={props.devices} />;\r\n\t}\r\n\r\n\tconst unitRef = useRef(null);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<header className=\"wpbf-control-header\">\r\n\t\t\t\t{props.label && (\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\tclassName=\"customize-control-title\"\r\n\t\t\t\t\t\thtmlFor={`wpbf-control-input-${props.type}-top`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"customize-control-title\">{props.label}</span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{renderDeviceButtons()}\r\n\t\t\t</header>\r\n\r\n\t\t\t{props.description && (\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName=\"customize-control-description description\"\r\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: props.description }}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"customize-control-notifications-container\"\r\n\t\t\t\tref={props.setNotificationContainer}\r\n\t\t\t/>\r\n\r\n\t\t\t<div className=\"wpbf-control-form\">{renderFieldGroups()}</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","import MarginPaddingForm from \"./MarginPaddingForm\";\nimport { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\nimport {\n\tMarginPaddingValue,\n\tWpbfMarginPaddingControl,\n} from \"./margin-padding-interface\";\nimport { createRoot } from \"react-dom/client\";\nimport { makeObjValueWithoutUnitFromJson } from \"./margin-padding-util\";\n\nexport default function MarginPaddingControl(customizer: WpbfCustomize) {\n\treturn customizer.Control.extend<WpbfMarginPaddingControl>({\n\t\tinitialize: function initialize(id, params) {\n\t\t\t// Bind functions to this control context for passing as React props.\n\t\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\n\t\t\tthis.overrideUpdateComponentStateFn =\n\t\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\n\t\t\tthis.updateCustomizerSetting = this.updateCustomizerSetting?.bind(this);\n\n\t\t\tcustomizer.Control.prototype.initialize.call(this, id, params);\n\n\t\t\tconst control = this;\n\n\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\n\t\t\tfunction onRemoved(removedControl: AnyWpbfCustomizeControl) {\n\t\t\t\tif (control === removedControl) {\n\t\t\t\t\tcontrol.destroy?.();\n\t\t\t\t\tcontrol.container?.remove();\n\t\t\t\t\tcustomizer.control.unbind(\"removed\", onRemoved);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcustomizer.control.bind(\"removed\", onRemoved);\n\t\t},\n\n\t\t/**\n\t\t * Set notification container and render.\n\t\t *\n\t\t * This is called when the React component is mounted.\n\t\t */\n\t\tsetNotificationContainer: function setNotificationContainer(el) {\n\t\t\tif (this.notifications) this.notifications.container = jQuery(el);\n\t\t\tthis.notifications?.render();\n\t\t},\n\n\t\t/**\n\t\t * Render the control into the DOM.\n\t\t *\n\t\t * This is called from the Control#embed() method in the parent class.\n\t\t */\n\t\trenderContent: function renderContent() {\n\t\t\tconst isResponsive =\n\t\t\t\t\"responsive-margin\" === this.params?.subtype ||\n\t\t\t\t\"responsive-padding\" === this.params?.subtype;\n\n\t\t\tif (!this.root && this.container) {\n\t\t\t\tthis.root = createRoot(this.container[0]);\n\t\t\t}\n\n\t\t\tthis.root?.render(\n\t\t\t\t<MarginPaddingForm\n\t\t\t\t\tid={this.setting?.id ?? \"\"}\n\t\t\t\t\ttype={this.params?.type}\n\t\t\t\t\tsubtype={this.params?.subtype}\n\t\t\t\t\tlabel={this.params?.label}\n\t\t\t\t\tdescription={this.params?.description}\n\t\t\t\t\tdefault={this.params?.default}\n\t\t\t\t\tdefaultArray={this.params?.defaultArray}\n\t\t\t\t\tvalueArray={this.params?.valueArray}\n\t\t\t\t\tunit={this.params?.unit}\n\t\t\t\t\tsaveAsJson={this.params?.saveAsJson}\n\t\t\t\t\tdontSaveUnit={this.params?.dontSaveUnit}\n\t\t\t\t\tdimensions={this.params?.dimensions}\n\t\t\t\t\tdevices={this.params?.devices}\n\t\t\t\t\tisResponsive={isResponsive}\n\t\t\t\t\tupdateCustomizerSetting={this.updateCustomizerSetting}\n\t\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\n\t\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\n\t\t\t\t/>,\n\t\t\t);\n\n\t\t\tif (isResponsive) {\n\t\t\t\tthis.container?.addClass(\"margin-padding-control\");\n\t\t\t\tthis.container?.data(\"control-subtype\", this.params?.subtype);\n\t\t\t}\n\n\t\t\tif (this.params?.allowCollapse) {\n\t\t\t\tthis.container?.addClass(\"allowCollapse\");\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * After control has been first rendered, start re-rendering when setting changes.\n\t\t *\n\t\t * React is available to be used here instead of the customizer.Element abstraction.\n\t\t */\n\t\tready: function ready() {\n\t\t\t// Update component value's state when customizer setting's value is changed.\n\t\t\tthis.setting?.bind((val) => {\n\t\t\t\tconst newVal =\n\t\t\t\t\ttypeof val === \"string\"\n\t\t\t\t\t\t? makeObjValueWithoutUnitFromJson(this.params?.dimensions, val)\n\t\t\t\t\t\t: val;\n\n\t\t\t\tthis.updateComponentState?.(newVal);\n\t\t\t});\n\t\t},\n\n\t\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\n\t\t\tif (val === undefined) return;\n\t\t\tthis.setting?.set(val);\n\t\t},\n\n\t\t/**\n\t\t * This method will be overriden by the rendered component via overrideUpdateComponentStateFn.\n\t\t */\n\t\tupdateComponentState: (_val: MarginPaddingValue | string) => {},\n\n\t\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(\n\t\t\tfn,\n\t\t) {\n\t\t\tthis.updateComponentState = fn;\n\t\t},\n\n\t\t/**\n\t\t * Handle removal/de-registration of the control.\n\t\t *\n\t\t * This is essentially the inverse of the Control#embed() method.\n\t\t *\n\t\t * @link https://core.trac.wordpress.org/ticket/31334\n\t\t */\n\t\tdestroy: function destroy() {\n\t\t\tthis.root?.unmount();\n\t\t\tthis.root = undefined;\n\n\t\t\t// Call destroy method in parent if it exists (as of #31334).\n\t\t\tcustomizer.Control.prototype.destroy?.call(this);\n\t\t},\n\t});\n}\n","import ColorControl from \"./ColorControl\";\r\nimport MulticolorControl from \"./MulticolorControl\";\r\n\r\n// Register control type with Customizer.\r\nif (window.wp.customize) {\r\n\tif (ColorControl) {\r\n\t\twindow.wp.customize.controlConstructor[\"wpbf-color\"] = ColorControl;\r\n\t}\r\n\r\n\tif (MulticolorControl) {\r\n\t\twindow.wp.customize.controlConstructor[\"wpbf-multicolor\"] =\r\n\t\t\tMulticolorControl;\r\n\t}\r\n}\r\n","import { WpbfCustomizeSetting } from \"../../Base/src/base-interface\";\r\nimport { WpbfDimensionControl } from \"./dimension-interface\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n};\r\n\r\ndeclare var wpbfDimensionControlL10n: Record<string, string>;\r\n\r\nwp.customize.controlConstructor[\"wpbf-dimension\"] =\r\n\twp.customize.wpbfDynamicControl.extend<WpbfDimensionControl>({\r\n\t\tinitWpbfControl: function (\r\n\t\t\tthis: WpbfDimensionControl,\r\n\t\t\tcontrol?: WpbfDimensionControl,\r\n\t\t) {\r\n\t\t\tcontrol = control || this;\r\n\t\t\tlet value;\r\n\r\n\t\t\t// Notifications.\r\n\t\t\tcontrol.wpbfNotifications!();\r\n\r\n\t\t\t// Save the value\r\n\t\t\tcontrol.container.on(\"change keyup paste\", \"input\", function () {\r\n\t\t\t\tvalue = jQuery(this).val();\r\n\t\t\t\tcontrol.setting?.set(value);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handles notifications.\r\n\t\t */\r\n\t\twpbfNotifications: function (this: WpbfDimensionControl) {\r\n\t\t\tlet control = this;\r\n\r\n\t\t\tconst allowUnitless = control.params.allowUnitless;\r\n\r\n\t\t\twp.customize(control.id, function (setting) {\r\n\t\t\t\tsetting.bind(function (value) {\r\n\t\t\t\t\tconst code = \"long_title\";\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t!control.validateCssValue!(value) &&\r\n\t\t\t\t\t\t(!allowUnitless || isNaN(value))\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tsetting.notifications.add(\r\n\t\t\t\t\t\t\tcode,\r\n\t\t\t\t\t\t\t// @ts-ignore - There's mistake in the type definition.\r\n\t\t\t\t\t\t\tnew wp.customize.Notification(code, {\r\n\t\t\t\t\t\t\t\ttype: \"warning\",\r\n\t\t\t\t\t\t\t\tmessage: wpbfDimensionControlL10n[\"invalid-value\"],\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t(setting as WpbfCustomizeSetting<any>).notifications.remove(code);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tvalidateCssValue: function (value: string | number) {\r\n\t\t\tconst control = this as WpbfDimensionControl;\r\n\t\t\tconst validUnits = [\r\n\t\t\t\t\"fr\",\r\n\t\t\t\t\"rem\",\r\n\t\t\t\t\"em\",\r\n\t\t\t\t\"ex\",\r\n\t\t\t\t\"%\",\r\n\t\t\t\t\"px\",\r\n\t\t\t\t\"cm\",\r\n\t\t\t\t\"mm\",\r\n\t\t\t\t\"in\",\r\n\t\t\t\t\"pt\",\r\n\t\t\t\t\"pc\",\r\n\t\t\t\t\"ch\",\r\n\t\t\t\t\"vh\",\r\n\t\t\t\t\"vw\",\r\n\t\t\t\t\"vmin\",\r\n\t\t\t\t\"vmax\",\r\n\t\t\t];\r\n\r\n\t\t\t// Whitelist values.\r\n\t\t\tif (\r\n\t\t\t\t!value ||\r\n\t\t\t\t\"\" === value ||\r\n\t\t\t\t0 === value ||\r\n\t\t\t\t\"0\" === value ||\r\n\t\t\t\t\"auto\" === value ||\r\n\t\t\t\t\"inherit\" === value ||\r\n\t\t\t\t\"initial\" === value\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tconst valueStr = typeof value === \"string\" ? value : value.toString();\r\n\r\n\t\t\t// Skip checking if calc().\r\n\t\t\tif (0 <= valueStr.indexOf(\"calc(\") && 0 <= valueStr.indexOf(\")\")) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tconst numericValue = parseFloat(valueStr);\r\n\r\n\t\t\tconst unit = valueStr.replace(numericValue.toString(), \"\");\r\n\r\n\t\t\t// Allow unitless.\r\n\t\t\tif (!unit) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t// Check for multiple values.\r\n\t\t\tconst multiples = valueStr.split(\" \");\r\n\t\t\tlet multiplesValid = true;\r\n\r\n\t\t\tif (2 <= multiples.length) {\r\n\t\t\t\tmultiples.forEach(function (item) {\r\n\t\t\t\t\tif (item && !control.validateCssValue!(item)) {\r\n\t\t\t\t\t\tmultiplesValid = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn multiplesValid;\r\n\t\t\t}\r\n\r\n\t\t\t// Check the validity of the numeric value and units.\r\n\t\t\treturn !isNaN(numericValue) && -1 !== validUnits.indexOf(unit);\r\n\t\t},\r\n\t});\r\n","import { WpbfEditorControl } from \"./editor-interface\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n\teditor: any;\r\n};\r\n\r\ndeclare var tinyMCE: any;\r\n\r\n/* global tinyMCE */\r\nwp.customize.controlConstructor[\"wpbf-editor\"] =\r\n\twp.customize.wpbfDynamicControl.extend<WpbfEditorControl>({\r\n\t\tinitWpbfControl: function (\r\n\t\t\tthis: WpbfEditorControl,\r\n\t\t\tctrl?: WpbfEditorControl,\r\n\t\t) {\r\n\t\t\tconst control = ctrl || this;\r\n\t\t\tconst element = control.container.find(\"textarea\");\r\n\t\t\tconst id = \"wpbf-editor-\" + control.id.replace(\"[\", \"\").replace(\"]\", \"\");\r\n\r\n\t\t\tconst defaultParams = {\r\n\t\t\t\ttinymce: {\r\n\t\t\t\t\twpautop: true,\r\n\t\t\t\t},\r\n\t\t\t\tquicktags: true,\r\n\t\t\t\tmediaButtons: true,\r\n\t\t\t};\r\n\r\n\t\t\t// Overwrite the default paramaters if choices is defined.\r\n\t\t\tif (wp.editor && wp.editor.initialize) {\r\n\t\t\t\twp.editor.initialize(\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tjQuery.extend({}, defaultParams, {\r\n\t\t\t\t\t\ttinymce: control.params.tinymce,\r\n\t\t\t\t\t\tquicktags: control.params.quicktags,\r\n\t\t\t\t\t}),\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tconst editor = tinyMCE.get(id);\r\n\r\n\t\t\tif (editor) {\r\n\t\t\t\teditor.onChange.add(function (ed: any) {\r\n\t\t\t\t\ted.save();\r\n\t\t\t\t\tconst content = editor.getContent();\r\n\t\t\t\t\telement.val(content).trigger(\"change\");\r\n\t\t\t\t\twp.customize.instance(control.id).set(content);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n","import { WpbfGenericControl } from \"./generic-interface\";\r\nimport {\r\n\tlimitNumber,\r\n\tlimitNumberWithUnit,\r\n\tnormalizeMaxValue,\r\n} from \"./number-util\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n};\r\n\r\nwp.customize.controlConstructor[\"wpbf-generic\"] =\r\n\twp.customize.wpbfDynamicControl.extend<WpbfGenericControl>({\r\n\t\tinitWpbfControl: function (\r\n\t\t\tthis: WpbfGenericControl,\r\n\t\t\tcontrol?: WpbfGenericControl,\r\n\t\t) {\r\n\t\t\tcontrol = control || this;\r\n\t\t\tconst params = control.params;\r\n\r\n\t\t\tif (\"wpbf-generic\" !== params.type) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst inputSelector = \".wpbf-control-form input\";\r\n\t\t\tconst textareaSelector = \".wpbf-control-form textarea\";\r\n\r\n\t\t\tcontrol.container\r\n\t\t\t\t.find(`${inputSelector}, ${textareaSelector}`)\r\n\t\t\t\t.on(\"input\", function () {\r\n\t\t\t\t\tlet fieldValue: string | number =\r\n\t\t\t\t\t\tthis instanceof HTMLInputElement ||\r\n\t\t\t\t\t\tthis instanceof HTMLTextAreaElement\r\n\t\t\t\t\t\t\t? this.value\r\n\t\t\t\t\t\t\t: \"\";\r\n\r\n\t\t\t\t\tif (\"number\" === params.subtype || \"number-unit\" === params.subtype) {\r\n\t\t\t\t\t\tparams.max = normalizeMaxValue(params.min, params.max);\r\n\r\n\t\t\t\t\t\tfieldValue =\r\n\t\t\t\t\t\t\t\"number\" === params.subtype\r\n\t\t\t\t\t\t\t\t? limitNumber(fieldValue, params.min, params.max)\r\n\t\t\t\t\t\t\t\t: limitNumberWithUnit(fieldValue, params.min, params.max);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontrol.setting?.set(fieldValue);\r\n\t\t\t\t});\r\n\t\t},\r\n\t});\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { WpbfAssocArrayControl } from \"./generic-interface\";\r\n\r\nif (window.wp.customize) {\r\n\tsetupAssocArrayControl(window.wp.customize);\r\n}\r\n\r\nfunction setupAssocArrayControl(customizer: WpbfCustomize) {\r\n\tcustomizer.controlConstructor[\"wpbf-assoc-array\"] =\r\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfAssocArrayControl>({\r\n\t\t\tinitWpbfControl: function (\r\n\t\t\t\tthis: WpbfAssocArrayControl,\r\n\t\t\t\tcontrol?: WpbfAssocArrayControl,\r\n\t\t\t) {\r\n\t\t\t\tcontrol = control || this;\r\n\t\t\t\tif (!control) return;\r\n\r\n\t\t\t\tcontrol.setting?.bind((value: Record<string, any>) => {\r\n\t\t\t\t\tcontrol.updateComponentState?.(value);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\t\tfunction onRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\t\tif (control === removedControl) {\r\n\t\t\t\t\t\tcontrol?.destroy?.();\r\n\t\t\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\t\t\tcustomizer.control.unbind(\"removed\", onRemoved);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcustomizer.control.bind(\"removed\", onRemoved);\r\n\t\t\t},\r\n\r\n\t\t\tupdateComponentState: function (\r\n\t\t\t\tthis: WpbfAssocArrayControl,\r\n\t\t\t\tvalue: Record<string, any>,\r\n\t\t\t) {\r\n\t\t\t\tconst fields = this.container[0].querySelectorAll(\r\n\t\t\t\t\t\".wpbf-control-form input[data-setting-prop]\",\r\n\t\t\t\t);\r\n\t\t\t\tif (!fields.length) return;\r\n\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\tif (!(field instanceof HTMLInputElement)) return;\r\n\t\t\t\t\tconst prop = field.dataset.settingProp;\r\n\t\t\t\t\tif (!prop || !value[prop]) return;\r\n\t\t\t\t\tfield.value = value[prop];\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tready: function () {\r\n\t\t\t\tif (!this.container) return;\r\n\r\n\t\t\t\tthis.currentValue = this.setting?.get();\r\n\r\n\t\t\t\tconst fields = this.container[0].querySelectorAll(\r\n\t\t\t\t\t\"input[data-setting-prop]\",\r\n\t\t\t\t);\r\n\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\tif (!(field instanceof HTMLInputElement)) return;\r\n\r\n\t\t\t\t\tfield.addEventListener(\"change\", (e) => {\r\n\t\t\t\t\t\tconst values: Record<string, any> = {};\r\n\r\n\t\t\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\t\t\tif (!(field instanceof HTMLInputElement)) return;\r\n\t\t\t\t\t\t\tconst prop = field.dataset.settingProp;\r\n\t\t\t\t\t\t\tif (!prop) return;\r\n\t\t\t\t\t\t\tvalues[prop] = field.value;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tthis.setting?.set(values);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tthis.setting?.bind((val) => {\r\n\t\t\t\t\tcontrol.updateComponentState?.(val);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tdestroy: function () {},\r\n\t\t});\r\n}\r\n","import { encodeJsonOrDefault } from \"./string-util\";\r\nimport { WpbfResponsiveGenericControl } from \"./generic-interface\";\r\nimport {\r\n\tlimitNumber,\r\n\tlimitNumberWithUnit,\r\n\tnormalizeMaxValue,\r\n} from \"./number-util\";\r\nimport { makeDevicesValue } from \"../../Responsive/src/responsive-util\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n};\r\n\r\nwp.customize.controlConstructor[\"wpbf-responsive-generic\"] =\r\n\twp.customize.wpbfDynamicControl.extend<WpbfResponsiveGenericControl>(\r\n\t\t{\r\n\t\t\tinitWpbfControl: function (\r\n\t\t\t\tthis: WpbfResponsiveGenericControl,\r\n\t\t\t\tcontrol?: WpbfResponsiveGenericControl,\r\n\t\t\t) {\r\n\t\t\t\tcontrol = control || this;\r\n\t\t\t\tconst params = control.params;\r\n\r\n\t\t\t\tif (\"wpbf-responsive-generic\" !== params.type) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst inputSelector = \".wpbf-control-form input\";\r\n\t\t\t\tconst textareaSelector = \".wpbf-control-form textarea\";\r\n\r\n\t\t\t\tcontrol.container\r\n\t\t\t\t\t.find(`${inputSelector}, ${textareaSelector}`)\r\n\t\t\t\t\t.on(\"input\", function (e) {\r\n\t\t\t\t\t\tconst existingValue = control.setting?.get();\r\n\r\n\t\t\t\t\t\tconst valueRecord =\r\n\t\t\t\t\t\t\t\"string\" === typeof existingValue\r\n\t\t\t\t\t\t\t\t? makeDevicesValue(\r\n\t\t\t\t\t\t\t\t\t\tparams.subtype,\r\n\t\t\t\t\t\t\t\t\t\tparams.devices,\r\n\t\t\t\t\t\t\t\t\t\texistingValue,\r\n\t\t\t\t\t\t\t\t\t\tparams.min,\r\n\t\t\t\t\t\t\t\t\t\tparams.max,\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: existingValue;\r\n\r\n\t\t\t\t\t\tconst parent = this.parentNode;\r\n\r\n\t\t\t\t\t\tconst device =\r\n\t\t\t\t\t\t\tparent instanceof HTMLElement\r\n\t\t\t\t\t\t\t\t? parent.dataset.wpbfDevice\r\n\t\t\t\t\t\t\t\t: undefined;\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t!device ||\r\n\t\t\t\t\t\t\t!valueRecord ||\r\n\t\t\t\t\t\t\t!valueRecord.hasOwnProperty(device)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet fieldValue: string | number =\r\n\t\t\t\t\t\t\tthis instanceof HTMLInputElement ||\r\n\t\t\t\t\t\t\tthis instanceof HTMLTextAreaElement\r\n\t\t\t\t\t\t\t\t? this.value\r\n\t\t\t\t\t\t\t\t: \"\";\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\"number\" === params.subtype ||\r\n\t\t\t\t\t\t\t\"number-unit\" === params.subtype\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tparams.max = normalizeMaxValue(params.min, params.max);\r\n\r\n\t\t\t\t\t\t\tfieldValue =\r\n\t\t\t\t\t\t\t\t\"number\" === params.subtype\r\n\t\t\t\t\t\t\t\t\t? limitNumber(fieldValue, params.min, params.max)\r\n\t\t\t\t\t\t\t\t\t: limitNumberWithUnit(fieldValue, params.min, params.max);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvalueRecord[device] = fieldValue;\r\n\r\n\t\t\t\t\t\tconst customizerValue = params.saveAsJson\r\n\t\t\t\t\t\t\t? encodeJsonOrDefault(valueRecord)\r\n\t\t\t\t\t\t\t: valueRecord;\r\n\r\n\t\t\t\t\t\tcontrol.setting?.set(customizerValue);\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t);\r\n","import MarginPaddingControl from \"./MarginPaddingControl\";\r\n\r\nif (window.wp.customize) {\r\n\twindow.wp.customize.controlConstructor[\"wpbf-margin-padding\"] =\r\n\t\tMarginPaddingControl(window.wp.customize);\r\n\r\n\twindow.wp.customize.controlConstructor[\"wpbf-responsive-margin-padding\"] =\r\n\t\tMarginPaddingControl(window.wp.customize);\r\n}\r\n","import _ from \"lodash\";\r\nimport i18n from \"@wordpress/i18n/build-types/default-i18n\";\r\nimport { WpbfImageControl } from \"./image-interface\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n\tmedia: any;\r\n\ti18n: typeof i18n;\r\n};\r\n\r\nwp.customize.controlConstructor[\"wpbf-image\"] =\r\n\twp.customize.wpbfDynamicControl.extend({\r\n\t\tinitWpbfControl: function (\r\n\t\t\tthis: WpbfImageControl,\r\n\t\t\tctrl?: WpbfImageControl,\r\n\t\t) {\r\n\t\t\tconst control = ctrl || this;\r\n\t\t\tconst params = control.params;\r\n\r\n\t\t\tconst saveAs = params.saveAs;\r\n\t\t\tconst defaultSrc = params.defaultSrc;\r\n\t\t\tconst valueSrc = params.valueSrc;\r\n\r\n\t\t\tconst box = control.container[0].querySelector(\".attachment-media-view\");\r\n\r\n\t\t\tconst preview: HTMLElement | null =\r\n\t\t\t\tbox?.querySelector(\".thumbnail\") ?? null;\r\n\r\n\t\t\tconst selectButton: HTMLButtonElement | null =\r\n\t\t\t\tbox?.querySelector(\".button-add-media\") ?? null;\r\n\r\n\t\t\tconst changeButton: HTMLButtonElement | null =\r\n\t\t\t\tbox?.querySelector(\".change-button\") ?? null;\r\n\r\n\t\t\tconst removeButton: HTMLButtonElement | null =\r\n\t\t\t\tbox?.querySelector(\".remove-button\") ?? null;\r\n\r\n\t\t\tconst defaultButton: HTMLButtonElement | null =\r\n\t\t\t\tbox?.querySelector(\".default-button\") ?? null;\r\n\r\n\t\t\thandleButtonsDisplay();\r\n\r\n\t\t\tlet previewUrl = valueSrc.url;\r\n\r\n\t\t\tif (preview && previewUrl) {\r\n\t\t\t\tpreview.innerHTML =\r\n\t\t\t\t\t'<img class=\"attachment-thumb\" src=\"' + previewUrl + '\" alt=\"\" />';\r\n\t\t\t}\r\n\r\n\t\t\tselectButton?.addEventListener(\"click\", openMediaLibrary);\r\n\t\t\tchangeButton?.addEventListener(\"click\", openMediaLibrary);\r\n\t\t\tremoveButton?.addEventListener(\"click\", removeImage);\r\n\t\t\tdefaultButton?.addEventListener(\"click\", useDefaultValue);\r\n\r\n\t\t\tfunction openMediaLibrary() {\r\n\t\t\t\tconst selectedImage = wp\r\n\t\t\t\t\t.media({ multiple: false })\r\n\t\t\t\t\t.open()\r\n\t\t\t\t\t.on(\"select\", function () {\r\n\t\t\t\t\t\t// This will return the selected image from the \"Media Uploader\", the result is an object.\r\n\t\t\t\t\t\tconst uploadedImage = selectedImage\r\n\t\t\t\t\t\t\t.state()\r\n\t\t\t\t\t\t\t.get(\"selection\")\r\n\t\t\t\t\t\t\t.first();\r\n\r\n\t\t\t\t\t\tconst jsonImg = uploadedImage.toJSON();\r\n\r\n\t\t\t\t\t\tvalueSrc.id = jsonImg.id;\r\n\t\t\t\t\t\tvalueSrc.url = jsonImg.url;\r\n\t\t\t\t\t\tvalueSrc.width = jsonImg.width;\r\n\t\t\t\t\t\tvalueSrc.height = jsonImg.height;\r\n\r\n\t\t\t\t\t\tpreviewUrl = jsonImg.url;\r\n\r\n\t\t\t\t\t\tif (!_.isUndefined(jsonImg.sizes)) {\r\n\t\t\t\t\t\t\tvalueSrc.url = jsonImg.sizes.full.url;\r\n\t\t\t\t\t\t\tpreviewUrl = jsonImg.sizes.full.url;\r\n\r\n\t\t\t\t\t\t\tif (!_.isUndefined(jsonImg.sizes.medium)) {\r\n\t\t\t\t\t\t\t\tpreviewUrl = jsonImg.sizes.medium.url;\r\n\t\t\t\t\t\t\t} else if (!_.isUndefined(jsonImg.sizes.thumbnail)) {\r\n\t\t\t\t\t\t\t\tpreviewUrl = jsonImg.sizes.thumbnail.url;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (\"array\" === saveAs) {\r\n\t\t\t\t\t\t\tcontrol.setting?.set(valueSrc);\r\n\t\t\t\t\t\t} else if (\"id\" === saveAs) {\r\n\t\t\t\t\t\t\tcontrol.setting?.set(valueSrc.id);\r\n\t\t\t\t\t\t} else if (\"url\" === saveAs) {\r\n\t\t\t\t\t\t\tcontrol.setting?.set(valueSrc.url);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (preview) {\r\n\t\t\t\t\t\t\tpreview.innerHTML =\r\n\t\t\t\t\t\t\t\t'<img class=\"attachment-thumb\" src=\"' +\r\n\t\t\t\t\t\t\t\tpreviewUrl +\r\n\t\t\t\t\t\t\t\t'\" alt=\"\" />';\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\thandleButtonsDisplay();\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction removeImage() {\r\n\t\t\t\temptyValue();\r\n\r\n\t\t\t\tif (\"array\" === saveAs) {\r\n\t\t\t\t\tcontrol.setting?.set(valueSrc);\r\n\t\t\t\t} else if (\"id\" === saveAs) {\r\n\t\t\t\t\tcontrol.setting?.set(0);\r\n\t\t\t\t} else if (\"url\" === saveAs) {\r\n\t\t\t\t\tcontrol.setting?.set(\"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (preview) {\r\n\t\t\t\t\tpreview.innerHTML = wp.i18n.__(\"No image selected\", \"wpbf\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandleButtonsDisplay();\r\n\t\t\t}\r\n\r\n\t\t\tfunction useDefaultValue() {\r\n\t\t\t\tcontrol.setting?.set(defaultSrc);\r\n\r\n\t\t\t\tif (preview) {\r\n\t\t\t\t\tpreview.innerHTML =\r\n\t\t\t\t\t\t'<img class=\"attachment-thumb\" src=\"' +\r\n\t\t\t\t\t\tcontrol.params.default +\r\n\t\t\t\t\t\t'\" alt=\"\" />';\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandleButtonsDisplay();\r\n\t\t\t}\r\n\r\n\t\t\tfunction emptyValue() {\r\n\t\t\t\tvalueSrc.id = 0;\r\n\t\t\t\tvalueSrc.url = \"\";\r\n\t\t\t\tvalueSrc.width = 0;\r\n\t\t\t\tvalueSrc.height = 0;\r\n\t\t\t}\r\n\r\n\t\t\tfunction handleButtonsDisplay() {\r\n\t\t\t\tif (valueSrc.url) {\r\n\t\t\t\t\tif (preview) preview.classList.remove(\"hidden\");\r\n\t\t\t\t\tif (removeButton) removeButton.classList.remove(\"hidden\");\r\n\t\t\t\t\tif (selectButton) selectButton.classList.add(\"hidden\");\r\n\t\t\t\t\tif (changeButton) changeButton.classList.remove(\"hidden\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (preview) preview.classList.add(\"hidden\");\r\n\t\t\t\t\tif (removeButton) removeButton.classList.add(\"hidden\");\r\n\t\t\t\t\tif (selectButton) selectButton.classList.remove(\"hidden\");\r\n\t\t\t\t\tif (changeButton) changeButton.classList.add(\"hidden\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (valueSrc.id === defaultSrc.id) {\r\n\t\t\t\t\tif (defaultButton) defaultButton.classList.add(\"hidden\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (defaultButton) defaultButton.classList.remove(\"hidden\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t});\r\n","declare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n};\r\n\r\nwp.customize.controlConstructor[\"wpbf-radio\"] =\r\n\twp.customize.wpbfDynamicControl.extend({});\r\n\r\nwp.customize.controlConstructor[\"wpbf-radio-buttonset\"] =\r\n\twp.customize.wpbfDynamicControl.extend({});\r\n\r\nwp.customize.controlConstructor[\"wpbf-radio-image\"] =\r\n\twp.customize.wpbfDynamicControl.extend({});\r\n","import _ from \"lodash\";\r\nimport jQuery from \"jquery\";\r\nimport {\r\n\tWpbfRepeaterControl,\r\n\tWpbfRepeaterRow,\r\n} from \"./repeater-interface\";\r\n\r\ndeclare var wp: {\r\n\tcustomize: WpbfCustomize;\r\n};\r\n\r\nexport default class RepeaterRow implements WpbfRepeaterRow {\r\n\trowIndex: number;\r\n\tcontainer: JQuery<HTMLElement>;\r\n\tlabel: Record<string, string>;\r\n\theader: JQuery<HTMLElement>;\r\n\tcontrol: WpbfRepeaterControl;\r\n\r\n\tconstructor(\r\n\t\trowIndex: number,\r\n\t\tcontainer: JQuery<HTMLElement>,\r\n\t\tlabel: Record<string, string>,\r\n\t\tcontrol: WpbfRepeaterControl,\r\n\t) {\r\n\t\tthis.rowIndex = rowIndex;\r\n\t\tthis.container = container;\r\n\t\tthis.label = label;\r\n\t\tthis.header = this.container.find(\".repeater-row-header\");\r\n\t\tthis.control = control;\r\n\r\n\t\tthis.header.on(\"click\", () => this.toggleMinimize());\r\n\r\n\t\tthis.container.on(\"click\", \".repeater-row-remove\", () => this.remove());\r\n\r\n\t\tthis.header.on(\"mousedown\", () =>\r\n\t\t\tthis.container.trigger(\"row:start-dragging\"),\r\n\t\t);\r\n\r\n\t\tthis.container.on(\r\n\t\t\t\"keyup change\",\r\n\t\t\t\"input, select, textarea\",\r\n\t\t\t(e: JQuery.TriggeredEvent) =>\r\n\t\t\t\tthis.container.trigger(\"row:update\", [\r\n\t\t\t\t\tthis.rowIndex,\r\n\t\t\t\t\tjQuery(e.target).data(\"field\"),\r\n\t\t\t\t\te.target,\r\n\t\t\t\t]),\r\n\t\t);\r\n\r\n\t\tthis.setRowIndex(this.rowIndex);\r\n\t}\r\n\r\n\tsetRowIndex = (rowNum: number): void => {\r\n\t\tthis.rowIndex = rowNum;\r\n\t\tthis.container.attr(\"data-row\", rowNum);\r\n\t\tthis.container.data(\"row\", rowNum);\r\n\t\tthis.updateLabel();\r\n\t};\r\n\r\n\ttoggleMinimize = (): void => {\r\n\t\tthis.container.toggleClass(\"minimized\");\r\n\t\tthis.header\r\n\t\t\t.find(\".dashicons\")\r\n\t\t\t.toggleClass(\"dashicons-arrow-up dashicons-arrow-down\");\r\n\t};\r\n\r\n\tremove = (): void => {\r\n\t\tthis.container.slideUp(300, () => {\r\n\t\t\tthis.container.detach();\r\n\t\t});\r\n\t\tthis.container.trigger(\"row:remove\", [this.rowIndex]);\r\n\t};\r\n\r\n\tupdateLabel = (): void => {\r\n\t\tif (\"field\" === this.label.type) {\r\n\t\t\tconst rowLabelField = this.container[0].querySelector(\r\n\t\t\t\t`.repeater-field [data-field=\"${this.label.field}\"]`,\r\n\t\t\t);\r\n\r\n\t\t\tif (\r\n\t\t\t\trowLabelField &&\r\n\t\t\t\trowLabelField instanceof HTMLInputElement &&\r\n\t\t\t\ttypeof rowLabelField.value === \"string\"\r\n\t\t\t) {\r\n\t\t\t\tlet rowLabel: string = rowLabelField.value;\r\n\r\n\t\t\t\tif (rowLabel !== \"\") {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tthis.control.params.fields[this.label.field] &&\r\n\t\t\t\t\t\tthis.control.params.fields[this.label.field].type\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tthis.control.params.fields[this.label.field].type === \"select\" &&\r\n\t\t\t\t\t\t\tthis.control.params.fields[this.label.field].choices &&\r\n\t\t\t\t\t\t\tthis.control.params.fields[this.label.field].choices[rowLabel]\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\trowLabel =\r\n\t\t\t\t\t\t\t\tthis.control.params.fields[this.label.field].choices[rowLabel];\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t(this.control.params.fields[this.label.field].type === \"radio\" ||\r\n\t\t\t\t\t\t\t\tthis.control.params.fields[this.label.field].type ===\r\n\t\t\t\t\t\t\t\t\t\"radio-image\") &&\r\n\t\t\t\t\t\t\tthis.rowIndex >= 0\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tconst rowLabelRadioField = this.container.find(\r\n\t\t\t\t\t\t\t\t`${this.control.selector} [data-row=\"${this.rowIndex}\"] .repeater-field [data-field=\"${this.label.field}\"]:checked`,\r\n\t\t\t\t\t\t\t)[0] as HTMLInputElement;\r\n\r\n\t\t\t\t\t\t\tif (rowLabelRadioField) {\r\n\t\t\t\t\t\t\t\trowLabel = rowLabelRadioField.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.header.find(\".repeater-row-label\").text(rowLabel);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.header\r\n\t\t\t.find(\".repeater-row-label\")\r\n\t\t\t.text(`${this.label.value} ${this.rowIndex + 1}`);\r\n\t};\r\n}\r\n","import { ChangeEvent, MouseEvent, useRef } from \"react\";\r\n\r\nexport default function SliderForm(props: {\r\n\tid: string;\r\n\tmin: number;\r\n\tmax: number;\r\n\tstep: number;\r\n\tlabel?: string;\r\n\tdescription?: string;\r\n\tdefault?: string | number;\r\n\tvalue?: string | number;\r\n\tupdateCustomizerSetting?: (val: string | number) => void;\r\n\toverrideUpdateComponentStateFn?: (fn: (val: string | number) => void) => void;\r\n\tsetNotificationContainer?: any;\r\n}) {\r\n\tlet trigger = \"\";\r\n\r\n\tconst sliderRef: React.MutableRefObject<HTMLInputElement | null> =\r\n\t\tuseRef(null);\r\n\tconst valueRef: React.MutableRefObject<HTMLDivElement | null> = useRef(null);\r\n\r\n\tfunction updateComponentState(value: string | number) {\r\n\t\tconst val = String(value);\r\n\r\n\t\tif (\"slider\" === trigger) {\r\n\t\t\tif (valueRef && valueRef.current) {\r\n\t\t\t\tvalueRef.current.textContent = val;\r\n\t\t\t}\r\n\t\t} else if (\"input\" === trigger) {\r\n\t\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\t\tsliderRef.current.value = val;\r\n\t\t\t}\r\n\t\t} else if (\"reset\" === trigger) {\r\n\t\t\tif (valueRef && valueRef.current) {\r\n\t\t\t\tvalueRef.current.textContent = val;\r\n\t\t\t}\r\n\r\n\t\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\t\tsliderRef.current.value = val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tfunction parseValue(value: string | number | undefined) {\r\n\t\tconst safeValue = \"undefined\" === typeof value ? 0 : value;\r\n\t\tconst numericValue =\r\n\t\t\ttypeof safeValue === \"string\" ? parseFloat(safeValue) : safeValue;\r\n\r\n\t\tif (isNaN(numericValue)) {\r\n\t\t\treturn props.min;\r\n\t\t}\r\n\r\n\t\tconst parsedValue = numericValue < props.min ? props.min : numericValue;\r\n\r\n\t\treturn parsedValue > props.max ? props.max : parsedValue;\r\n\t}\r\n\r\n\tfunction handleInputChange(e: ChangeEvent<HTMLInputElement>) {\r\n\t\tconst target = e.target;\r\n\t\ttrigger = \"range\" === target.type ? \"slider\" : \"input\";\r\n\r\n\t\tconst value = parseValue(target.value);\r\n\r\n\t\tif (\"input\" === trigger) target.value = value.toString();\r\n\t\tprops.updateCustomizerSetting?.(value);\r\n\t}\r\n\r\n\tfunction handleResetButtonClick(_e: MouseEvent) {\r\n\t\tconst defaultExists =\r\n\t\t\t\"undefined\" !== typeof props.default && \"\" !== props.default;\r\n\r\n\t\tif (defaultExists) {\r\n\t\t\tconst defaultValue = parseValue(props.default);\r\n\r\n\t\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\t\tsliderRef.current.value = defaultValue.toString();\r\n\t\t\t}\r\n\r\n\t\t\tif (valueRef && valueRef.current) {\r\n\t\t\t\tvalueRef.current.textContent = defaultValue.toString();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst valueExists =\r\n\t\t\t\t\"undefined\" !== typeof props.value && \"\" !== props.value;\r\n\r\n\t\t\tif (valueExists) {\r\n\t\t\t\tconst value = parseValue(props.value);\r\n\r\n\t\t\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\t\t\tsliderRef.current.value = value.toString();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (valueRef && valueRef.current) {\r\n\t\t\t\t\tvalueRef.current.textContent = value.toString();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\t\t\tsliderRef.current.value = props.min.toString();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (valueRef && valueRef.current) {\r\n\t\t\t\t\tvalueRef.current.textContent = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttrigger = \"reset\";\r\n\t\tconst renderedValue = parseValue(sliderRef.current?.value);\r\n\r\n\t\tif (sliderRef && sliderRef.current) {\r\n\t\t\tprops.updateCustomizerSetting?.(renderedValue);\r\n\t\t}\r\n\t}\r\n\r\n\t// Preparing for the template.\r\n\tconst fieldId = `wpbf-control-input-${props.id}`;\r\n\tconst value = parseValue(props.value);\r\n\r\n\treturn (\r\n\t\t<div className=\"wpbf-control-form\" tabIndex={1}>\r\n\t\t\t<label className=\"wpbf-control-label\" htmlFor={fieldId}>\r\n\t\t\t\t<span className=\"customize-control-title\">{props.label}</span>\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName=\"customize-control-description description\"\r\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: props.description ?? \"\" }}\r\n\t\t\t\t/>\r\n\t\t\t</label>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"customize-control-notifications-container\"\r\n\t\t\t\tref={props.setNotificationContainer}\r\n\t\t\t></div>\r\n\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tclassName=\"wpbf-control-reset\"\r\n\t\t\t\tonClick={handleResetButtonClick}\r\n\t\t\t>\r\n\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t</button>\r\n\r\n\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t<div className=\"wpbf-control-left-col\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tref={sliderRef}\r\n\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\tid={fieldId}\r\n\t\t\t\t\t\tdefaultValue={value}\r\n\t\t\t\t\t\tmin={props.min}\r\n\t\t\t\t\t\tmax={props.max}\r\n\t\t\t\t\t\tstep={props.step}\r\n\t\t\t\t\t\tclassName=\"wpbf-control-slider\"\r\n\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"wpbf-control-right-col\">\r\n\t\t\t\t\t<div className=\"wpbf-control-value\" ref={valueRef}>\r\n\t\t\t\t\t\t{value}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { DevicesValue } from \"../../Responsive/src/responsive-interface\";\r\nimport { parseJsonOrUndefined } from \"../../Generic/src/string-util\";\r\nimport { makeLimitedNumberUnitPair } from \"../../Generic/src/number-util\";\r\n\r\n/**\r\n * Make a value for an input field.\r\n *\r\n * @export\r\n *\r\n * @param {(string | number)} value - The value to convert.\r\n * @param {number} min - The minimum value.\r\n * @param {number} max - The maximum value.\r\n *\r\n * @return {string|number} The value for the input field.\r\n */\r\nexport function makeValueForInput(\r\n\tvalue: string | number,\r\n\tmin: number,\r\n\tmax: number,\r\n): string | number {\r\n\tlet strValue = String(value).trim();\r\n\r\n\tconst isTypingNegative = strValue === \"-\";\r\n\tif (isTypingNegative) return \"-\";\r\n\r\n\tconst isTypingDecimal = strValue.endsWith(\".\");\r\n\tstrValue = isTypingDecimal ? strValue.replace(\".\", \"\") : strValue;\r\n\r\n\tconst valueObject = makeLimitedNumberUnitPair(value, min, max);\r\n\r\n\tif (\"\" === valueObject.number) {\r\n\t\treturn isTypingDecimal ? \"0.\" : \"\";\r\n\t}\r\n\r\n\tlet numeric = String(valueObject.number);\r\n\r\n\t/**\r\n\t * Having `isTypingDecimal` means, the latest char is a decimal point.\r\n\t * No unit is allowed before the decimal point.\r\n\t */\r\n\tif (isTypingDecimal) return numeric + \".\";\r\n\r\n\treturn valueObject.unit\r\n\t\t? numeric +\r\n\t\t\t\t(valueObject.hasTrailingDotBeforeUnit ? \".\" : \"\") +\r\n\t\t\t\tvalueObject.unit\r\n\t\t: numeric;\r\n}\r\n\r\n/**\r\n * Make a value for a range-slider field.\r\n *\r\n * @export\r\n *\r\n * @param {(string | number)} value - The value to convert.\r\n * @param {number} min - The minimum value.\r\n * @param {number} max - The maximum value.\r\n *\r\n * @return {number} The value for the slider.\r\n */\r\nexport function makeValueForSlider(\r\n\tvalue: string | number,\r\n\tmin: number,\r\n\tmax: number,\r\n): number {\r\n\tconst valueObject = makeLimitedNumberUnitPair(value, min, max);\r\n\r\n\treturn \"\" === valueObject.number ? min : valueObject.number;\r\n}\r\n\r\n/**\r\n * Make an empty `DevicesValue` object.\r\n *\r\n * @param {string[]} devices - The allowed devices.\r\n *\r\n * @return {DevicesValue} Empty `DevicesValue` object.\r\n */\r\nfunction makeEmptyDevicesValue(devices: string[]): DevicesValue {\r\n\tconst value: DevicesValue = {};\r\n\r\n\tdevices.forEach((device) => {\r\n\t\tvalue[device] = \"\";\r\n\t});\r\n\r\n\treturn value;\r\n}\r\n\r\n/**\r\n * Make a `DevicesValue` object from a JSON encoded string or `DevicesValue` object.\r\n *\r\n * @export\r\n *\r\n * @param {string[]} devices - The allowed devices.\r\n * @param {(string | DevicesValue)} value - The value to convert.\r\n * @param {number} min - The minimum value.\r\n * @param {number} max - The maximum value.\r\n *\r\n * @return {DevicesValue}\r\n */\r\nexport function makeDevicesValue(\r\n\tdevices: string[],\r\n\tvalue: string | DevicesValue,\r\n\tmin: number,\r\n\tmax: number,\r\n): DevicesValue {\r\n\tconst valueObject =\r\n\t\t\"string\" === typeof value\r\n\t\t\t? parseJsonOrUndefined<DevicesValue>(value)\r\n\t\t\t: value;\r\n\r\n\tif (!valueObject) {\r\n\t\treturn makeEmptyDevicesValue(devices);\r\n\t}\r\n\r\n\tconst devicesValue: DevicesValue = {};\r\n\r\n\tdevices.forEach((device) => {\r\n\t\tif (!valueObject.hasOwnProperty(device)) {\r\n\t\t\tdevicesValue[device] = \"\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst val = makeValueForInput(valueObject[device], min, max);\r\n\r\n\t\tdevicesValue[device] =\r\n\t\t\t\"string\" !== typeof val && \"number\" !== typeof val ? \"\" : val;\r\n\t});\r\n\r\n\treturn devicesValue;\r\n}\r\n","import { ChangeEvent, MouseEvent, useRef } from \"react\";\r\nimport { makeValueForInput, makeValueForSlider } from \"./slider-util\";\r\nimport {\r\n\tlimitNumber,\r\n\tmakeLimitedNumberUnitPair,\r\n} from \"../../Generic/src/number-util\";\r\n\r\nexport default function InputSliderForm(props: {\r\n\tid: string;\r\n\tmin: number;\r\n\tmax: number;\r\n\tstep: number;\r\n\tlabel: string | undefined;\r\n\tdescription: string | undefined;\r\n\tdefault: string | number;\r\n\tvalue: string | number;\r\n\tsetNotificationContainer: any;\r\n\toverrideUpdateComponentStateFn?: (fn: (val: string | number) => void) => void;\r\n\tupdateCustomizerSetting?: (val: string | number) => void;\r\n}) {\r\n\tlet trigger = \"\";\r\n\r\n\tfunction updateComponentState(val: string | number) {\r\n\t\tif (\"slider\" === trigger) {\r\n\t\t\tsetInputRefValue(makeValueForInput(val, props.min, props.max));\r\n\t\t} else if (\"input\" === trigger) {\r\n\t\t\tsetSliderRefValue(makeValueForSlider(val, props.min, props.max));\r\n\t\t} else if (\"reset\" === trigger) {\r\n\t\t\tsetSliderRefValue(val === \"\" ? props.min : val);\r\n\t\t\tsetInputRefValue(val);\r\n\t\t}\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tfunction handleInputChange(e: ChangeEvent<HTMLInputElement>) {\r\n\t\ttrigger = \"input\";\r\n\r\n\t\tprops.updateCustomizerSetting?.(\r\n\t\t\tmakeValueForInput(e.target.value, props.min, props.max),\r\n\t\t);\r\n\t}\r\n\r\n\tconst sliderRef = useRef<HTMLInputElement | null>(null);\r\n\tconst inputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n\tfunction handleSliderChange(e: ChangeEvent<HTMLInputElement>) {\r\n\t\ttrigger = \"slider\";\r\n\r\n\t\tconst value = parseFloat(e.target.value);\r\n\t\tconst limitedValue = limitNumber(value, props.min, props.max);\r\n\r\n\t\tif (!inputRef || !inputRef.current) return;\r\n\r\n\t\t// Since range field doesn't have unit, we're going to get the unit from the input field.\r\n\t\tconst numberValuePair = makeLimitedNumberUnitPair(\r\n\t\t\tinputRef.current.value,\r\n\t\t\tprops.min,\r\n\t\t\tprops.max,\r\n\t\t);\r\n\r\n\t\tconst valueForInput = String(limitedValue) + numberValuePair.unit;\r\n\t\tprops.updateCustomizerSetting?.(valueForInput);\r\n\t}\r\n\r\n\tfunction setInputRefValue(value: string | number) {\r\n\t\tif (!inputRef || !inputRef.current) return;\r\n\t\tinputRef.current.value = String(value);\r\n\t}\r\n\r\n\tfunction setSliderRefValue(value: string | number) {\r\n\t\tif (!sliderRef || !sliderRef.current) return;\r\n\t\tsliderRef.current.value = String(value);\r\n\t}\r\n\r\n\tfunction handleResetButtonClick(e: MouseEvent) {\r\n\t\tlet valueToSave: string | number = \"\";\r\n\r\n\t\tif (\"\" !== props.default && \"undefined\" !== typeof props.default) {\r\n\t\t\tvalueToSave = props.default;\r\n\t\t} else {\r\n\t\t\tif (\"\" !== props.value) {\r\n\t\t\t\tvalueToSave = props.value;\r\n\t\t\t} else {\r\n\t\t\t\tvalueToSave = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttrigger = \"reset\";\r\n\r\n\t\tprops.updateCustomizerSetting?.(valueToSave);\r\n\t}\r\n\r\n\t// Preparing for the template.\r\n\tconst fieldId = `wpbf-control-input-${props.id}`;\r\n\tconst sliderValue = makeValueForSlider(props.value, props.min, props.max);\r\n\tconst inputValue = makeValueForInput(props.value, props.min, props.max);\r\n\r\n\treturn (\r\n\t\t<div className=\"wpbf-control-form\" tabIndex={1}>\r\n\t\t\t{props.label || props.description ? (\r\n\t\t\t\t<label className=\"wpbf-control-label\" htmlFor={fieldId}>\r\n\t\t\t\t\t{props.label && (\r\n\t\t\t\t\t\t<span className=\"customize-control-title\">{props.label}</span>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{props.description && (\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName=\"customize-control-description description\"\r\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: props.description }}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</label>\r\n\t\t\t) : null}\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"customize-control-notifications-container\"\r\n\t\t\t\tref={props.setNotificationContainer}\r\n\t\t\t></div>\r\n\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tclassName=\"wpbf-control-reset\"\r\n\t\t\t\tonClick={handleResetButtonClick}\r\n\t\t\t>\r\n\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t</button>\r\n\r\n\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t<div className=\"wpbf-control-left-col\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tref={sliderRef}\r\n\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\tid={fieldId}\r\n\t\t\t\t\t\tdefaultValue={sliderValue}\r\n\t\t\t\t\t\tmin={props.min}\r\n\t\t\t\t\t\tmax={props.max}\r\n\t\t\t\t\t\tstep={props.step}\r\n\t\t\t\t\t\tclassName=\"wpbf-control-input-slider wpbf-pro-control-input-slider\"\r\n\t\t\t\t\t\tonChange={handleSliderChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"wpbf-control-right-col\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdefaultValue={inputValue}\r\n\t\t\t\t\t\tclassName=\"wpbf-control-input\"\r\n\t\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n","import { ChangeEvent, MouseEvent, useState, useEffect } from \"react\";\r\nimport DeviceButtons from \"../../Responsive/src/DeviceButtons\";\r\nimport {\r\n\tmakeDevicesValue,\r\n\tmakeValueForInput,\r\n\tmakeValueForSlider,\r\n} from \"./slider-util\";\r\nimport { DevicesValue } from \"../../Responsive/src/responsive-interface\";\r\nimport { encodeJsonOrDefault } from \"../../Generic/src/string-util\";\r\nimport { makeLimitedNumberUnitPair } from \"../../Generic/src/number-util\";\r\n\r\ndeclare var wp: { customize: WpbfCustomize };\r\n\r\nexport default function ResponsiveInputSliderForm(props: {\r\n\tid: string;\r\n\toverrideUpdateComponentStateFn?: (\r\n\t\tfn: (val: string | DevicesValue) => void,\r\n\t) => void;\r\n\tupdateCustomizerSetting?: (val: string | DevicesValue) => void;\r\n\tsetNotificationContainer: any;\r\n\tsaveAsJson: boolean;\r\n\tdevices: string[];\r\n\tlabel: string | undefined;\r\n\tdescription: string | undefined;\r\n\tmin: number;\r\n\tmax: number;\r\n\tstep: number;\r\n\tdefault: string | DevicesValue;\r\n\tvalue: string | DevicesValue;\r\n}) {\r\n\tconst defaultValue = makeDevicesValue(\r\n\t\tprops.devices,\r\n\t\tprops.default,\r\n\t\tprops.min,\r\n\t\tprops.max,\r\n\t);\r\n\r\n\tconst [actualValue, setActualValue] = useState(\r\n\t\tmakeDevicesValue(props.devices, props.value, props.min, props.max),\r\n\t);\r\n\r\n\t// Track the active device based on wp.customize.previewedDevice\r\n\tconst [activeDevice, setActiveDevice] = useState(\r\n\t\ttypeof wp !== \"undefined\" && wp.customize?.previewedDevice?.get()\r\n\t\t\t? wp.customize.previewedDevice.get()\r\n\t\t\t: props.devices[0],\r\n\t);\r\n\r\n\t// Listen to preview device changes\r\n\tuseEffect(() => {\r\n\t\tif (typeof wp === \"undefined\" || !wp.customize?.previewedDevice) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst callback = (device: string) => {\r\n\t\t\tif (props.devices.includes(device)) {\r\n\t\t\t\tsetActiveDevice(device);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twp.customize.previewedDevice.bind(callback);\r\n\r\n\t\treturn () => {\r\n\t\t\twp.customize.previewedDevice.unbind(callback);\r\n\t\t};\r\n\t}, [props.devices]);\r\n\r\n\t/**\r\n\t * This function will be called when the value from the customizer setting changes.\r\n\t * This can be from either it's own control or from another control that is linked to it.\r\n\t *\r\n\t * @param {string|DevicesValue} val - The value from customizer setting.\r\n\t */\r\n\tfunction updateComponentState(val: string | DevicesValue) {\r\n\t\tconst devicesValue = makeDevicesValue(\r\n\t\t\tprops.devices,\r\n\t\t\tval,\r\n\t\t\tprops.min,\r\n\t\t\tprops.max,\r\n\t\t);\r\n\r\n\t\tsetActualValue(devicesValue);\r\n\t}\r\n\r\n\tprops.overrideUpdateComponentStateFn?.(updateComponentState);\r\n\r\n\tfunction updateCustomizerSetting(val: DevicesValue) {\r\n\t\tconst valueToSave = props.saveAsJson\r\n\t\t\t? encodeJsonOrDefault<DevicesValue>(val)\r\n\t\t\t: val;\r\n\r\n\t\tprops.updateCustomizerSetting?.(valueToSave);\r\n\t}\r\n\r\n\tfunction handleInputChange(e: ChangeEvent<HTMLInputElement>, device: string) {\r\n\t\tconst devicesValue = actualValue;\r\n\r\n\t\tif (!devicesValue.hasOwnProperty(device)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fieldValue = makeValueForInput(e.target.value, props.min, props.max);\r\n\t\tdevicesValue[device] = fieldValue;\r\n\r\n\t\tupdateCustomizerSetting(devicesValue);\r\n\t}\r\n\r\n\tfunction handleSliderChange(\r\n\t\te: ChangeEvent<HTMLInputElement>,\r\n\t\tdevice: string,\r\n\t) {\r\n\t\tconst devicesValue = actualValue;\r\n\r\n\t\tif (!devicesValue.hasOwnProperty(device)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fieldValue = makeValueForSlider(e.target.value, props.min, props.max);\r\n\t\tconst existingValue = devicesValue[device];\r\n\r\n\t\tif (existingValue === fieldValue) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Since range field doesn't have unit, we're going to get the unit from the input field.\r\n\t\tconst numberUnitPair = makeLimitedNumberUnitPair(\r\n\t\t\texistingValue,\r\n\t\t\tprops.min,\r\n\t\t\tprops.max,\r\n\t\t);\r\n\r\n\t\tif (numberUnitPair.number === fieldValue) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdevicesValue[device] = numberUnitPair.unit\r\n\t\t\t? fieldValue + numberUnitPair.unit\r\n\t\t\t: fieldValue;\r\n\r\n\t\tupdateCustomizerSetting(devicesValue);\r\n\t}\r\n\r\n\tfunction handleResetButtonClick(\r\n\t\te: MouseEvent<HTMLButtonElement>,\r\n\t\tdevice: string,\r\n\t) {\r\n\t\tconst devicesValue = actualValue;\r\n\r\n\t\tif (\r\n\t\t\t!devicesValue.hasOwnProperty(device) ||\r\n\t\t\t!defaultValue.hasOwnProperty(device)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tdevicesValue[device] = defaultValue[device];\r\n\r\n\t\tupdateCustomizerSetting(devicesValue);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<header className=\"wpbf-control-header\">\r\n\t\t\t\t{props.label && (\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\tclassName=\"customize-control-title\"\r\n\t\t\t\t\t\thtmlFor={`wpbf-control-input-${props.id}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"customize-control-title\">{props.label}</span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<DeviceButtons devices={props.devices} />\r\n\t\t\t</header>\r\n\r\n\t\t\t{props.description && (\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName=\"customize-control-description description\"\r\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: props.description }}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"customize-control-notifications-container\"\r\n\t\t\t\tref={props.setNotificationContainer}\r\n\t\t\t></div>\r\n\r\n\t\t\t<div className=\"wpbf-control-form\">\r\n\t\t\t\t{props.devices.map((device, deviceIndex) => {\r\n\t\t\t\t\tconst isActive = device === activeDevice;\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={`wpbf-control-device wpbf-control-${device} ${isActive ? \"is-active\" : \"\"}`}\r\n\t\t\t\t\t\t\tdata-wpbf-device={device}\r\n\t\t\t\t\t\t\tkey={deviceIndex}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{actualValue.hasOwnProperty(device) && (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"wpbf-control-reset\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => handleResetButtonClick(e, device)}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<i className=\"dashicons dashicons-image-rotate\"></i>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className=\"wpbf-control-cols\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"wpbf-control-left-col\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid={`wpbf-control-input-${props.id}-${device}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={makeValueForSlider(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactualValue[device],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops.min,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops.max,\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmin={props.min}\r\n\t\t\t\t\t\t\t\t\t\t\t\tmax={props.max}\r\n\t\t\t\t\t\t\t\t\t\t\t\tstep={props.step}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"wpbf-control-input-slider wpbf-pro-control-input-slider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleSliderChange(e, device)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"wpbf-control-right-col\">\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={makeValueForInput(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tactualValue[device],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops.min,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops.max,\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"wpbf-control-input\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleInputChange(e, device)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\nimport {\n\tFontProperties,\n\tFontProperty,\n\tFontVariantsCollection,\n\tGoogleFontEntity,\n\tGoogleFontsCollection,\n\tLabelValuePair,\n\tWpbfCustomizeTypographyControlValue,\n} from \"./typography-interface\";\nimport {\n\tSelectControlChoice,\n\tWpbfSelectControl,\n} from \"../../Select/src/select-interface\";\nimport { WpbfAssocArrayControl } from \"../../Generic/src/generic-interface\";\nimport { isNumeric } from \"../../Generic/src/number-util\";\n\n/**\n * These var declarations are for the global variables that are set in the PHP file.\n * That means, the `undefined` union has to be added to the declaration to be safer.\n */\ndeclare var wpbfFontProperties: FontProperties | undefined;\ndeclare var wpbfTypographyControlIds: string[] | undefined;\ndeclare var wpbfGoogleFonts: GoogleFontsCollection | undefined;\ndeclare var wpbfFontVariantOptions: FontVariantsCollection | undefined;\ndeclare var wpbfFieldsFontVariants:\n\t| Record<string, Record<string, LabelValuePair[]>>\n\t| undefined;\n\nwindow.wp.customize?.bind(\"ready\", function () {\n\tif (!window.wp.customize) return;\n\tsetupTypographyFields(window.wp.customize);\n});\n\nfunction setupTypographyFields(customizer: WpbfCustomize) {\n\tif (!Array.isArray(wpbfTypographyControlIds)) return;\n\n\twpbfTypographyControlIds.forEach((id) => {\n\t\tif (!customizer.control(id)) return;\n\n\t\t// Register hook once per typography control (not on every font change).\n\t\twindow.wp.hooks.addAction(\n\t\t\t\"wpbf.dynamicControl.initWpbfControl\",\n\t\t\t\"wpbf/typography/\" + id,\n\t\t\tfunction (controlInit: AnyWpbfCustomizeControl) {\n\t\t\t\tconst variantControlId = id + \"[variant]\";\n\t\t\t\tif (variantControlId === controlInit.id) {\n\t\t\t\t\t// Variant control initialized.\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\tcustomizer(id, function (setting) {\n\t\t\tcomposeFontProperties(id, undefined, undefined, undefined);\n\n\t\t\tsetting.bind(function (value) {\n\t\t\t\tcomposeFontProperties(id, value, undefined, undefined);\n\t\t\t});\n\n\t\t\tlistenFontPropertyFieldsChange(id);\n\t\t});\n\t});\n}\n\nfunction listenFontPropertyFieldsChange(typographyControlId: string) {\n\tif (!Array.isArray(wpbfFontProperties)) return;\n\n\twpbfFontProperties.forEach((property) => {\n\t\tconst propertyControlId = `${typographyControlId}[${property}]`;\n\t\tif (!window.wp.customize?.control(propertyControlId)) return;\n\n\t\twindow.wp.customize?.(propertyControlId, function (setting) {\n\t\t\tsetting.bind(function (value) {\n\t\t\t\tcomposeFontProperties(\n\t\t\t\t\ttypographyControlId,\n\t\t\t\t\tundefined,\n\t\t\t\t\tproperty,\n\t\t\t\t\tvalue,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t});\n}\n\nfunction findGoogleFont(fontFamily: string): GoogleFontEntity | undefined {\n\tif (!wpbfGoogleFonts) return undefined;\n\tif (wpbfGoogleFonts.items[fontFamily]) {\n\t\treturn wpbfGoogleFonts.items[fontFamily];\n\t}\n\n\treturn undefined;\n}\n\nfunction variantFoundInChoices(\n\tvariantValue: string,\n\tvariants: SelectControlChoice[],\n) {\n\treturn variants.some((variant) => variant.id == variantValue);\n}\n\nfunction composeFontProperties(\n\tid: string,\n\tval?: WpbfCustomizeTypographyControlValue,\n\ttriggerPropertyName?: FontProperty,\n\ttriggerPropertyValue?: string,\n\ttriggerChange?: boolean,\n) {\n\tconst control: WpbfAssocArrayControl | undefined =\n\t\twindow.wp.customize?.control(id);\n\tif (!control || !control.setting) return;\n\n\tval = val || control.setting.get();\n\n\tconst value = { ...val };\n\n\tif (\"font-backup\" in value) delete value[\"font-backup\"];\n\n\tif (\"undefined\" === typeof value) return;\n\tif (\"string\" !== typeof value[\"font-family\"]) return;\n\n\tif (\n\t\ttriggerPropertyName === \"font-family\" ||\n\t\ttriggerPropertyName === \"variant\"\n\t) {\n\t\tvalue[triggerPropertyName] = triggerPropertyValue;\n\t}\n\n\tlet variantValue = !value.variant ? \"regular\" : value.variant;\n\tvalue.variant = variantValue;\n\n\tconst maybeVariantControl = window.wp.customize?.control(id + \"[variant]\");\n\n\tconst variantControl =\n\t\tmaybeVariantControl &&\n\t\t\"wpbf-enhanced-select\" === maybeVariantControl.params.type\n\t\t\t? (maybeVariantControl as WpbfSelectControl)\n\t\t\t: undefined;\n\n\tif (\n\t\tvariantControl &&\n\t\t(triggerPropertyName === undefined || triggerPropertyName === \"font-family\")\n\t) {\n\t\tconst variantChoices = collectVariantChoices(id, value);\n\n\t\t// Hide/show variant options depending on which are available for this font-family.\n\t\tif (variantChoices.length > 1 && control.active()) {\n\t\t\tvariantControl.activate();\n\t\t} else {\n\t\t\t// If there's only 1 variant to choose from, we can hide the control.\n\t\t\tvariantControl.deactivate();\n\t\t}\n\n\t\tconst updatedOptionValue = variantFoundInChoices(\n\t\t\tvariantValue,\n\t\t\tvariantChoices,\n\t\t)\n\t\t\t? variantValue\n\t\t\t: \"regular\";\n\n\t\t// Update the `variantValue` with the updated option value.\n\t\tvariantValue = updatedOptionValue;\n\n\t\tconst $variantSelectbox = variantControl.container?.find(\".wpbf-select2\");\n\n\t\t$variantSelectbox?.empty();\n\t\t$variantSelectbox?.append(\n\t\t\tvariantChoices.map((choice) => {\n\t\t\t\treturn new Option(choice.text, choice.id, false, false);\n\t\t\t}),\n\t\t);\n\t\t$variantSelectbox?.val(variantValue);\n\t\tvalue[\"variant\"] = variantValue;\n\t}\n\n\t// Set the font-style value.\n\tif (-1 !== variantValue.indexOf(\"i\")) {\n\t\tvalue[\"font-style\"] = \"italic\";\n\t} else {\n\t\tvalue[\"font-style\"] = \"normal\";\n\t}\n\n\t// Set the font-weight value.\n\tvalue[\"font-weight\"] =\n\t\t\"regular\" === variantValue || \"italic\" === variantValue\n\t\t\t? 400\n\t\t\t: isNumeric(variantValue)\n\t\t\t\t? parseInt(variantValue, 10)\n\t\t\t\t: 400;\n\n\tif (triggerChange) {\n\t\t// value[\"random\"] = Date.now();\n\t}\n\n\tcontrol.setting.set(value);\n}\n\nfunction collectVariantChoices(\n\tid: string,\n\tvalue: WpbfCustomizeTypographyControlValue,\n) {\n\tconst fontFamily = value[\"font-family\"];\n\tif (!fontFamily) return [];\n\n\tconst googleFont = findGoogleFont(fontFamily);\n\n\tconst variantChoices: SelectControlChoice[] = [];\n\n\tif (googleFont) {\n\t\tif (!wpbfFontVariantOptions) return variantChoices;\n\t\tlet googleFontVariants = googleFont.variants;\n\n\t\tlet i = 0;\n\n\t\tfor (; i < wpbfFontVariantOptions.complete.length; ++i) {\n\t\t\tif (\n\t\t\t\t!googleFontVariants.includes(wpbfFontVariantOptions.complete[i].value)\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvariantChoices.push({\n\t\t\t\ttext: wpbfFontVariantOptions.complete[i].label,\n\t\t\t\tid: wpbfFontVariantOptions.complete[i].value,\n\t\t\t});\n\t\t}\n\t} else {\n\t\tlet fieldVariantKey = id.replace(/]/g, \"\");\n\t\tfieldVariantKey = fieldVariantKey.replace(/\\[/g, \"_\");\n\n\t\tconst customVariantsGroup =\n\t\t\twpbfFieldsFontVariants && wpbfFieldsFontVariants[fieldVariantKey]\n\t\t\t\t? wpbfFieldsFontVariants[fieldVariantKey]\n\t\t\t\t: undefined;\n\n\t\tif (customVariantsGroup && \"object\" === typeof customVariantsGroup) {\n\t\t\tfor (const variantFamily in customVariantsGroup) {\n\t\t\t\tif (!customVariantsGroup.hasOwnProperty(variantFamily)) continue;\n\t\t\t\tif (value[\"font-family\"] !== variantFamily) continue;\n\n\t\t\t\tconst variants = customVariantsGroup[variantFamily];\n\t\t\t\tif (!variants.length) continue;\n\n\t\t\t\tlet i = 0;\n\n\t\t\t\tfor (; i < variants.length; ++i) {\n\t\t\t\t\tvariantChoices.push({\n\t\t\t\t\t\ttext: variants[i].label,\n\t\t\t\t\t\tid: variants[i].value,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tvariantChoices.length = 0;\n\t\t\tif (!wpbfFontVariantOptions) return variantChoices;\n\n\t\t\tlet i = 0;\n\n\t\t\tfor (; i < wpbfFontVariantOptions.standard.length; ++i) {\n\t\t\t\tvariantChoices.push({\n\t\t\t\t\ttext: wpbfFontVariantOptions.standard[i].label,\n\t\t\t\t\tid: wpbfFontVariantOptions.standard[i].value,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn variantChoices;\n}\n","import {\n\tRepeaterImageSelectOptions,\n\tWpbfRepeaterControl,\n\tWpbfRepeaterRow,\n} from \"./repeater-interface\";\nimport RepeaterRow from \"./repeater-row\";\nimport _ from \"lodash\";\n\ndeclare var wp: {\n\tcustomize: WpbfCustomize;\n\tmedia: any;\n};\n\nwp.customize.controlConstructor[\"wpbf-repeater\"] =\n\twp.customize.Control.extend<WpbfRepeaterControl>({\n\t\t// When we're finished loading continue processing\n\t\tready: function (this: WpbfRepeaterControl): void {\n\t\t\tconst control = this;\n\n\t\t\t// Handle control removal - trigger destroy when control is removed.\n\t\t\tfunction handleOnRemoved(removedControl: WpbfRepeaterControl) {\n\t\t\t\tif (control === removedControl) {\n\t\t\t\t\tif (control.destroy) control.destroy();\n\t\t\t\t\tcontrol.container?.remove();\n\t\t\t\t\twp.customize.control.unbind(\"removed\", handleOnRemoved);\n\t\t\t\t}\n\t\t\t}\n\t\t\twp.customize.control.bind(\"removed\", handleOnRemoved);\n\n\t\t\tthis.initWpbfControl?.();\n\t\t},\n\n\t\t/**\n\t\t * Re-initialize the control after being destroyed.\n\t\t */\n\t\treinitialize: function (this: WpbfRepeaterControl): void {\n\t\t\tthis.initWpbfControl?.();\n\t\t},\n\n\t\trows: [],\n\n\t\tcurrentIndex: 0,\n\n\t\trepeaterFieldsContainer: undefined,\n\n\t\tsettingField: undefined,\n\n\t\trepeaterTemplate: undefined,\n\n\t\tinitWpbfControl: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\tctrl?: WpbfRepeaterControl,\n\t\t) {\n\t\t\tconst control = ctrl || this;\n\n\t\t\t// The current value set in Control Class (set in Kirki_Customize_Repeater_Control::to_json() function)\n\t\t\tconst settingValueFromParams = control.params.value;\n\n\t\t\t// The hidden field that keeps the data saved (though we never update it)\n\t\t\tcontrol.settingField = control.container\n\t\t\t\t.find(\"[data-customize-setting-link]\")\n\t\t\t\t.first();\n\n\t\t\t// Set the field value for the first time, we'll fill it up later\n\t\t\tcontrol.setValue?.([], false);\n\n\t\t\t// The DIV that holds all the rows\n\t\t\tcontrol.repeaterFieldsContainer = control.container\n\t\t\t\t.find(\".repeater-fields\")\n\t\t\t\t.first();\n\n\t\t\t// Set number of rows to 0\n\t\t\tcontrol.currentIndex = 0;\n\n\t\t\t// Save the rows objects\n\t\t\tcontrol.rows = [];\n\n\t\t\t// Default limit.\n\t\t\tlet limit: number | boolean = false;\n\n\t\t\tif (\"number\" === typeof control.params.limit) {\n\t\t\t\tlimit = 0 >= control.params.limit ? false : control.params.limit;\n\t\t\t}\n\n\t\t\tlet theNewRow;\n\n\t\t\tcontrol.container?.on(\"click\", \"button.repeater-add\", (e) => {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tif (\n\t\t\t\t\t!limit ||\n\t\t\t\t\t(\"number\" === typeof control.currentIndex &&\n\t\t\t\t\t\tcontrol.currentIndex < limit)\n\t\t\t\t) {\n\t\t\t\t\ttheNewRow = control.addRow?.();\n\t\t\t\t\ttheNewRow?.toggleMinimize();\n\t\t\t\t\tcontrol.initColorPicker?.();\n\t\t\t\t\tif (theNewRow) control.initSelect?.(theNewRow);\n\t\t\t\t} else {\n\t\t\t\t\tjQuery(control.selector + \" .limit\").addClass(\"highlight\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcontrol.container?.on(\"click\", \".repeater-row-remove\", function () {\n\t\t\t\tif (\"number\" === typeof control.currentIndex) {\n\t\t\t\t\tcontrol.currentIndex--;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!limit ||\n\t\t\t\t\t(\"number\" === typeof control.currentIndex &&\n\t\t\t\t\t\tcontrol.currentIndex < limit)\n\t\t\t\t) {\n\t\t\t\t\tjQuery(control.selector + \" .limit\").removeClass(\"highlight\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcontrol.container?.on(\n\t\t\t\t\"click keypress\",\n\t\t\t\t\".repeater-field-image .upload-button,.repeater-field-cropped_image .upload-button,.repeater-field-upload .upload-button\",\n\t\t\t\tfunction (e: JQuery.TriggeredEvent) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tcontrol.$thisButton = jQuery(this);\n\t\t\t\t\tcontrol.openFrame?.(e);\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tcontrol.container?.on(\n\t\t\t\t\"click keypress\",\n\t\t\t\t\".repeater-field-image .remove-button,.repeater-field-cropped_image .remove-button\",\n\t\t\t\tfunction (e: JQuery.TriggeredEvent) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tcontrol.$thisButton = jQuery(this);\n\t\t\t\t\tcontrol.removeImage?.(e);\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tcontrol.container?.on(\n\t\t\t\t\"click keypress\",\n\t\t\t\t\".repeater-field-upload .remove-button\",\n\t\t\t\tfunction (e: JQuery.TriggeredEvent) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tcontrol.$thisButton = jQuery(this);\n\t\t\t\t\tcontrol.removeFile?.(e);\n\t\t\t\t},\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * Function that loads the Mustache template\n\t\t\t */\n\t\t\tcontrol.repeaterTemplate = _.memoize(function () {\n\t\t\t\t/*\n\t\t\t\t * Underscore's default ERB-style templates are incompatible with PHP\n\t\t\t\t * when asp_tags is enabled, so WordPress uses Mustache-inspired templating syntax.\n\t\t\t\t *\n\t\t\t\t * @see trac ticket #22344.\n\t\t\t\t */\n\t\t\t\tconst options = {\n\t\t\t\t\tevaluate: /<#([\\s\\S]+?)#>/g,\n\t\t\t\t\tinterpolate: /\\{\\{\\{([\\s\\S]+?)\\}\\}\\}/g,\n\t\t\t\t\tescape: /\\{\\{([^\\}]+?)\\}\\}(?!\\})/g,\n\t\t\t\t\tvariable: \"data\",\n\t\t\t\t};\n\n\t\t\t\treturn function (data: any) {\n\t\t\t\t\tconst compiled = _.template(\n\t\t\t\t\t\tcontrol.container\n\t\t\t\t\t\t\t.find(\".customize-control-repeater-content\")\n\t\t\t\t\t\t\t.first()\n\t\t\t\t\t\t\t.html(),\n\t\t\t\t\t\toptions,\n\t\t\t\t\t);\n\n\t\t\t\t\treturn compiled(data);\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t/**\n\t\t\t * When we load the control, the fields have not been filled up.\n\t\t\t * This is the first time that we create all the rows.\n\t\t\t */\n\t\t\tif (settingValueFromParams.length) {\n\t\t\t\tlet i = 0;\n\n\t\t\t\tfor (i = 0; i < settingValueFromParams.length; i++) {\n\t\t\t\t\ttheNewRow = control.addRow?.(settingValueFromParams[i]);\n\t\t\t\t\tcontrol.initColorPicker?.();\n\n\t\t\t\t\tif (theNewRow) {\n\t\t\t\t\t\tcontrol.initSelect?.(theNewRow, settingValueFromParams[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontrol.repeaterFieldsContainer?.sortable({\n\t\t\t\thandle: \".repeater-row-header\",\n\t\t\t\tupdate: function () {\n\t\t\t\t\tcontrol.sort?.();\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Open the media modal.\n\t\t *\n\t\t * @param {JQuery.TriggeredEvent} event - The JS event.\n\t\t * @returns {void}\n\t\t */\n\t\topenFrame: function (event: JQuery.TriggeredEvent): void {\n\t\t\tif (wp.customize.utils.isKeydownButNotEnterEvent(event)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.$thisButton\n\t\t\t\t\t?.closest(\".repeater-field\")\n\t\t\t\t\t.hasClass(\"repeater-field-cropped_image\")\n\t\t\t) {\n\t\t\t\tthis.initCropperFrame?.();\n\t\t\t} else {\n\t\t\t\tthis.initFrame?.();\n\t\t\t}\n\n\t\t\tthis.frame.open();\n\t\t},\n\n\t\tinitFrame: function (): void {\n\t\t\tconst libMediaType = this.getMimeType();\n\n\t\t\tthis.frame = wp.media({\n\t\t\t\tstates: [\n\t\t\t\t\tnew wp.media.controller.Library({\n\t\t\t\t\t\tlibrary: wp.media.query({ type: libMediaType }),\n\t\t\t\t\t\tmultiple: false,\n\t\t\t\t\t\tdate: false,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\n\t\t\t// When a file is selected, run a callback.\n\t\t\tthis.frame.on(\"select\", this.onSelect, this);\n\t\t},\n\n\t\t/**\n\t\t * Create a media modal select frame, and store it so the instance can be reused when needed.\n\t\t * This is mostly a copy/paste of Core api.CroppedImageControl in /wp-admin/js/customize-control.js\n\t\t */\n\t\tinitCropperFrame: function (this: WpbfRepeaterControl): void {\n\t\t\t// We get the field id from which this was called.\n\t\t\tconst currentFieldId = this.$thisButton\n\t\t\t\t?.siblings(\"input.hidden-field\")\n\t\t\t\t.attr(\"data-field\");\n\t\t\tconst attrs = [\"width\", \"height\", \"flex_width\", \"flex_height\"]; // A list of attributes to look for\n\t\t\tconst libMediaType = this.getMimeType();\n\n\t\t\t// Make sure we got it\n\t\t\tif (_.isString(currentFieldId) && \"\" !== currentFieldId) {\n\t\t\t\t// Make fields is defined and only do the hack for cropped_image\n\t\t\t\tif (\n\t\t\t\t\t_.isObject(this.params.fields[currentFieldId]) &&\n\t\t\t\t\t\"cropped_image\" === this.params.fields[currentFieldId].type\n\t\t\t\t) {\n\t\t\t\t\t// Iterate over the list of attributes.\n\t\t\t\t\tfor (const attr of attrs) {\n\t\t\t\t\t\t// If the attribute exists in the field\n\t\t\t\t\t\tif (undefined !== this.params.fields[currentFieldId][attr]) {\n\t\t\t\t\t\t\t// Set the attribute in the main object\n\t\t\t\t\t\t\tthis.params[attr] = this.params.fields[currentFieldId][attr];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.frame = wp.media({\n\t\t\t\tbutton: {\n\t\t\t\t\ttext: \"Select and Crop\",\n\t\t\t\t\tclose: false,\n\t\t\t\t},\n\t\t\t\tstates: [\n\t\t\t\t\tnew wp.media.controller.Library({\n\t\t\t\t\t\tlibrary: wp.media.query({ type: libMediaType }),\n\t\t\t\t\t\tmultiple: false,\n\t\t\t\t\t\tdate: false,\n\t\t\t\t\t\tsuggestedWidth: this.params.width,\n\t\t\t\t\t\tsuggestedHeight: this.params.height,\n\t\t\t\t\t}),\n\t\t\t\t\tnew wp.media.controller.CustomizeImageCropper({\n\t\t\t\t\t\timgSelectOptions: this.calculateImageSelectOptions,\n\t\t\t\t\t\tcontrol: this,\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tthis.frame.on(\"select\", this.onSelectForCrop, this);\n\t\t\tthis.frame.on(\"cropped\", this.onCropped, this);\n\t\t\tthis.frame.on(\"skippedcrop\", this.onSkippedCrop, this);\n\t\t},\n\n\t\tonSelect: function (): void {\n\t\t\tconst attachment = this.frame.state().get(\"selection\").first().toJSON();\n\n\t\t\tif (\n\t\t\t\tthis.$thisButton\n\t\t\t\t\t?.closest(\".repeater-field\")\n\t\t\t\t\t.hasClass(\"repeater-field-upload\")\n\t\t\t) {\n\t\t\t\tthis.setFileInRepeaterField?.(attachment);\n\t\t\t} else {\n\t\t\t\tthis.setImageInRepeaterField?.(attachment);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * After an image is selected in the media modal, switch to the cropper\n\t\t * state if the image isn't the right size.\n\t\t */\n\n\t\tonSelectForCrop: function (this: WpbfRepeaterControl) {\n\t\t\tconst attachment = this.frame.state().get(\"selection\").first().toJSON();\n\n\t\t\tif (\n\t\t\t\tthis.params.width === attachment.width &&\n\t\t\t\tthis.params.height === attachment.height &&\n\t\t\t\t!this.params.flex_width &&\n\t\t\t\t!this.params.flex_height\n\t\t\t) {\n\t\t\t\tthis.setImageInRepeaterField?.(attachment);\n\t\t\t} else {\n\t\t\t\tthis.frame.setState(\"cropper\");\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * After the image has been cropped, apply the cropped image data to the setting.\n\t\t *\n\t\t * @param {object} croppedImage Cropped attachment data.\n\t\t * @returns {void}\n\t\t */\n\t\tonCropped: function (croppedImage: object): void {\n\t\t\tthis.setImageInRepeaterField?.(croppedImage);\n\t\t},\n\n\t\t/**\n\t\t * Returns a set of options, computed from the attached image data and\n\t\t * control-specific data, to be fed to the imgAreaSelect plugin in\n\t\t * wp.media.view.Cropper.\n\t\t *\n\t\t * @param {wp.media.model.Attachment} attachment - The attachment from the WP API.\n\t\t * @param {wp.media.controller.Cropper} controller - Media controller.\n\t\t * @returns {object} - Options.\n\t\t */\n\t\tcalculateImageSelectOptions: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\tattachment: any,\n\t\t\tcontroller: any,\n\t\t): object {\n\t\t\tconst control = controller.get(\"control\");\n\t\t\tconst flexWidth = !!parseInt(control.params.flex_width, 10);\n\t\t\tconst flexHeight = !!parseInt(control.params.flex_height, 10);\n\t\t\tconst realWidth = attachment.get(\"width\");\n\t\t\tconst realHeight = attachment.get(\"height\");\n\t\t\tlet xInit = parseInt(control.params.width, 10);\n\t\t\tlet yInit = parseInt(control.params.height, 10);\n\t\t\tconst ratio = xInit / yInit;\n\t\t\tconst xImg = realWidth;\n\t\t\tconst yImg = realHeight;\n\t\t\tlet x1;\n\t\t\tlet y1;\n\n\t\t\tcontroller.set(\n\t\t\t\t\"canSkipCrop\",\n\t\t\t\t!control.mustBeCropped(\n\t\t\t\t\tflexWidth,\n\t\t\t\t\tflexHeight,\n\t\t\t\t\txInit,\n\t\t\t\t\tyInit,\n\t\t\t\t\trealWidth,\n\t\t\t\t\trealHeight,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (xImg / yImg > ratio) {\n\t\t\t\tyInit = yImg;\n\t\t\t\txInit = yInit * ratio;\n\t\t\t} else {\n\t\t\t\txInit = xImg;\n\t\t\t\tyInit = xInit / ratio;\n\t\t\t}\n\n\t\t\tx1 = (xImg - xInit) / 2;\n\t\t\ty1 = (yImg - yInit) / 2;\n\n\t\t\tconst imgSelectOptions: RepeaterImageSelectOptions = {\n\t\t\t\thandles: true,\n\t\t\t\tkeys: true,\n\t\t\t\tinstance: true,\n\t\t\t\tpersistent: true,\n\t\t\t\timageWidth: realWidth,\n\t\t\t\timageHeight: realHeight,\n\t\t\t\taspectRatio: \"\",\n\t\t\t\tmaxHeight: false,\n\t\t\t\tmaxWidth: false,\n\t\t\t\tx1: x1,\n\t\t\t\ty1: y1,\n\t\t\t\tx2: xInit + x1,\n\t\t\t\ty2: yInit + y1,\n\t\t\t};\n\n\t\t\tif (false === flexHeight && false === flexWidth) {\n\t\t\t\timgSelectOptions.aspectRatio = xInit + \":\" + yInit;\n\t\t\t}\n\n\t\t\tif (false === flexHeight) {\n\t\t\t\timgSelectOptions.maxHeight = yInit;\n\t\t\t}\n\n\t\t\tif (false === flexWidth) {\n\t\t\t\timgSelectOptions.maxWidth = xInit;\n\t\t\t}\n\n\t\t\treturn imgSelectOptions;\n\t\t},\n\n\t\t/**\n\t\t * Return whether the image must be cropped, based on required dimensions.\n\t\t *\n\t\t * @param {bool} flexW - The flex-width.\n\t\t * @param {bool} flexH - The flex-height.\n\t\t * @param {int}  dstW - Initial point distance in the X axis.\n\t\t * @param {int}  dstH - Initial point distance in the Y axis.\n\t\t * @param {int}  imgW - Width.\n\t\t * @param {int}  imgH - Height.\n\t\t *\n\t\t * @returns {bool} - Whether the image must be cropped or not based on required dimensions.\n\t\t */\n\t\tmustBeCropped: function (\n\t\t\tflexW: boolean,\n\t\t\tflexH: boolean,\n\t\t\tdstW: number,\n\t\t\tdstH: number,\n\t\t\timgW: number,\n\t\t\timgH: number,\n\t\t): boolean {\n\t\t\treturn !(\n\t\t\t\t(true === flexW && true === flexH) ||\n\t\t\t\t(true === flexW && dstH === imgH) ||\n\t\t\t\t(true === flexH && dstW === imgW) ||\n\t\t\t\t(dstW === imgW && dstH === imgH) ||\n\t\t\t\timgW <= dstW\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * If cropping was skipped, apply the image data directly to the setting.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tonSkippedCrop: function (): void {\n\t\t\tconst attachment = this.frame.state().get(\"selection\").first().toJSON();\n\t\t\tthis.setImageInRepeaterField?.(attachment);\n\t\t},\n\n\t\t/**\n\t\t * Updates the setting and re-renders the control UI.\n\t\t *\n\t\t * @param {Record<string, any>} attachment - The attachment object.\n\t\t * @returns {void}\n\t\t */\n\t\tsetImageInRepeaterField: function (attachment: Record<string, any>): void {\n\t\t\tconst $targetDiv = this.$thisButton?.closest(\n\t\t\t\t\".repeater-field-image,.repeater-field-cropped_image\",\n\t\t\t);\n\n\t\t\t$targetDiv\n\t\t\t\t?.find(\".wpbf-image-attachment\")\n\t\t\t\t.html('<img src=\"' + attachment.url + '\">')\n\t\t\t\t.hide()\n\t\t\t\t.slideDown(\"slow\");\n\n\t\t\t$targetDiv?.find(\".hidden-field\").val(attachment.id);\n\t\t\tthis.$thisButton?.text(this.$thisButton.data(\"alt-label\"));\n\t\t\t$targetDiv?.find(\".remove-button\").show();\n\n\t\t\t//This will activate the save button\n\t\t\t$targetDiv?.find(\"input, textarea, select\").trigger(\"change\");\n\t\t\tthis.frame.close();\n\t\t},\n\n\t\t/**\n\t\t * Updates the setting and re-renders the control UI.\n\t\t *\n\t\t * @param {Record<string, any>} attachment - The attachment object.\n\t\t * @returns {void}\n\t\t */\n\t\tsetFileInRepeaterField: function (attachment: Record<string, any>): void {\n\t\t\tconst $targetDiv = this.$thisButton?.closest(\".repeater-field-upload\");\n\n\t\t\t$targetDiv\n\t\t\t\t?.find(\".wpbf-file-attachment\")\n\t\t\t\t.html(\n\t\t\t\t\t'<span class=\"file\"><span class=\"dashicons dashicons-media-default\"></span> ' +\n\t\t\t\t\t\tattachment.filename +\n\t\t\t\t\t\t\"</span>\",\n\t\t\t\t)\n\t\t\t\t.hide()\n\t\t\t\t.slideDown(\"slow\");\n\n\t\t\t$targetDiv?.find(\".hidden-field\").val(attachment.id);\n\t\t\tthis.$thisButton?.text(this.$thisButton.data(\"alt-label\"));\n\t\t\t$targetDiv?.find(\".upload-button\").show();\n\t\t\t$targetDiv?.find(\".remove-button\").show();\n\n\t\t\t// This will activate the save button.\n\t\t\t$targetDiv?.find(\"input, textarea, select\").trigger(\"change\");\n\t\t\tthis.frame.close();\n\t\t},\n\n\t\tgetMimeType: function (this: WpbfRepeaterControl) {\n\t\t\t// We get the field id from which this was called\n\t\t\tconst currentFieldId = this.$thisButton\n\t\t\t\t?.siblings(\"input.hidden-field\")\n\t\t\t\t.attr(\"data-field\");\n\n\t\t\t// Make sure we got it\n\t\t\tif (_.isString(currentFieldId) && \"\" !== currentFieldId) {\n\t\t\t\t// Make fields is defined and only do the hack for cropped_image\n\t\t\t\tif (\n\t\t\t\t\t_.isObject(this.params.fields[currentFieldId]) &&\n\t\t\t\t\t\"upload\" === this.params.fields[currentFieldId].type\n\t\t\t\t) {\n\t\t\t\t\t// If the attribute exists in the field\n\t\t\t\t\tif (undefined !== this.params.fields[currentFieldId].mime_type) {\n\t\t\t\t\t\t// Set the attribute in the main object\n\t\t\t\t\t\treturn this.params.fields[currentFieldId].mime_type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn \"image\";\n\t\t},\n\n\t\tremoveImage: function (event) {\n\t\t\tif (wp.customize.utils.isKeydownButNotEnterEvent(event)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $targetDiv = this.$thisButton?.closest(\n\t\t\t\t\".repeater-field-image,.repeater-field-cropped_image,.repeater-field-upload\",\n\t\t\t);\n\t\t\tconst $uploadButton = $targetDiv?.find(\".upload-button\");\n\n\t\t\t$targetDiv?.find(\".wpbf-image-attachment\").slideUp(\"fast\", function () {\n\t\t\t\tjQuery(this).show().html(jQuery(this).data(\"placeholder\"));\n\t\t\t});\n\t\t\t$targetDiv?.find(\".hidden-field\").val(\"\");\n\t\t\t$uploadButton?.text($uploadButton.data(\"label\"));\n\t\t\tthis.$thisButton?.hide();\n\n\t\t\t$targetDiv?.find(\"input, textarea, select\").trigger(\"change\");\n\t\t},\n\n\t\tremoveFile: function (event) {\n\t\t\tif (wp.customize.utils.isKeydownButNotEnterEvent(event)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $targetDiv = this.$thisButton?.closest(\".repeater-field-upload\");\n\t\t\tconst $uploadButton = $targetDiv?.find(\".upload-button\");\n\n\t\t\t$targetDiv?.find(\".wpbf-file-attachment\").slideUp(\"fast\", function () {\n\t\t\t\tjQuery(this).show().html(jQuery(this).data(\"placeholder\"));\n\t\t\t});\n\t\t\t$targetDiv?.find(\".hidden-field\").val(\"\");\n\t\t\t$uploadButton?.text($uploadButton.data(\"label\"));\n\t\t\tthis.$thisButton?.hide();\n\n\t\t\t$targetDiv?.find(\"input, textarea, select\").trigger(\"change\");\n\t\t},\n\n\t\t/**\n\t\t * Get the current value of the setting\n\t\t *\n\t\t * @returns {Record<string, any>[]} - Returns the value.\n\t\t */\n\t\tgetValue: function (): Record<string, any>[] {\n\t\t\t/**\n\t\t\t * The setting value returned via PHP will be associative array\n\t\t\t * because we handle it via PHP in `RepeaterSetting` class.\n\t\t\t *\n\t\t\t * TS type equivalent of that assoc-array is Record<string, any>.\n\t\t\t *\n\t\t\t * But the control.setting.get() in JS will return string\n\t\t\t * because it will be taken from the linked (hidden) setting field.\n\t\t\t */\n\t\t\tconst hiddenFieldValue = this.setting?.get();\n\n\t\t\tconst stringValue =\n\t\t\t\thiddenFieldValue === undefined || \"string\" !== typeof hiddenFieldValue\n\t\t\t\t\t? \"\"\n\t\t\t\t\t: hiddenFieldValue;\n\n\t\t\t// The setting is saved in JSON.\n\t\t\treturn JSON.parse(decodeURI(stringValue));\n\t\t},\n\n\t\t/**\n\t\t * Set a new value for the setting\n\t\t *\n\t\t * @param {Record<string, any>} newValue - The new value.\n\t\t * @param {bool} refresh - If we want to refresh the previewer or not\n\t\t * @param {bool} filtering - If we want to filter or not.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tsetValue: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\tnewValue: Record<string, any>,\n\t\t\trefresh?: boolean,\n\t\t\tfiltering?: boolean,\n\t\t): void {\n\t\t\t// We need to filter the values after the first load to remove data requrired for diplay but that we don't want to save in DB\n\t\t\tconst filteredValue = newValue;\n\t\t\tconst filter: string[] = [];\n\n\t\t\tif (filtering) {\n\t\t\t\tfor (const fieldId in this.params.fields) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.params.fields.hasOwnProperty(fieldId) &&\n\t\t\t\t\t\tthis.params.fields[fieldId].type &&\n\t\t\t\t\t\t[\"image\", \"cropped_image\", \"upload\"].includes(\n\t\t\t\t\t\t\tthis.params.fields[fieldId].type,\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tfilter.push(fieldId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tjQuery.each(newValue, function (key: string, value: any) {\n\t\t\t\t\tjQuery.each(filter, function (idx: number, field: string) {\n\t\t\t\t\t\tif (undefined !== value[field] && undefined !== value[field].id) {\n\t\t\t\t\t\t\tfilteredValue[key][field] = value[field].id;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.setting?.set(encodeURI(JSON.stringify(filteredValue)));\n\n\t\t\tif (refresh) {\n\t\t\t\t// Trigger the change event on the hidden field so\n\t\t\t\t// previewer refresh the website on Customizer\n\t\t\t\tthis.settingField?.trigger(\"change\");\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add a new row to repeater settings based on the structure.\n\t\t *\n\t\t * @param {Record<string, Record<string, any>>} data - (Optional) object of field => value pairs (undefined if you want to get the default values)\n\t\t * @returns {WpbfRepeaterRow|undefined} - Returns the new row.\n\t\t */\n\t\taddRow: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\tdata?: Record<string, Record<string, any>>,\n\t\t): WpbfRepeaterRow | undefined {\n\t\t\tconst control = this;\n\n\t\t\t// Get the current setting value.\n\t\t\tconst settingValue = this.getValue?.();\n\n\t\t\t// Saves the new setting data.\n\t\t\tconst newRowSetting: Record<string, any> = {};\n\n\t\t\t// The template for the new row (defined on Kirki_Customize_Repeater_Control::render_content() ).\n\t\t\tlet template = control.repeaterTemplate?.();\n\n\t\t\tif (template) {\n\t\t\t\t/**\n\t\t\t\t * Data to pass to the template.\n\t\t\t\t *\n\t\t\t\t * The control structure is going to define the new fields.\n\t\t\t\t * We need to clone control.params.fields.\n\t\t\t\t * Assigning it could result in a reference assignment.\n\t\t\t\t */\n\t\t\t\tlet templateData = jQuery.extend(true, {}, control.params.fields);\n\n\t\t\t\t// But if we have passed data, we'll use the data values instead\n\t\t\t\tif (data) {\n\t\t\t\t\tlet fieldId;\n\n\t\t\t\t\tfor (fieldId in data) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tdata.hasOwnProperty(fieldId) &&\n\t\t\t\t\t\t\ttemplateData.hasOwnProperty(fieldId)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\ttemplateData[fieldId].default = data[fieldId];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ? I don't know if this is necessary. Furthermore, it has type error.\n\t\t\t\t// templateData.index = this.currentIndex;\n\n\t\t\t\t// Append the template content\n\t\t\t\ttemplate = template(templateData);\n\n\t\t\t\t// Create a new row object and append the element\n\t\t\t\tconst newRow: WpbfRepeaterRow = new RepeaterRow(\n\t\t\t\t\tcontrol.currentIndex ?? 0,\n\t\t\t\t\tjQuery(template).appendTo(control.repeaterFieldsContainer!),\n\t\t\t\t\tcontrol.params.rowLabel!,\n\t\t\t\t\tcontrol,\n\t\t\t\t);\n\n\t\t\t\tnewRow.container.on(\n\t\t\t\t\t\"row:remove\",\n\t\t\t\t\tfunction (e: JQuery.TriggeredEvent, rowIndex: number) {\n\t\t\t\t\t\tcontrol.deleteRow?.(rowIndex);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tnewRow.container.on(\n\t\t\t\t\t\"row:update\",\n\t\t\t\t\tfunction (\n\t\t\t\t\t\te: JQuery.TriggeredEvent,\n\t\t\t\t\t\trowIndex: number,\n\t\t\t\t\t\tfieldName: string,\n\t\t\t\t\t\telement: HTMLInputElement | HTMLTextAreaElement,\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontrol.updateField?.call(control, e, rowIndex, fieldName, element);\n\t\t\t\t\t\tnewRow.updateLabel?.();\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\t// Add the row to rows collection\n\t\t\t\tif (undefined !== this.currentIndex && undefined !== this.rows) {\n\t\t\t\t\tthis.rows[this.currentIndex] = newRow;\n\t\t\t\t}\n\n\t\t\t\tlet fieldId;\n\n\t\t\t\tfor (fieldId in templateData) {\n\t\t\t\t\tif (templateData.hasOwnProperty(fieldId)) {\n\t\t\t\t\t\tnewRowSetting[fieldId] = templateData[fieldId].default;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (undefined !== settingValue) {\n\t\t\t\t\tif (undefined !== this.currentIndex) {\n\t\t\t\t\t\tsettingValue[this.currentIndex] = newRowSetting;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setValue?.(settingValue, true);\n\t\t\t\t}\n\n\t\t\t\tif (undefined !== this.currentIndex) this.currentIndex++;\n\n\t\t\t\treturn newRow;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t},\n\n\t\tsort: function (): void {\n\t\t\tconst control = this;\n\n\t\t\tif (!control.getValue) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $rows = this.repeaterFieldsContainer?.find(\".repeater-row\");\n\t\t\tconst newOrder: any[] = [];\n\t\t\tconst settings = control.getValue();\n\t\t\tconst newRows: WpbfRepeaterRow[] = [];\n\t\t\tconst newSettings: any[] = [];\n\n\t\t\t$rows?.each(function (i: number, element: HTMLElement) {\n\t\t\t\tnewOrder.push(jQuery(element).data(\"row\"));\n\t\t\t});\n\n\t\t\tjQuery.each(newOrder, function (newPosition, oldPosition) {\n\t\t\t\tif (control.rows) {\n\t\t\t\t\tnewRows[newPosition] = control.rows[oldPosition];\n\t\t\t\t}\n\n\t\t\t\tnewRows[newPosition].setRowIndex(newPosition);\n\n\t\t\t\tnewSettings[newPosition] = settings[oldPosition];\n\t\t\t});\n\n\t\t\tcontrol.rows = newRows;\n\t\t\tcontrol.setValue?.(newSettings);\n\t\t},\n\n\t\t/**\n\t\t * Delete a row in the repeater setting\n\t\t *\n\t\t * @param {number} index - Position of the row in the complete Setting Array\n\t\t * @returns {void}\n\t\t */\n\t\tdeleteRow: function (index: number): void {\n\t\t\tif (undefined === this.rows) return;\n\t\t\tif (!this.getValue) return;\n\n\t\t\tconst currentSettings = this.getValue();\n\n\t\t\tif (currentSettings[index]) {\n\t\t\t\t// Find the row\n\t\t\t\tconst row = this.rows[index];\n\n\t\t\t\tif (row) {\n\t\t\t\t\t// Remove the row settings\n\t\t\t\t\tdelete currentSettings[index];\n\n\t\t\t\t\t// Remove the row from the rows collection\n\t\t\t\t\tdelete this.rows[index];\n\n\t\t\t\t\t// Update the new setting values\n\t\t\t\t\tthis.setValue?.(currentSettings, true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remap the row numbers\n\t\t\tfor (let prop in this.rows) {\n\t\t\t\tif (this.rows.hasOwnProperty(prop) && this.rows[prop]) {\n\t\t\t\t\tthis.rows[prop].updateLabel();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Update a single field inside a row.\n\t\t * Triggered when a field has changed\n\t\t *\n\t\t * @param {JQuery.TriggeredEvent} e - Event object\n\t\t * @param {number} rowIndex - The row's index as an integer.\n\t\t * @param {string} fieldId - The field ID.\n\t\t * @param {HTMLInputElement | HTMLTextAreaElement} element - The element's identifier, or jQuery object of the element.\n\t\t * @returns {void}\n\t\t */\n\t\tupdateField: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\te: JQuery.TriggeredEvent,\n\t\t\trowIndex: number,\n\t\t\tfieldId: string,\n\t\t\telement: HTMLInputElement | HTMLTextAreaElement,\n\t\t): void {\n\t\t\tif (!this.getValue) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (undefined === this.rows || !this.rows[rowIndex]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.params.fields[fieldId]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst type = this.params.fields[fieldId].type;\n\t\t\tconst row = this.rows[rowIndex];\n\t\t\tconst currentSettings = this.getValue();\n\n\t\t\tconst $el = jQuery(element);\n\n\t\t\tif (undefined === currentSettings[row.rowIndex][fieldId]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\"checkbox\" === type) {\n\t\t\t\tcurrentSettings[row.rowIndex][fieldId] = $el.is(\":checked\");\n\t\t\t} else {\n\t\t\t\t// Update the settings\n\t\t\t\tcurrentSettings[row.rowIndex][fieldId] = $el.val();\n\t\t\t}\n\n\t\t\tthis.setValue?.(currentSettings, true);\n\t\t},\n\n\t\t/**\n\t\t * Init the color picker on color fields\n\t\t * Called after AddRow\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tinitColorPicker: function (this: WpbfRepeaterControl): void {\n\t\t\tconst control = this;\n\t\t\tconst colorPicker = control.container?.find(\".wpbf-classic-color-picker\");\n\t\t\tconst fieldId = colorPicker?.data(\"field\");\n\t\t\tconst options: Record<string, any> = {};\n\n\t\t\t// We check if the color palette parameter is defined.\n\t\t\tif (\n\t\t\t\tundefined !== fieldId &&\n\t\t\t\tundefined !== control.params.fields[fieldId] &&\n\t\t\t\tundefined !== control.params.fields[fieldId].palettes &&\n\t\t\t\t_.isObject(control.params.fields[fieldId].palettes)\n\t\t\t) {\n\t\t\t\toptions.palettes = control.params.fields[fieldId].palettes;\n\t\t\t}\n\n\t\t\t// When the color picker value is changed we update the value of the field\n\t\t\toptions.change = (event: any, ui: any) => {\n\t\t\t\tif (!control.getValue) return;\n\n\t\t\t\tconst currentPicker = jQuery(event.target);\n\t\t\t\tconst row = currentPicker.closest(\".repeater-row\");\n\t\t\t\tconst rowIndex = row.data(\"row\");\n\t\t\t\tconst currentSettings = control.getValue();\n\t\t\t\tconst value =\n\t\t\t\t\tui.color._alpha < 1 ? ui.color.to_s() : ui.color.toString();\n\n\t\t\t\tcurrentSettings[rowIndex][currentPicker.data(\"field\")] = value;\n\t\t\t\tcontrol.setValue?.(currentSettings, true);\n\n\t\t\t\t/**\n\t\t\t\t * By default if the alpha is 1, the input will be rgb.\n\t\t\t\t * We setTimeout to 50ms to prevent race value set.\n\t\t\t\t */\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tevent.target.value = value;\n\t\t\t\t}, 50);\n\t\t\t};\n\n\t\t\t// Init the color picker\n\t\t\tif (colorPicker && colorPicker.length > 0) {\n\t\t\t\t(colorPicker as any).wpColorPicker(options);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Init the dropdown-pages field.\n\t\t * Called after AddRow\n\t\t *\n\t\t * @param {WpbfRepeaterRow} theNewRow the row that was added to the repeater\n\t\t * @param {Record<string, any>} data the data for the row if we're initializing a pre-existing row\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tinitSelect: function (\n\t\t\tthis: WpbfRepeaterControl,\n\t\t\ttheNewRow: WpbfRepeaterRow,\n\t\t\tdata?: Record<string, any>,\n\t\t): void {\n\t\t\tconst control = this;\n\t\t\tconst dropdown = theNewRow.container.find(\".repeater-field select\");\n\n\t\t\tif (0 === dropdown.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dataField = dropdown.data(\"field\");\n\n\t\t\tdata = data || {};\n\t\t\tdata[dataField] = data[dataField] || \"\";\n\n\t\t\tjQuery(dropdown).val(data[dataField] || jQuery(dropdown).val());\n\n\t\t\tthis.container.on(\"change\", \".repeater-field select\", function (event) {\n\t\t\t\tif (!control.getValue) return;\n\n\t\t\t\tconst currentDropdown = jQuery(event.target);\n\t\t\t\tconst row = currentDropdown.closest(\".repeater-row\");\n\t\t\t\tconst rowIndex = row.data(\"row\");\n\t\t\t\tconst currentSettings = control.getValue();\n\n\t\t\t\tcurrentSettings[rowIndex][currentDropdown.data(\"field\")] =\n\t\t\t\t\tjQuery(this).val();\n\t\t\t\tcontrol.setValue?.(currentSettings);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Handle removal/de-registration of the control.\n\t\t * Cleans up jQuery Sortable, event handlers, wp.media frame,\n\t\t * color pickers, and row objects.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tdestroy: function (this: WpbfRepeaterControl): void {\n\t\t\t// Destroy jQuery Sortable on the repeater fields container.\n\t\t\tif (this.repeaterFieldsContainer?.data(\"ui-sortable\")) {\n\t\t\t\tthis.repeaterFieldsContainer.sortable(\"destroy\");\n\t\t\t}\n\n\t\t\t// Unbind all container events (handles lines 68-127, 940).\n\t\t\tthis.container?.off();\n\n\t\t\t// Destroy wp.media frame if it exists.\n\t\t\tif (this.frame) {\n\t\t\t\tthis.frame.off();\n\t\t\t\tthis.frame.dispose?.();\n\t\t\t\tthis.frame = undefined;\n\t\t\t}\n\n\t\t\t// Destroy color pickers.\n\t\t\tthis.container?.find(\".wpbf-classic-color-picker\").each(function () {\n\t\t\t\tconst $picker = jQuery(this);\n\t\t\t\tif ($picker.data(\"wpColorPicker\")) {\n\t\t\t\t\t($picker as any).wpColorPicker(\"destroy\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Clean up row objects - unbind event handlers and clear references.\n\t\t\tif (this.rows) {\n\t\t\t\tfor (const index in this.rows) {\n\t\t\t\t\tconst row = this.rows[index];\n\t\t\t\t\tif (row) {\n\t\t\t\t\t\trow.container?.off();\n\t\t\t\t\t\trow.header?.off();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.rows = [];\n\t\t\t}\n\n\t\t\t// Clear memoized template function.\n\t\t\tthis.repeaterTemplate = undefined;\n\n\t\t\t// Clear other references.\n\t\t\tthis.settingField = undefined;\n\t\t\tthis.repeaterFieldsContainer = undefined;\n\t\t},\n\t});\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { SelectControlChoice, WpbfSelectControl } from \"./select-interface\";\r\n\r\nif (window.wp.customize) {\r\n\tsetupSelectControl(window.wp.customize);\r\n}\r\n\r\nfunction setupSelectControl(customizer: WpbfCustomize) {\r\n\tcustomizer.controlConstructor[\"wpbf-enhanced-select\"] =\r\n\t\tcustomizer.Control.extend<WpbfSelectControl>({\r\n\t\t\t/**\r\n\t\t\t * Initialize.\r\n\t\t\t */\r\n\t\t\tinitialize: function (id, params) {\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tcustomizer.Control.prototype.initialize.call(control, id, params);\r\n\r\n\t\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\t\tfunction onRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\t\tif (control === removedControl) {\r\n\t\t\t\t\t\tcontrol?.destroy?.();\r\n\t\t\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\t\t\tcustomizer.control.unbind(\"removed\", onRemoved);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcustomizer.control.bind(\"removed\", onRemoved);\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Set notification container and render.\r\n\t\t\t */\r\n\t\t\tsetNotificationContainer: function (el) {\r\n\t\t\t\tif (!this.notifications) return;\r\n\t\t\t\tthis.notifications.container = jQuery(el);\r\n\t\t\t\tthis.notifications.render();\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Render the control into the DOM.\r\n\t\t\t *\r\n\t\t\t * This is called from the Control#embed() method in the parent class.\r\n\t\t\t */\r\n\t\t\trenderContent: function () {\r\n\t\t\t\tif (!this.params) return;\r\n\t\t\t\tconst params = this.params;\r\n\r\n\t\t\t\tconst labelTemplate = `\r\n\t\t\t\t<label class=\"customize-control-title\" for=\"wpbf-control-input-${this.id}\">\r\n\t\t\t\t\t<span className=\"customize-control-title\">${params.label}</span>\r\n\t\t\t\t</label>\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tconst labelDescriptionTemplate = `\r\n\t\t\t\t<div class=\"customize-control-description description\">\r\n\t\t\t\t\t${params.description}\r\n\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tconst headerTemplate = `\r\n\t\t\t\t<header clas=\"wpbf-control-header\">\r\n\t\t\t\t\t${params.label ? labelTemplate : \"\"}\r\n\t\t\t\t\t${params.description ? labelDescriptionTemplate : \"\"}\r\n\t\t\t\t\t<div class=\"customize-control-notifications-container\"></div>\r\n\t\t\t\t</header>\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tconst formTemplate = `\r\n\t\t\t\t<div class=\"wpbf-control-form\">\r\n\t\t\t\t\t<select class=\"wpbf-select2\"${params.multiple ? \" multiple\" : \"\"}></select>\r\n\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tlet template = headerTemplate + formTemplate;\r\n\r\n\t\t\t\tif (params.layoutStyle === \"horizontal\") {\r\n\t\t\t\t\ttemplate = `\r\n\t\t\t\t\t<div class=\"wpbf-control-cols\">\r\n\t\t\t\t\t\t<div class=\"wpbf-control-left-col wpbf-w50\">\r\n\t\t\t\t\t\t\t${headerTemplate}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"wpbf-control-right-col wpbf-flex wpbf-content-end wpbf-w50\">\r\n\t\t\t\t\t\t\t${formTemplate}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t`;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.container?.html(template);\r\n\r\n\t\t\t\tconst notificationsContainer = document.querySelector(\r\n\t\t\t\t\t`#customize-control-${this.id} .customize-control-notifications-container`,\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tnotificationsContainer &&\r\n\t\t\t\t\tnotificationsContainer instanceof HTMLElement\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.setNotificationContainer?.(notificationsContainer);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst $selectbox = this.container?.find(\".wpbf-select2\");\r\n\r\n\t\t\t\t$selectbox?.on(\"change.select2\", (e) => {\r\n\t\t\t\t\tconst selectedOptions = $selectbox?.select2(\"data\");\r\n\r\n\t\t\t\t\tconst values = selectedOptions?.map((option) => option.id);\r\n\t\t\t\t\tlet value = null;\r\n\r\n\t\t\t\t\tif (values?.length) {\r\n\t\t\t\t\t\tvalue = params.multiple ? values : values[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvalue = params.multiple ? [] : \"\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.setting?.set(value);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst choicesGlobalVar = params.choicesGlobalVar;\r\n\r\n\t\t\t\tconst choicesFromGlobalVar =\r\n\t\t\t\t\tchoicesGlobalVar && choicesGlobalVar in window\r\n\t\t\t\t\t\t? (window[choicesGlobalVar] as SelectControlChoice[])\r\n\t\t\t\t\t\t: undefined;\r\n\r\n\t\t\t\tif (choicesFromGlobalVar) {\r\n\t\t\t\t\tconst value = this.setting?.get();\r\n\t\t\t\t\tconst values = !Array.isArray(value) ? [value] : value;\r\n\r\n\t\t\t\t\tchoicesFromGlobalVar.forEach((choice, index) => {\r\n\t\t\t\t\t\tif (choice.id && values.includes(choice.id)) {\r\n\t\t\t\t\t\t\tchoicesFromGlobalVar[index].selected = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (choice.children && choice.children.length) {\r\n\t\t\t\t\t\t\tchoice.children.forEach((child, childIndex) => {\r\n\t\t\t\t\t\t\t\tif (child.id && values.includes(child.id)) {\r\n\t\t\t\t\t\t\t\t\tif (choicesFromGlobalVar[index].children) {\r\n\t\t\t\t\t\t\t\t\t\tchoicesFromGlobalVar[index].children[childIndex].selected =\r\n\t\t\t\t\t\t\t\t\t\t\ttrue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$selectbox?.select2({\r\n\t\t\t\t\tplaceholder: params.placeholder,\r\n\t\t\t\t\tallowClear: params.clearable,\r\n\t\t\t\t\tmultiple: params.multiple,\r\n\t\t\t\t\tmaximumSelectionLength: params.multiple\r\n\t\t\t\t\t\t? params.maxSelections\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\t// @ts-ignore - In a grouped option, id can be omitted, but Select2's types requires id to be a string|number -_-.\r\n\t\t\t\t\tdata: choicesFromGlobalVar ?? params.choices,\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t\t\t */\r\n\t\t\tready: function () {\r\n\t\t\t\t// Update component state when customizer setting changes.\r\n\t\t\t\tthis.setting?.bind((val) => {\r\n\t\t\t\t\tif (this.updateComponentState) {\r\n\t\t\t\t\t\tlet value = val;\r\n\r\n\t\t\t\t\t\tif (undefined === value) {\r\n\t\t\t\t\t\t\tvalue = this.params?.multiple ? [] : \"\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.updateComponentState(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tupdateComponentState: function (value) {\r\n\t\t\t\tconst $selectbox = this.container?.find(\".wpbf-select2\");\r\n\t\t\t\t$selectbox?.val(value);\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * Handle removal/de-registration of the control.\r\n\t\t\t *\r\n\t\t\t * This is essentially the inverse of the Control#embed() method.\r\n\t\t\t *\r\n\t\t\t * @link https://core.trac.wordpress.org/ticket/31334\r\n\t\t\t */\r\n\t\t\tdestroy: function destroy() {\r\n\t\t\t\tconst $selectbox = this.container?.find(\".wpbf-select2\");\r\n\t\t\t\t$selectbox?.off(\"change.select2\");\r\n\t\t\t\t$selectbox?.select2(\"destroy\");\r\n\r\n\t\t\t\tthis.container?.html(\"\");\r\n\r\n\t\t\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\t\t\tif (customizer.Control.prototype.destroy) {\r\n\t\t\t\t\tcustomizer.Control.prototype.destroy.call(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t});\r\n}\r\n","import SliderControl from \"./SliderControl\";\r\n\r\nif (window.wp.customize) {\r\n\twindow.wp.customize.controlConstructor[\"wpbf-slider\"] = SliderControl(\r\n\t\twindow.wp.customize,\r\n\t);\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { createRoot } from \"react-dom/client\";\r\nimport SliderForm from \"./SliderForm\";\r\nimport { WpbfSliderControl, WpbfSliderControlParams } from \"./slider-interface\";\r\n\r\nexport default function SliderControl(customizer: WpbfCustomize) {\r\n\treturn customizer.Control.extend<WpbfSliderControl>({\r\n\t\tinitialize: function (id: string, params: WpbfSliderControlParams) {\r\n\t\t\t// Bind functions to this control context for passing as React props.\r\n\t\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\r\n\t\t\tthis.overrideUpdateComponentStateFn =\r\n\t\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\r\n\t\t\tthis.updateCustomizerSetting = this.updateCustomizerSetting?.bind(this);\r\n\r\n\t\t\tcustomizer.Control.prototype.initialize.call(this, id, params);\r\n\r\n\t\t\tconst control = this;\r\n\r\n\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\tfunction handleOnRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\tif (control !== removedControl) return;\r\n\t\t\t\tif (control.destroy) control.destroy();\r\n\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\tcustomizer.control.unbind(\"removed\", handleOnRemoved);\r\n\t\t\t}\r\n\r\n\t\t\tcustomizer.control.bind(\"removed\", handleOnRemoved);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set notification container and render.\r\n\t\t *\r\n\t\t * This will be called when the React component is mounted.\r\n\t\t */\r\n\t\tsetNotificationContainer: function setNotificationContainer(el) {\r\n\t\t\tif (this.notifications) this.notifications.container = jQuery(el);\r\n\t\t\tthis.notifications?.render();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Render the control into the DOM.\r\n\t\t *\r\n\t\t * This will be called from the Control#embed() method in the parent class.\r\n\t\t */\r\n\t\trenderContent: function renderContent() {\r\n\t\t\tif (!this.root && this.container) {\r\n\t\t\t\tthis.root = createRoot(this.container[0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.root?.render(\r\n\t\t\t\t<SliderForm\r\n\t\t\t\t\tid={this.setting?.id ?? \"\"}\r\n\t\t\t\t\tmin={this.params?.min}\r\n\t\t\t\t\tmax={this.params?.max}\r\n\t\t\t\t\tstep={this.params?.step}\r\n\t\t\t\t\tlabel={this.params?.label}\r\n\t\t\t\t\tdescription={this.params?.description}\r\n\t\t\t\t\tdefault={this.params?.default}\r\n\t\t\t\t\tvalue={this.params?.value}\r\n\t\t\t\t\tupdateCustomizerSetting={this.updateCustomizerSetting}\r\n\t\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\r\n\t\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\r\n\t\t\t\t/>,\r\n\t\t\t);\r\n\r\n\t\t\tif (this.params?.allowCollapse) {\r\n\t\t\t\tthis.container?.addClass(\"allowCollapse\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t\t *\r\n\t\t * React is available to be used here instead of the customizer.Element abstraction.\r\n\t\t */\r\n\t\tready: function ready() {\r\n\t\t\t// Update component's state when customizer setting's value is changed.\r\n\t\t\tthis.setting?.bind((val) => {\r\n\t\t\t\tthis.updateComponentState?.(val);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\r\n\t\t\tif (val === undefined) return;\r\n\t\t\tthis.setting?.set(val);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * This method will be overriden by the rendered component via overrideUpdateComponentStateFn.\r\n\t\t */\r\n\t\tupdateComponentState: function (val) {},\r\n\r\n\t\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(\r\n\t\t\tfn,\r\n\t\t) {\r\n\t\t\tthis.updateComponentState = fn;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle removal/de-registration of the control.\r\n\t\t *\r\n\t\t * This is essentially the inverse of the Control#embed() method.\r\n\t\t *\r\n\t\t * @link https://core.trac.wordpress.org/ticket/31334\r\n\t\t */\r\n\t\tdestroy: function destroy() {\r\n\t\t\tthis.root?.unmount();\r\n\t\t\tthis.root = undefined;\r\n\r\n\t\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\t\tcustomizer.Control.prototype.destroy?.call(this);\r\n\t\t},\r\n\t});\r\n}\r\n","import InputSliderControl from \"./InputSliderControl\";\r\n\r\nif (window.wp.customize) {\r\n\twindow.wp.customize.controlConstructor[\"wpbf-input-slider\"] =\r\n\t\tInputSliderControl(window.wp.customize);\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { createRoot } from \"react-dom/client\";\r\nimport InputSliderForm from \"./InputSliderForm\";\r\nimport {\r\n\tWpbfInputSliderControl,\r\n\tWpbfInputSliderControlParams,\r\n} from \"./slider-interface\";\r\n\r\nexport default function InputSliderControl(customizer: WpbfCustomize) {\r\n\treturn customizer.Control.extend<WpbfInputSliderControl>({\r\n\t\tinitialize: function (id: string, params: WpbfInputSliderControlParams) {\r\n\t\t\t// Bind functions to this control context for passing as React props.\r\n\t\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\r\n\t\t\tthis.overrideUpdateComponentStateFn =\r\n\t\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\r\n\t\t\tthis.updateCustomizerSetting = this.updateCustomizerSetting?.bind(this);\r\n\r\n\t\t\tcustomizer.Control.prototype.initialize.call(this, id, params);\r\n\r\n\t\t\tconst control = this;\r\n\r\n\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\tfunction handleOnRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\tif (control !== removedControl) return;\r\n\t\t\t\tif (control.destroy) control.destroy();\r\n\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\tcustomizer.control.unbind(\"removed\", handleOnRemoved);\r\n\t\t\t}\r\n\r\n\t\t\tcustomizer.control.bind(\"removed\", handleOnRemoved);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set notification container and render.\r\n\t\t *\r\n\t\t * This will be called when the React component is mounted.\r\n\t\t */\r\n\t\tsetNotificationContainer: function setNotificationContainer(el) {\r\n\t\t\tif (this.notifications) this.notifications.container = jQuery(el);\r\n\t\t\tthis.notifications?.render();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Render the control into the DOM.\r\n\t\t *\r\n\t\t * This will be called from the Control#embed() method in the parent class.\r\n\t\t */\r\n\t\trenderContent: function renderContent() {\r\n\t\t\tif (!this.root && this.container) {\r\n\t\t\t\tthis.root = createRoot(this.container[0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.root?.render(\r\n\t\t\t\t<InputSliderForm\r\n\t\t\t\t\tid={this.setting?.id ?? \"\"}\r\n\t\t\t\t\tmin={this.params?.min}\r\n\t\t\t\t\tmax={this.params?.max}\r\n\t\t\t\t\tstep={this.params?.step}\r\n\t\t\t\t\tlabel={this.params?.label}\r\n\t\t\t\t\tdescription={this.params?.description}\r\n\t\t\t\t\tdefault={this.params?.default ?? \"\"}\r\n\t\t\t\t\tvalue={this.params?.value ?? \"\"}\r\n\t\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\r\n\t\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\r\n\t\t\t\t\tupdateCustomizerSetting={this.updateCustomizerSetting}\r\n\t\t\t\t/>,\r\n\t\t\t);\r\n\r\n\t\t\tif (this.params?.allowCollapse) {\r\n\t\t\t\tthis.container?.addClass(\"allowCollapse\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t\t *\r\n\t\t * React is available to be used here instead of the customizer.Element abstraction.\r\n\t\t */\r\n\t\tready: function ready() {\r\n\t\t\t// Update component value's state when customizer setting's value is changed.\r\n\t\t\tthis.setting?.bind((val) => {\r\n\t\t\t\tthis.updateComponentState?.(val);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\r\n\t\t\tif (val === undefined) return;\r\n\t\t\tthis.setting?.set(val);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * This method will be overriden by the rendered component.\r\n\t\t */\r\n\t\tupdateComponentState: function (val) {},\r\n\r\n\t\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(\r\n\t\t\tfn,\r\n\t\t) {\r\n\t\t\tthis.updateComponentState = fn;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle removal/de-registration of the control.\r\n\t\t *\r\n\t\t * This is essentially the inverse of the Control#embed() method.\r\n\t\t *\r\n\t\t * @link https://core.trac.wordpress.org/ticket/31334\r\n\t\t */\r\n\t\tdestroy: function destroy(this: WpbfInputSliderControl) {\r\n\t\t\tthis.root?.unmount();\r\n\t\t\tthis.root = undefined;\r\n\r\n\t\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\t\tcustomizer.Control.prototype.destroy?.call(this);\r\n\t\t},\r\n\t});\r\n}\r\n","import ResponsiveInputSliderControl from \"./ResponsiveInputSliderControl\";\r\n\r\nif (window.wp.customize) {\r\n\t// Register control type with Customizer.\r\n\twindow.wp.customize.controlConstructor[\"wpbf-responsive-input-slider\"] =\r\n\t\tResponsiveInputSliderControl(window.wp.customize);\r\n}\r\n","import { AnyWpbfCustomizeControl } from \"../../Base/src/base-interface\";\r\nimport { createRoot } from \"react-dom/client\";\r\nimport ResponsiveInputSliderForm from \"./ResponsiveInputSliderForm\";\r\nimport {\r\n\tWpbfResponsiveInputSliderControl,\r\n\tWpbfResponsiveInputSliderControlParams,\r\n} from \"./slider-interface\";\r\nimport { DevicesValue } from \"../../Responsive/src/responsive-interface\";\r\n\r\nexport default function ResponsiveInputSliderControl(\r\n\tcustomizer: WpbfCustomize,\r\n) {\r\n\treturn customizer.Control.extend<WpbfResponsiveInputSliderControl>({\r\n\t\tinitialize: function (\r\n\t\t\tid: string,\r\n\t\t\tparams: WpbfResponsiveInputSliderControlParams,\r\n\t\t) {\r\n\t\t\t// Bind functions to this control context for passing as React props.\r\n\t\t\tthis.setNotificationContainer = this.setNotificationContainer?.bind(this);\r\n\t\t\tthis.overrideUpdateComponentStateFn =\r\n\t\t\t\tthis.overrideUpdateComponentStateFn?.bind(this);\r\n\t\t\tthis.updateCustomizerSetting = this.updateCustomizerSetting?.bind(this);\r\n\r\n\t\t\tcustomizer.Control.prototype.initialize.call(this, id, params);\r\n\r\n\t\t\tconst control = this;\r\n\r\n\t\t\t// The following should be eliminated with <https://core.trac.wordpress.org/ticket/31334>.\r\n\t\t\tfunction handleOnRemoved(removedControl: AnyWpbfCustomizeControl) {\r\n\t\t\t\tif (control !== removedControl) return;\r\n\t\t\t\tif (control.destroy) control.destroy();\r\n\t\t\t\tcontrol.container?.remove();\r\n\t\t\t\tcustomizer.control.unbind(\"removed\", handleOnRemoved);\r\n\t\t\t}\r\n\r\n\t\t\tcustomizer.control.bind(\"removed\", handleOnRemoved);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Set notification container and render.\r\n\t\t *\r\n\t\t * This will be called when the React component is mounted.\r\n\t\t */\r\n\t\tsetNotificationContainer: function setNotificationContainer(el) {\r\n\t\t\tif (this.notifications) this.notifications.container = jQuery(el);\r\n\t\t\tthis.notifications?.render();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Render the control into the DOM.\r\n\t\t *\r\n\t\t * This will be called from the Control#embed() method in the parent class.\r\n\t\t */\r\n\t\trenderContent: function renderContent() {\r\n\t\t\tif (!this.root && this.container) {\r\n\t\t\t\tthis.root = createRoot(this.container[0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis.root?.render(\r\n\t\t\t\t<ResponsiveInputSliderForm\r\n\t\t\t\t\tid={this.setting?.id ?? \"\"}\r\n\t\t\t\t\tmin={this.params?.min}\r\n\t\t\t\t\tmax={this.params?.max}\r\n\t\t\t\t\tstep={this.params?.step}\r\n\t\t\t\t\tlabel={this.params?.label}\r\n\t\t\t\t\tdescription={this.params?.description}\r\n\t\t\t\t\tdefault={this.params?.default ?? \"\"}\r\n\t\t\t\t\tvalue={this.params?.value ?? \"\"}\r\n\t\t\t\t\toverrideUpdateComponentStateFn={this.overrideUpdateComponentStateFn}\r\n\t\t\t\t\tupdateCustomizerSetting={this.updateCustomizerSetting}\r\n\t\t\t\t\tsetNotificationContainer={this.setNotificationContainer}\r\n\t\t\t\t\tdevices={this.params?.devices}\r\n\t\t\t\t\tsaveAsJson={this.params?.saveAsJson}\r\n\t\t\t\t/>,\r\n\t\t\t);\r\n\r\n\t\t\tthis.container?.addClass(\"allowCollapse\");\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * After control has been first rendered, start re-rendering when setting changes.\r\n\t\t *\r\n\t\t * React is available to be used here instead of the customizer.Element abstraction.\r\n\t\t */\r\n\t\tready: function ready() {\r\n\t\t\t/**\r\n\t\t\t * Update component value's state when customizer setting's value is changed.\r\n\t\t\t */\r\n\t\t\tthis.setting?.bind((val: string | DevicesValue) => {\r\n\t\t\t\tthis.updateComponentState?.(val);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tupdateCustomizerSetting: function updateCustomizerSetting(val) {\r\n\t\t\tif (val === undefined) return;\r\n\t\t\tthis.setting?.set(val);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * This method will be overriden by the rendered component.\r\n\t\t */\r\n\t\tupdateComponentState: (val: string | DevicesValue) => {},\r\n\r\n\t\toverrideUpdateComponentStateFn: function overrideUpdateComponentStateFn(\r\n\t\t\tfn,\r\n\t\t) {\r\n\t\t\tthis.updateComponentState = fn;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Handle removal/de-registration of the control.\r\n\t\t *\r\n\t\t * This is essentially the inverse of the Control#embed() method.\r\n\t\t *\r\n\t\t * @link https://core.trac.wordpress.org/ticket/31334\r\n\t\t */\r\n\t\tdestroy: function destroy() {\r\n\t\t\tthis.root?.unmount();\r\n\t\t\tthis.root = undefined;\r\n\r\n\t\t\t// Call destroy method in parent if it exists (as of #31334).\r\n\t\t\tcustomizer.Control.prototype.destroy?.call(this);\r\n\t\t},\r\n\t});\r\n}\r\n","import { WpbfSortableControl } from \"./sortable-interface\";\nimport _ from \"lodash\";\n\ndeclare var wp: {\n\tcustomize: WpbfCustomize;\n};\n\nwp.customize.controlConstructor[\"wpbf-sortable\"] =\n\twp.customize.Control.extend<WpbfSortableControl>({\n\t\tready: function (this: WpbfSortableControl) {\n\t\t\tconst control = this;\n\n\t\t\t// Handle control removal - trigger destroy when control is removed.\n\t\t\tfunction handleOnRemoved(removedControl: WpbfSortableControl) {\n\t\t\t\tif (control === removedControl) {\n\t\t\t\t\tif (control.destroy) control.destroy();\n\t\t\t\t\tcontrol.container?.remove();\n\t\t\t\t\twp.customize.control.unbind(\"removed\", handleOnRemoved);\n\t\t\t\t}\n\t\t\t}\n\t\t\twp.customize.control.bind(\"removed\", handleOnRemoved);\n\n\t\t\t// Initialize sortable.\n\t\t\tthis.initSortable?.();\n\t\t},\n\n\t\t/**\n\t\t * Initialize the sortable functionality.\n\t\t * Extracted for reuse in reinitialize().\n\t\t */\n\t\tinitSortable: function (this: WpbfSortableControl): void {\n\t\t\tconst control = this;\n\n\t\t\tjQuery(control.container.find(\"ul.sortable\").first())\n\t\t\t\t.sortable({\n\t\t\t\t\t// Update value when we stop sorting.\n\t\t\t\t\tupdate: function () {\n\t\t\t\t\t\tif (control.setting) {\n\t\t\t\t\t\t\tcontrol.setting.set(control.getNewValues!());\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.disableSelection()\n\t\t\t\t.find(\"li\")\n\t\t\t\t.each(function () {\n\t\t\t\t\t// Enable/disable options when we click on the eye of Thundera.\n\t\t\t\t\tjQuery(this)\n\t\t\t\t\t\t.find(\"i.visibility\")\n\t\t\t\t\t\t.on(\"click\", function () {\n\t\t\t\t\t\t\tjQuery(this)\n\t\t\t\t\t\t\t\t.toggleClass(\"dashicons-visibility-faint\")\n\t\t\t\t\t\t\t\t.parents(\"li:eq(0)\")\n\t\t\t\t\t\t\t\t.toggleClass(\"invisible\");\n\t\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.on(\"click\", function () {\n\t\t\t\t\t// Update value on click.\n\t\t\t\t\tcontrol.setting?.set(control.getNewValues!());\n\t\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Re-initialize the control after being destroyed.\n\t\t */\n\t\treinitialize: function (this: WpbfSortableControl): void {\n\t\t\tthis.initSortable?.();\n\t\t},\n\n\t\tgetNewValues: function (this: WpbfSortableControl) {\n\t\t\tconst control = this;\n\t\t\tconst items = control.container.find(\"li\");\n\t\t\tconst newVal: any[] = [];\n\n\t\t\t_.each(items, function (item) {\n\t\t\t\tif (!item.classList.contains(\"invisible\")) {\n\t\t\t\t\tnewVal.push(item.dataset.value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn newVal;\n\t\t},\n\n\t\t/**\n\t\t * Handle removal/de-registration of the control.\n\t\t * Cleans up jQuery Sortable instance and event handlers.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tdestroy: function (this: WpbfSortableControl): void {\n\t\t\t// Destroy jQuery Sortable on the sortable list.\n\t\t\tconst $sortable = this.container?.find(\"ul.sortable\");\n\t\t\tif ($sortable?.data(\"ui-sortable\")) {\n\t\t\t\t$sortable.sortable(\"destroy\");\n\t\t\t}\n\n\t\t\t// Unbind all container events.\n\t\t\tthis.container?.off();\n\t\t},\n\t});\n","import { BuilderValue, WpbfBuilderControl } from \"./builder-interface\";\n\n(function () {\n\tif (!window.wp.customize) return;\n\n\twindow.wp.customize.controlConstructor[\"wpbf-builder\"] =\n\t\twindow.wp.customize.wpbfDynamicControl.extend<WpbfBuilderControl>({\n\t\t\tisSaving: false,\n\n\t\t\tform: undefined,\n\n\t\t\tdraggableData: undefined,\n\n\t\t\temptyWidgetItemMarkup:\n\t\t\t\t\"<div class='widget-item empty-widget-item'>&nbsp;</div>\",\n\n\t\t\tavailableWidgetsPanel: undefined,\n\n\t\t\tbuilderPanel: undefined,\n\n\t\t\tinitWpbfControl: function (\n\t\t\t\tthis: WpbfBuilderControl,\n\t\t\t\tcontrol?: WpbfBuilderControl,\n\t\t\t) {\n\t\t\t\tcontrol = control || this;\n\t\t\t\tif (!control) return;\n\n\t\t\t\t/**\n\t\t\t\t * Listen to customizer setting change event.\n\t\t\t\t * Update component state when customizer setting changed.\n\t\t\t\t */\n\t\t\t\tcontrol.setting?.bind((value: Record<string, any>) => {\n\t\t\t\t\tcontrol.updateComponentState?.(value);\n\t\t\t\t});\n\n\t\t\t\tcontrol.buildAvailableWidgetsPanel?.();\n\t\t\t\tcontrol.buildBuilderPanel?.();\n\t\t\t\tcontrol.initDraggable?.();\n\t\t\t\tcontrol.initDroppable?.();\n\n\t\t\t\t// Timeout to wait for the elements to be rendered.\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tcontrol.initSortable?.();\n\t\t\t\t}, 1);\n\t\t\t},\n\n\t\t\tisSortableEmpty: function (sortableEl) {\n\t\t\t\tconst children = this.findHtmlEls?.(sortableEl, \".widget-item\");\n\n\t\t\t\tif (!children || !children.length) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst child = children[i];\n\n\t\t\t\t\tif (child.classList.contains(\"empty-widget-item\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-placeholder\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-helper\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tisWidgetActive: function (widgetKey) {\n\t\t\t\tif (!this.params) return false;\n\t\t\t\treturn this.params.builder.activeWidgetKeys.includes(widgetKey);\n\t\t\t},\n\n\t\t\tfindWidgetByKey: function (widgetKey) {\n\t\t\t\tif (!this.params) return undefined;\n\n\t\t\t\tconst availableWidgets = this.params.builder.availableWidgets;\n\t\t\t\tif (!availableWidgets.length) return undefined;\n\n\t\t\t\tfor (const widget of availableWidgets) {\n\t\t\t\t\tif (widget.key === widgetKey) {\n\t\t\t\t\t\treturn widget;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t},\n\n\t\t\tbuildAvailableWidgetsPanel: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tif (!control.container) return;\n\n\t\t\t\tconst params = control.params;\n\t\t\t\tif (!params) return;\n\n\t\t\t\tconst availableWidgetsPanel = control.findHtmlEl?.(\n\t\t\t\t\tcontrol.container[0],\n\t\t\t\t\t\".available-widgets-panel\",\n\t\t\t\t);\n\n\t\t\t\tif (!availableWidgetsPanel) return;\n\n\t\t\t\tcontrol.availableWidgetsPanel = availableWidgetsPanel;\n\n\t\t\t\tjQuery(document.body).append('<div class=\"widget-drag-helper\"></div>');\n\n\t\t\t\tconst availableWidgets = params.builder.availableWidgets;\n\n\t\t\t\tconst $availableWidgetListEl = jQuery(\"<div></div>\")\n\t\t\t\t\t.addClass(\"builder-widgets available-widgets\")\n\t\t\t\t\t.appendTo(control.availableWidgetsPanel);\n\n\t\t\t\t// Build the available widgets list based on `availableWidgets`.\n\t\t\t\tavailableWidgets.forEach((widget) => {\n\t\t\t\t\tconst widgetKey = widget.key;\n\n\t\t\t\t\tconst $widgetItem = jQuery(\"<div></div>\");\n\n\t\t\t\t\t$widgetItem\n\t\t\t\t\t\t.addClass(\n\t\t\t\t\t\t\t`widget-item widget-item-${widgetKey} ${control.isWidgetActive?.(widgetKey) ? \"disabled\" : \"\"}`,\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.attr(\"data-widget-key\", widgetKey)\n\t\t\t\t\t\t.attr(\"draggable\", \"true\")\n\t\t\t\t\t\t.html(`<span class=\"widget-label\">${widget.label}</span>`)\n\t\t\t\t\t\t.on(\"click\", function (e) {\n\t\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widget);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.appendTo($availableWidgetListEl);\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tbuildBuilderPanel: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst params = control.params;\n\t\t\t\tif (!params) return;\n\n\t\t\t\tconst availableRows = params.builder.availableRows;\n\t\t\t\tconst availableWidgets = params.builder.availableWidgets;\n\t\t\t\tif (!availableRows || !availableWidgets) return;\n\n\t\t\t\tconst customizePreview = control.findHtmlEl?.(\"#customize-preview\");\n\t\t\t\tif (!customizePreview) return;\n\n\t\t\t\t// Create the panel.\n\t\t\t\tconst $builderPanel = jQuery(\"<div></div>\")\n\t\t\t\t\t.addClass(`wpbf-builder-panel ${params.id}-builder-panel`)\n\t\t\t\t\t.attr(\"data-wpbf-builder-panel\", params.id)\n\t\t\t\t\t.insertAfter(customizePreview);\n\n\t\t\t\tavailableRows.forEach((row) => {\n\t\t\t\t\t// Build the row.\n\t\t\t\t\tconst $row = jQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(`builder-row`)\n\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t.appendTo($builderPanel);\n\n\t\t\t\t\t// Build the inner row.\n\t\t\t\t\tconst $innerRow = jQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(`builder-inner-row`)\n\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\t// Build the row label (tooltip)\n\t\t\t\t\tjQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(\"row-label\")\n\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t.text(row.label)\n\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\t// Build the row setting button.\n\t\t\t\t\tjQuery(\"<button></button>\")\n\t\t\t\t\t\t.addClass(\"row-setting-button\")\n\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t.html('<i class=\"dashicons dashicons-admin-generic\"></i>')\n\t\t\t\t\t\t.on(\"click\", () => control.handleRowSettingClick?.(row.key))\n\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\tconst matchedRow = params.value[row.key];\n\n\t\t\t\t\trow.columns.forEach((column, columnIndex) => {\n\t\t\t\t\t\tlet columnPosClass = \"\";\n\n\t\t\t\t\t\tif (column.key.endsWith(\"_start\")) {\n\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-start\";\n\t\t\t\t\t\t} else if (column.key.endsWith(\"_end\")) {\n\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-end\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (columnIndex !== 0 && columnIndex !== row.columns.length - 1) {\n\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-center column-middle\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (columnIndex === 0) {\n\t\t\t\t\t\t\tcolumnPosClass += \" column-start wpbf-content-start\";\n\t\t\t\t\t\t} else if (columnIndex === row.columns.length - 1) {\n\t\t\t\t\t\t\tcolumnPosClass += \" column-end wpbf-content-end\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst $widgetListEl = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\n\t\t\t\t\t\t\t\t`builder-widgets builder-column sortable-widgets wpbf-flex ${columnPosClass}`,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr(\"data-column-key\", column.key)\n\t\t\t\t\t\t\t.appendTo($innerRow);\n\n\t\t\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\n\t\t\t\t\t\tif (!matchedRow || !Object.keys(matchedRow).length) {\n\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\n\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst matchedColumn = matchedRow[column.key];\n\n\t\t\t\t\t\tif (!matchedColumn || !matchedColumn.length) {\n\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\n\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Build the widget list based on `matchedColumn`.\n\t\t\t\t\t\tmatchedColumn.forEach((widgetKey) => {\n\t\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(widgetKey, true);\n\t\t\t\t\t\t\tif (!newWidgetItem) return;\n\n\t\t\t\t\t\t\t$widgetListEl.append(newWidgetItem);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tcontrol.bindCustomizeSection?.(row.key);\n\t\t\t\t});\n\n\t\t\t\tcontrol.builderPanel = $builderPanel[0];\n\t\t\t},\n\n\t\t\thandleRowSettingClick: function (rowKey) {\n\t\t\t\tconst controlId = this.params?.id;\n\t\t\t\tif (!controlId) return;\n\n\t\t\t\twindow.wp.customize?.section(\n\t\t\t\t\t`${controlId}_${rowKey}_section`,\n\t\t\t\t\tfunction (section) {\n\t\t\t\t\t\tsection.expand(section.params);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tbindCustomizeSection: function (rowKey) {\n\t\t\t\tconst controlId = this.params?.id;\n\t\t\t\tif (!controlId) return;\n\n\t\t\t\twindow.wp.customize?.section(\n\t\t\t\t\t`${controlId}_${rowKey}_section`,\n\t\t\t\t\tfunction (section) {\n\t\t\t\t\t\tsection.expanded.bind(function (expanded) {\n\t\t\t\t\t\t\tconst row = document.querySelector(\n\t\t\t\t\t\t\t\t`.builder-row[data-row-key=\"${rowKey}\"]`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (!row) return;\n\n\t\t\t\t\t\t\tif (expanded) {\n\t\t\t\t\t\t\t\trow.classList.add(\"is-active\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.classList.remove(\"is-active\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\n\t\t\thandleWidgetClick: function (widgetEl, widgetData) {\n\t\t\t\t// If this is from the available widgets panel.\n\t\t\t\tif (!widgetEl.classList.contains(\"ui-sortable-handle\")) {\n\t\t\t\t\tif (!widgetEl.classList.contains(\"disabled\")) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!widgetData.section) return;\n\n\t\t\t\tconst connectedSection = window.wp.customize?.section(\n\t\t\t\t\twidgetData.section,\n\t\t\t\t);\n\t\t\t\tif (!connectedSection || !connectedSection.params) return;\n\n\t\t\t\tconnectedSection.expand(connectedSection.params);\n\t\t\t},\n\n\t\t\tinitDraggable: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst params = control.params;\n\n\t\t\t\tif (!params) return;\n\t\t\t\tif (!control.availableWidgetsPanel || !control.builderPanel) return;\n\n\t\t\t\tconst dragHelper = control.findHtmlEl?.(\".widget-drag-helper\");\n\t\t\t\tif (!dragHelper) return;\n\n\t\t\t\tconst availableWidgetItems = control.findHtmlEls?.(\n\t\t\t\t\tcontrol.availableWidgetsPanel,\n\t\t\t\t\t\".widget-item\",\n\t\t\t\t);\n\n\t\t\t\tif (!availableWidgetItems || !availableWidgetItems.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tavailableWidgetItems.forEach((item) => {\n\t\t\t\t\tif (!(item instanceof HTMLElement)) return;\n\n\t\t\t\t\titem.addEventListener(\"dragstart\", function (e) {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\n\t\t\t\t\t\tdocument.body.classList.add(\"is-dragging-widget\");\n\t\t\t\t\t\titem.classList.add(\"is-dragging\");\n\t\t\t\t\t\tdragHelper.classList.add(\"is-shown\");\n\n\t\t\t\t\t\tconst widgetKey = item.dataset.widgetKey;\n\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Set the data to be transferred.\n\t\t\t\t\t\t * We use both e.dataTransfer and control.draggableData to store the data.\n\t\t\t\t\t\t * Because e.dataTransfer can't be accessed from \"dragenter\" and \"dragover\" event.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tcontrol.draggableData = { widgetKey };\n\t\t\t\t\t\te.dataTransfer?.setData(\"text\", JSON.stringify({ widgetKey }));\n\n\t\t\t\t\t\tdragHelper.innerHTML = item.outerHTML;\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * The visualDragHelper is a direct body child element with position: fixed, left: 0, and top: 0.\n\t\t\t\t\t\t * We need to set the position of the dragVisualHelper to be in the same position of current `item` (.wiget-item).\n\t\t\t\t\t\t * Meaning, we need to get the top and left position of the current event element and set the fixed position of the dragVisualHelper.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tconst draggedElRect = item.getBoundingClientRect();\n\t\t\t\t\t\tconst draggedElFixedLeftPos = draggedElRect.left;\n\t\t\t\t\t\tconst draggedElFixedTopPos = draggedElRect.top;\n\n\t\t\t\t\t\tdragHelper.style.left = draggedElFixedLeftPos + \"px\";\n\t\t\t\t\t\tdragHelper.style.top = draggedElFixedTopPos + \"px\";\n\n\t\t\t\t\t\tconst dragHelperInnerEl = control.findHtmlEl?.(\n\t\t\t\t\t\t\tdragHelper,\n\t\t\t\t\t\t\t\".widget-item\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst innerElRect = dragHelperInnerEl?.getBoundingClientRect();\n\t\t\t\t\t\tconst dragHelperInnerElWidth = innerElRect?.width || 80;\n\n\t\t\t\t\t\tdragHelper.style.width = dragHelperInnerElWidth + \"px\";\n\n\t\t\t\t\t\te.dataTransfer?.setDragImage(dragHelper, 0, 0);\n\n\t\t\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\n\t\t\t\t\t\t}, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\titem.addEventListener(\"dragend\", function (e) {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\titem.classList.remove(\"is-dragging\");\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-dragging-widget\");\n\n\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\n\t\t\t\t\t\tdragHelper.innerHTML = \"\";\n\t\t\t\t\t\tdragHelper.removeAttribute(\"style\");\n\n\t\t\t\t\t\tcontrol.draggableData = undefined;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tinitDroppable: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst params = control.params;\n\n\t\t\t\tif (!params) return;\n\t\t\t\tif (!control.availableWidgetsPanel || !control.builderPanel) return;\n\n\t\t\t\tconst builderDropZones = control.findHtmlEls?.(\n\t\t\t\t\tcontrol.builderPanel,\n\t\t\t\t\t\".builder-column\",\n\t\t\t\t);\n\n\t\t\t\tif (!builderDropZones || !builderDropZones.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbuilderDropZones.forEach((dropZone) => {\n\t\t\t\t\tdropZone.addEventListener(\"dragenter\", function (e) {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tdropZone.classList.add(\"dragover\");\n\t\t\t\t\t});\n\n\t\t\t\t\t// This empty block is necessary to let the dropZone accept the drop event.\n\t\t\t\t\tdropZone.addEventListener(\"dragover\", function (e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t});\n\n\t\t\t\t\tdropZone.addEventListener(\"dragleave\", function (e) {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\n\t\t\t\t\t});\n\n\t\t\t\t\tdropZone.addEventListener(\"drop\", function (e) {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\n\n\t\t\t\t\t\tconst widgetItem = control.getWidgetItemFromDraggableData?.(e);\n\t\t\t\t\t\tif (!widgetItem) return;\n\n\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\n\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(widgetKey, true);\n\t\t\t\t\t\tif (!newWidgetItem) return;\n\n\t\t\t\t\t\tconst temporaryWidgetItem = dropZone.querySelector(\n\t\t\t\t\t\t\t\".ui-sortable-placeholder.from-available-widgets\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (temporaryWidgetItem) {\n\t\t\t\t\t\t\tdropZone.removeChild(temporaryWidgetItem);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (dropZone.classList.contains(\"column-end\")) {\n\t\t\t\t\t\t\tdropZone.insertBefore(newWidgetItem, dropZone.firstChild);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdropZone.appendChild(newWidgetItem);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst emptyWidgetItem =\n\t\t\t\t\t\t\tdropZone.querySelector(\".empty-widget-item\");\n\n\t\t\t\t\t\tif (emptyWidgetItem) {\n\t\t\t\t\t\t\temptyWidgetItem.remove();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Now refresh the sortable.\n\t\t\t\t\t\tjQuery(dropZone).sortable(\"refresh\");\n\n\t\t\t\t\t\twidgetItem.classList.add(\"disabled\");\n\t\t\t\t\t\tcontrol.draggableData = undefined;\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tparseDraggableData: function (e) {\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\n\t\t\t\tif (!data) return undefined;\n\n\t\t\t\tlet parsedJson: undefined | Record<string, any> = undefined;\n\n\t\t\t\ttry {\n\t\t\t\t\tparsedJson = JSON.parse(data);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"Error parsing JSON data:\", e);\n\t\t\t\t}\n\n\t\t\t\tif (!parsedJson) return undefined;\n\n\t\t\t\treturn parsedJson;\n\t\t\t},\n\n\t\t\tgetWidgetItemFromDraggableData: function (e) {\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\n\t\t\t\tif (!data) return undefined;\n\t\t\t\tconst control = this;\n\n\t\t\t\tconst parsedJson = this.parseDraggableData?.(e);\n\t\t\t\tif (!parsedJson) return undefined;\n\n\t\t\t\tconst widgetKey = parsedJson.widgetKey;\n\t\t\t\tif (!widgetKey) return undefined;\n\n\t\t\t\tconst widgetItem = control.findHtmlEl?.(\n\t\t\t\t\tthis.availableWidgetsPanel,\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\n\t\t\t\t);\n\n\t\t\t\treturn widgetItem;\n\t\t\t},\n\n\t\t\tcreateWidgetItem: function (widgetKey, insideBuilderPanel) {\n\t\t\t\tconst control = this;\n\t\t\t\tconst widgetData = control.findWidgetByKey?.(widgetKey);\n\t\t\t\tif (!widgetData) return undefined;\n\n\t\t\t\tconst widgetItemToClone = control.findHtmlEl?.(\n\t\t\t\t\tcontrol.availableWidgetsPanel,\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\n\t\t\t\t);\n\n\t\t\t\tif (!widgetItemToClone) return undefined;\n\n\t\t\t\tconst newWidgetItem = widgetItemToClone.cloneNode(true);\n\t\t\t\tif (!(newWidgetItem instanceof HTMLElement)) return undefined;\n\n\t\t\t\tnewWidgetItem.classList.remove(\"disabled\");\n\t\t\t\tnewWidgetItem.classList.remove(\"is-dragging\");\n\t\t\t\tnewWidgetItem.removeAttribute(\"draggable\");\n\n\t\t\t\tif (insideBuilderPanel) {\n\t\t\t\t\tconst deleteButton = document.createElement(\"button\");\n\t\t\t\t\tdeleteButton.type = \"button\";\n\t\t\t\t\tdeleteButton.className = \"widget-button delete-widget-button\";\n\t\t\t\t\tdeleteButton.innerHTML = '<i class=\"dashicons dashicons-no-alt\"></i>';\n\t\t\t\t\tnewWidgetItem.appendChild(deleteButton);\n\n\t\t\t\t\tdeleteButton.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tcontrol.handleDeleteActiveWidget?.(\n\t\t\t\t\t\t\tnewWidgetItem,\n\t\t\t\t\t\t\twidgetItemToClone,\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tnewWidgetItem.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widgetData);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn newWidgetItem;\n\t\t\t},\n\n\t\t\tinitSortable: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst params = control.params;\n\n\t\t\t\tif (!params) return;\n\t\t\t\tif (!control.availableWidgetsPanel || !control.builderPanel) return;\n\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\t\t\t\tconst $builderPanel = jQuery(control.builderPanel);\n\n\t\t\t\t// Scope sortable to this specific builder panel only.\n\t\t\t\tconst $sortableWidgets = $builderPanel.find(\".sortable-widgets\");\n\t\t\t\tconst $builderColumns = $builderPanel.find(\".builder-column\");\n\n\t\t\t\t$sortableWidgets.sortable({\n\t\t\t\t\tconnectWith: $builderColumns,\n\t\t\t\t\tplaceholder: \"widget-item\",\n\t\t\t\t\tstart: function (e, ui) {\n\t\t\t\t\t\tdocument.body.classList.add(\"is-sorting-widget\");\n\n\t\t\t\t\t\tconst labelEl = control.findHtmlEl?.(ui.item[0], \".widget-label\");\n\n\t\t\t\t\t\tif (labelEl) {\n\t\t\t\t\t\t\tui.placeholder[0].appendChild(labelEl.cloneNode(true));\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tupdate: function (e, ui) {\n\t\t\t\t\t\tconst sortableEl = e.target;\n\t\t\t\t\t\tif (!(sortableEl instanceof HTMLElement)) return;\n\n\t\t\t\t\t\tcontrol.checkSortableContent?.(sortableEl);\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t\t\t},\n\t\t\t\t\tstop: function (e, ui) {\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-sorting-widget\");\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\t$builderPanel.find(\".builder-column.column-middle\").on(\n\t\t\t\t\t\"sortover\",\n\t\t\t\t\tfunction (e, ui) {\n\t\t\t\t\t\tconst target = e.target;\n\t\t\t\t\t\ttarget.classList.remove(emptyWidgetListClass);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\t$builderPanel\n\t\t\t\t\t.find(\".builder-column.column-middle\")\n\t\t\t\t\t.on(\"sortout\", function (e, ui) {\n\t\t\t\t\t\tcontrol.checkSortableContent?.(e.target);\n\t\t\t\t\t});\n\t\t\t},\n\n\t\t\thandleDeleteActiveWidget: function (activeWidgetEl, availableWidgetEl) {\n\t\t\t\tconst control = this;\n\n\t\t\t\tavailableWidgetEl?.classList.remove(\"disabled\");\n\n\t\t\t\tconst sortableEL = activeWidgetEl.closest(\".sortable-widgets\");\n\n\t\t\t\tactiveWidgetEl.remove();\n\n\t\t\t\tif (sortableEL instanceof HTMLElement) {\n\t\t\t\t\tcontrol.checkSortableContent?.(sortableEL);\n\t\t\t\t}\n\n\t\t\t\tif (sortableEL) {\n\t\t\t\t\tjQuery(sortableEL).sortable(\"refresh\");\n\t\t\t\t}\n\n\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t},\n\n\t\t\tcheckSortableContent: function (sortableEl) {\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\t\t\t\tconst emptyWidgetItemClass = \"empty-widget-item\";\n\n\t\t\t\tconst emptyWidgetItem = sortableEl.querySelector(\n\t\t\t\t\t\".\" + emptyWidgetItemClass,\n\t\t\t\t);\n\n\t\t\t\tif (this.isSortableEmpty?.(sortableEl)) {\n\t\t\t\t\tsortableEl.classList.add(emptyWidgetListClass);\n\n\t\t\t\t\tif (!emptyWidgetItem) {\n\t\t\t\t\t\tjQuery(sortableEl).append(this.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsortableEl.classList.remove(emptyWidgetListClass);\n\n\t\t\t\t\tif (emptyWidgetItem) {\n\t\t\t\t\t\temptyWidgetItem.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroySortable: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tif (!control.availableWidgetsPanel || !control.builderPanel) return;\n\n\t\t\t\tjQuery(\".builder-column\").sortable(\"destroy\");\n\t\t\t},\n\n\t\t\tupdateCustomizerSetting: function () {\n\t\t\t\tconst control = this;\n\n\t\t\t\tif (control.isSaving) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontrol.isSaving = true;\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tconst builderRows = control.findHtmlEls?.(\n\t\t\t\t\t\tcontrol.builderPanel,\n\t\t\t\t\t\t\".builder-row\",\n\t\t\t\t\t);\n\n\t\t\t\t\tif (!builderRows || !builderRows.length) {\n\t\t\t\t\t\tcontrol.isSaving = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst values: BuilderValue = {};\n\n\t\t\t\t\tbuilderRows.forEach((row) => {\n\t\t\t\t\t\tconst rowKey = row.dataset.rowKey;\n\t\t\t\t\t\tif (!rowKey) return;\n\n\t\t\t\t\t\tvalues[rowKey] = {};\n\n\t\t\t\t\t\tconst sortableColumns = control.findHtmlEls?.(\n\t\t\t\t\t\t\trow,\n\t\t\t\t\t\t\t\".builder-column.sortable-widgets\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!sortableColumns || !sortableColumns.length) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsortableColumns.forEach((column) => {\n\t\t\t\t\t\t\tconst columnKey = column.dataset.columnKey;\n\t\t\t\t\t\t\tif (!columnKey) return;\n\n\t\t\t\t\t\t\tvalues[rowKey][columnKey] = [];\n\n\t\t\t\t\t\t\tconst widgetItems = control.findHtmlEls?.(column, \".widget-item\");\n\n\t\t\t\t\t\t\tif (!widgetItems || !widgetItems.length) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\twidgetItems.forEach((widgetItem) => {\n\t\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"empty-widget-item\")) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"ui-sortable-placeholder\")) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\n\t\t\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\t\t\tvalues[rowKey][columnKey].push(widgetKey);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tcontrol.setting?.set(values);\n\t\t\t\t\tcontrol.isSaving = false;\n\t\t\t\t}, 1);\n\t\t\t},\n\n\t\t\tupdateComponentState: function (\n\t\t\t\tthis: WpbfBuilderControl,\n\t\t\t\tvalue: Record<string, any>,\n\t\t\t) {\n\t\t\t\t// Update available-widgets & sortable-widgets.\n\t\t\t},\n\t\t});\n})();\n","import {\n\tResponsiveBuilderValue,\n\tWpbfResponsiveBuilderControl,\n} from \"./builder-interface\";\n\n(function (customizer: WpbfCustomize | undefined) {\n\tconst allowedDevices = [\"desktop\", \"mobile\"];\n\n\tif (!customizer) return;\n\n\tcustomizer.controlConstructor[\"wpbf-responsive-builder\"] =\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfResponsiveBuilderControl>({\n\t\t\tisSaving: false,\n\n\t\t\tdraggableData: undefined,\n\n\t\t\temptyWidgetItemMarkup:\n\t\t\t\t\"<div class='widget-item empty-widget-item'>&nbsp;</div>\",\n\n\t\t\tavailableWidgetsPanels: {\n\t\t\t\tdesktop: undefined,\n\t\t\t\tmobile: undefined,\n\t\t\t},\n\n\t\t\tbuilderPanel: undefined,\n\n\t\t\tinitWpbfControl: function (ctrl) {\n\t\t\t\tconst control = ctrl ?? this;\n\t\t\t\tif (!control) return;\n\n\t\t\t\t/**\n\t\t\t\t * Listen to customizer setting change event.\n\t\t\t\t * Update component state when customizer setting changed.\n\t\t\t\t */\n\t\t\t\tcontrol.setting?.bind((value) => {\n\t\t\t\t\tcontrol.updateComponentState?.(value);\n\t\t\t\t});\n\n\t\t\t\tcontrol.buildAvailableWidgetsPanel?.();\n\t\t\t\tcontrol.buildBuilderPanel?.();\n\t\t\t\tcontrol.initDraggable?.();\n\t\t\t\tcontrol.initDroppable?.();\n\n\t\t\t\t// Timeout to wait for the elements to be rendered.\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tcontrol.initSortable?.();\n\t\t\t\t}, 1);\n\t\t\t},\n\n\t\t\tisSortableEmpty: function (sortableEl) {\n\t\t\t\tconst children = this.findHtmlEls?.(sortableEl, \".widget-item\");\n\n\t\t\t\tif (!children || !children.length) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst child = children[i];\n\n\t\t\t\t\tif (child.classList.contains(\"empty-widget-item\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-placeholder\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-helper\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tisWidgetActive: function (widgetKey, device) {\n\t\t\t\tif (\n\t\t\t\t\t!this.params ||\n\t\t\t\t\t!device ||\n\t\t\t\t\t(device !== \"desktop\" && device !== \"mobile\")\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst activeWidgetKeys = this.params.builder[device].activeWidgetKeys;\n\t\t\t\tif (!activeWidgetKeys.length) return false;\n\n\t\t\t\treturn activeWidgetKeys.includes(widgetKey);\n\t\t\t},\n\n\t\t\tfindWidgetByKey: function (widgetKey, device) {\n\t\t\t\tif (\n\t\t\t\t\t!this.params ||\n\t\t\t\t\t!device ||\n\t\t\t\t\t(device !== \"desktop\" && device !== \"mobile\")\n\t\t\t\t) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tconst availableWidgets = this.params.builder[device].availableWidgets;\n\t\t\t\tif (!availableWidgets.length) return undefined;\n\n\t\t\t\tfor (const widget of availableWidgets) {\n\t\t\t\t\tif (widget.key === widgetKey) {\n\t\t\t\t\t\treturn widget;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t},\n\n\t\t\tbuildAvailableWidgetsPanel: function () {\n\t\t\t\tif (!this.container) return;\n\n\t\t\t\tconst params = this.params;\n\t\t\t\tif (!params) return;\n\n\t\t\t\tconst controlForm = this.findHtmlEl?.(\n\t\t\t\t\tthis.container[0],\n\t\t\t\t\t\".wpbf-control-form\",\n\t\t\t\t);\n\n\t\t\t\tif (!controlForm) return;\n\n\t\t\t\tconst control = this;\n\n\t\t\t\tif (!this.availableWidgetsPanels) return;\n\n\t\t\t\tfor (const device in params.builder) {\n\t\t\t\t\tif (!params.builder.hasOwnProperty(device)) continue;\n\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") continue;\n\t\t\t\t\tif (!params.builder[device].availableWidgets.length) continue;\n\n\t\t\t\t\tconst $availableWidgetPanel = jQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(\"available-widgets-panel\")\n\t\t\t\t\t\t.attr(\"data-device\", device)\n\t\t\t\t\t\t.appendTo(controlForm);\n\n\t\t\t\t\tthis.availableWidgetsPanels[device] = $availableWidgetPanel[0];\n\n\t\t\t\t\tconst $availableWidgetListEl = jQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(\"builder-widgets available-widgets\")\n\t\t\t\t\t\t.appendTo(this.availableWidgetsPanels[device]);\n\n\t\t\t\t\tconst availableWidgets = params.builder[device].availableWidgets;\n\n\t\t\t\t\t// Build the available widgets list based on `availableWidgets`.\n\t\t\t\t\tavailableWidgets.forEach((widget) => {\n\t\t\t\t\t\tconst widgetKey = widget.key;\n\n\t\t\t\t\t\tjQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\n\t\t\t\t\t\t\t\t`widget-item widget-item-${widgetKey} ${control.isWidgetActive?.(widgetKey, device) ? \"disabled\" : \"\"}`,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.attr(\"data-widget-key\", widgetKey)\n\t\t\t\t\t\t\t.attr(\"draggable\", \"true\")\n\t\t\t\t\t\t\t.html(`<span class=\"widget-label\">${widget.label}</span>`)\n\t\t\t\t\t\t\t.on(\"click\", function (e) {\n\t\t\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widget);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.appendTo($availableWidgetListEl);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tjQuery(document.body).append('<div class=\"widget-drag-helper\"></div>');\n\t\t\t},\n\n\t\t\tbuildBuilderPanel: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst params = control.params;\n\t\t\t\tif (!params) return;\n\n\t\t\t\tconst customizePreview = control.findHtmlEl?.(\"#customize-preview\");\n\t\t\t\tif (!customizePreview) return;\n\n\t\t\t\t// Create the panel.\n\t\t\t\tconst $builderPanel = jQuery(\"<div></div>\")\n\t\t\t\t\t.addClass(`wpbf-builder-panel ${params.id}-builder-panel`)\n\t\t\t\t\t.attr(\"data-wpbf-builder-panel\", params.id)\n\t\t\t\t\t.insertAfter(customizePreview);\n\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\n\t\t\t\tfor (const device in params.builder) {\n\t\t\t\t\tif (!params.builder.hasOwnProperty(device)) continue;\n\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") continue;\n\t\t\t\t\tif (!params.builder[device].availableWidgets.length) continue;\n\n\t\t\t\t\tconst $builderSlotsEl = jQuery(\"<div></div>\")\n\t\t\t\t\t\t.addClass(\"wpbf-builder-slots\")\n\t\t\t\t\t\t.attr(\"data-device\", device)\n\t\t\t\t\t\t.appendTo($builderPanel);\n\n\t\t\t\t\tconst availableWidgets = params.builder[device].availableWidgets;\n\t\t\t\t\tif (!availableWidgets.length) return;\n\n\t\t\t\t\tlet $mobileBuilderRows: JQuery<HTMLElement> | undefined = undefined;\n\n\t\t\t\t\tif (params.builder[device].availableSlots.offcanvas) {\n\t\t\t\t\t\t$builderSlotsEl.addClass(`wpbf-flex wpbf-content-center`);\n\n\t\t\t\t\t\tconst $builderOffcanvas = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\"builder-offcanvas\")\n\t\t\t\t\t\t\t.appendTo($builderSlotsEl);\n\n\t\t\t\t\t\t// Check if this is a premium-locked offcanvas (desktop only when not premium).\n\t\t\t\t\t\tconst isLockedOffcanvas =\n\t\t\t\t\t\t\tdevice === \"desktop\" && !params.isPremium;\n\n\t\t\t\t\t\tif (isLockedOffcanvas) {\n\t\t\t\t\t\t\t$builderOffcanvas.addClass(\"wpbf-premium-locked\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst $builderInnerOffcanvas = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\"builder-inner-offcanvas sortable-group\")\n\t\t\t\t\t\t\t.appendTo($builderOffcanvas);\n\n\t\t\t\t\t\t// Build the row setting button.\n\t\t\t\t\t\tjQuery(\"<button></button>\")\n\t\t\t\t\t\t\t.attr(\"type\", \"button\")\n\t\t\t\t\t\t\t.addClass(\"row-setting-button\")\n\t\t\t\t\t\t\t.html(\n\t\t\t\t\t\t\t\t`<i class=\"dashicons dashicons-admin-generic\"></i><span class=\"button-label\">${params.builder[device].availableSlots.offcanvas.label}</span>`,\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.on(\"click\", () =>\n\t\t\t\t\t\t\t\tcontrol.handleRowSettingClick?.(\n\t\t\t\t\t\t\t\t\tparams.builder[device].availableSlots.offcanvas.key,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.appendTo($builderInnerOffcanvas);\n\n\t\t\t\t\t\tconst $offcanvasWidgetsEl = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\"builder-widgets active-widgets dotted-border\")\n\t\t\t\t\t\t\t.appendTo($builderInnerOffcanvas);\n\n\t\t\t\t\t\t// Add premium overlay for locked desktop offcanvas.\n\t\t\t\t\t\tif (isLockedOffcanvas) {\n\t\t\t\t\t\t\t$offcanvasWidgetsEl.addClass(\"wpbf-premium-locked-dropzone\");\n\n\t\t\t\t\t\t\tjQuery(\"<div></div>\")\n\t\t\t\t\t\t\t\t.addClass(\"wpbf-premium-overlay\")\n\t\t\t\t\t\t\t\t.html(\n\t\t\t\t\t\t\t\t\t`<div class=\"wpbf-premium-overlay-content\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"dashicons dashicons-lock\"></span>\n\t\t\t\t\t\t\t\t\t\t<p>Premium Feature</p>\n\t\t\t\t\t\t\t\t\t</div>`,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.appendTo($offcanvasWidgetsEl);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (params.value && !isLockedOffcanvas) {\n\t\t\t\t\t\t\t// Build the widget list based on `params.value`.\n\t\t\t\t\t\t\tparams.value[device].offcanvas?.forEach((widgetKey) => {\n\t\t\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\n\t\t\t\t\t\t\t\t\twidgetKey,\n\t\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t\tdevice,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (!newWidgetItem) return;\n\n\t\t\t\t\t\t\t\t$offcanvasWidgetsEl.append(newWidgetItem);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$mobileBuilderRows = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\"builder-rows\")\n\t\t\t\t\t\t\t.appendTo($builderSlotsEl);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst availableSlots = params.builder[device].availableSlots;\n\t\t\t\t\tif (!availableSlots.rows.length) continue;\n\n\t\t\t\t\tconst $rowsWrapper = $mobileBuilderRows\n\t\t\t\t\t\t? $mobileBuilderRows\n\t\t\t\t\t\t: $builderSlotsEl;\n\n\t\t\t\t\tavailableSlots.rows.forEach((row) => {\n\t\t\t\t\t\t// Build the row.\n\t\t\t\t\t\tconst $row = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(`builder-row sortable-group`)\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t\t.appendTo($rowsWrapper);\n\n\t\t\t\t\t\t// Build the inner row.\n\t\t\t\t\t\tconst $innerRow = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(`builder-inner-row dotted-border`)\n\t\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\t\t// Build the row label (tooltip)\n\t\t\t\t\t\tjQuery(\"<div></div>\")\n\t\t\t\t\t\t\t.addClass(\"row-label\")\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t\t.text(row.label)\n\t\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\t\t// Build the row setting button.\n\t\t\t\t\t\tjQuery(\"<button></button>\")\n\t\t\t\t\t\t\t.addClass(\"row-setting-button\")\n\t\t\t\t\t\t\t.attr(\"type\", \"button\")\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\n\t\t\t\t\t\t\t.html('<i class=\"dashicons dashicons-admin-generic\"></i>')\n\t\t\t\t\t\t\t.on(\"click\", () => control.handleRowSettingClick?.(row.key))\n\t\t\t\t\t\t\t.appendTo($row);\n\n\t\t\t\t\t\tconst matchedRow = params.value\n\t\t\t\t\t\t\t? params.value[device].rows[row.key]\n\t\t\t\t\t\t\t: undefined;\n\n\t\t\t\t\t\trow.columns.forEach((column, columnIndex) => {\n\t\t\t\t\t\t\tlet columnPosClass = \"\";\n\n\t\t\t\t\t\t\tif (column.key.endsWith(\"_start\")) {\n\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-start\";\n\t\t\t\t\t\t\t} else if (column.key.endsWith(\"_end\")) {\n\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-end\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tcolumnIndex !== 0 &&\n\t\t\t\t\t\t\t\t\tcolumnIndex !== row.columns.length - 1\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-center column-middle\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (columnIndex === 0) {\n\t\t\t\t\t\t\t\tcolumnPosClass += \" column-start wpbf-content-start\";\n\t\t\t\t\t\t\t} else if (columnIndex === row.columns.length - 1) {\n\t\t\t\t\t\t\t\tcolumnPosClass += \" column-end wpbf-content-end\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst $widgetListEl = jQuery(\"<div></div>\")\n\t\t\t\t\t\t\t\t.addClass(\n\t\t\t\t\t\t\t\t\t`builder-column builder-widgets active-widgets wpbf-flex ${columnPosClass}`,\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t.attr(\"data-column-key\", column.key)\n\t\t\t\t\t\t\t\t.appendTo($innerRow);\n\n\t\t\t\t\t\t\tif (!matchedRow || !Object.keys(matchedRow).length) {\n\t\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\n\t\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst matchedColumn = matchedRow[column.key];\n\n\t\t\t\t\t\t\tif (!matchedColumn || !matchedColumn.length) {\n\t\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\n\t\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Build the widget list based on `matchedColumn`.\n\t\t\t\t\t\t\tmatchedColumn.forEach((widgetKey) => {\n\t\t\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\n\t\t\t\t\t\t\t\t\twidgetKey,\n\t\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\t\tdevice,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (!newWidgetItem) return;\n\n\t\t\t\t\t\t\t\t$widgetListEl.append(newWidgetItem);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tcontrol.bindCustomizeSection?.(row.key);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcontrol.builderPanel = $builderPanel[0];\n\t\t\t},\n\n\t\t\thandleRowSettingClick: function (rowKey) {\n\t\t\t\tconst controlId = this.params?.id;\n\t\t\t\tif (!controlId) return;\n\n\t\t\t\tcustomizer?.section(\n\t\t\t\t\t`${controlId}_${rowKey}_section`,\n\t\t\t\t\tfunction (section) {\n\t\t\t\t\t\tsection.expand(section.params);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\n\t\t\tbindCustomizeSection: function (rowKey) {\n\t\t\t\tconst controlId = this.params?.id;\n\t\t\t\tif (!controlId) return;\n\n\t\t\t\tcustomizer?.section(\n\t\t\t\t\t`${controlId}_${rowKey}_section`,\n\t\t\t\t\tfunction (section) {\n\t\t\t\t\t\tsection.expanded.bind(function (expanded) {\n\t\t\t\t\t\t\tconst row = document.querySelector(\n\t\t\t\t\t\t\t\t`.builder-row[data-row-key=\"${rowKey}\"]`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (!row) return;\n\n\t\t\t\t\t\t\tif (expanded) {\n\t\t\t\t\t\t\t\trow.classList.add(\"is-active\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.classList.remove(\"is-active\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\n\t\t\thandleWidgetClick: function (widgetEl, widgetData) {\n\t\t\t\t// If this is from the available widgets panel.\n\t\t\t\tif (!widgetEl.classList.contains(\"ui-sortable-handle\")) {\n\t\t\t\t\tif (!widgetEl.classList.contains(\"disabled\")) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!widgetData.section) return;\n\n\t\t\t\tconst connectedSection = customizer?.section(widgetData.section);\n\t\t\t\tif (!connectedSection || !connectedSection.params) return;\n\n\t\t\t\tconnectedSection.expand(connectedSection.params);\n\t\t\t},\n\n\t\t\tinitDraggable: function () {\n\t\t\t\tif (!this.params || !this.container || !this.builderPanel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst dragHelper = this.findHtmlEl?.(\".widget-drag-helper\");\n\t\t\t\tif (!dragHelper) return;\n\n\t\t\t\tconst availableWidgetItems = this.findHtmlEls?.(\n\t\t\t\t\tthis.container[0],\n\t\t\t\t\t\".widget-item\",\n\t\t\t\t);\n\n\t\t\t\tif (!availableWidgetItems || !availableWidgetItems.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst control = this;\n\n\t\t\t\tavailableWidgetItems.forEach((item) => {\n\t\t\t\t\tif (!(item instanceof HTMLElement)) return;\n\n\t\t\t\t\titem.addEventListener(\"dragstart\", (e) => {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\n\t\t\t\t\t\tdocument.body.classList.add(\"is-dragging-widget\");\n\t\t\t\t\t\titem.classList.add(\"is-dragging\");\n\t\t\t\t\t\tdragHelper.classList.add(\"is-shown\");\n\n\t\t\t\t\t\tconst widgetKey = item.dataset.widgetKey;\n\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Set the data to be transferred.\n\t\t\t\t\t\t * We use both e.dataTransfer and control.draggableData to store the data.\n\t\t\t\t\t\t * Because e.dataTransfer can't be accessed from \"dragenter\" and \"dragover\" event.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tcontrol.draggableData = { widgetKey };\n\t\t\t\t\t\te.dataTransfer?.setData(\"text\", JSON.stringify({ widgetKey }));\n\n\t\t\t\t\t\tdragHelper.innerHTML = item.outerHTML;\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * The visualDragHelper is a direct body child element with position: fixed, left: 0, and top: 0.\n\t\t\t\t\t\t * We need to set the position of the dragVisualHelper to be in the same position of current `item` (.wiget-item).\n\t\t\t\t\t\t * Meaning, we need to get the top and left position of the current event element and set the fixed position of the dragVisualHelper.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tconst draggedElRect = item.getBoundingClientRect();\n\t\t\t\t\t\tconst draggedElFixedLeftPos = draggedElRect.left;\n\t\t\t\t\t\tconst draggedElFixedTopPos = draggedElRect.top;\n\n\t\t\t\t\t\tdragHelper.style.left = draggedElFixedLeftPos + \"px\";\n\t\t\t\t\t\tdragHelper.style.top = draggedElFixedTopPos + \"px\";\n\n\t\t\t\t\t\tconst dragHelperInnerEl = control.findHtmlEl?.(\n\t\t\t\t\t\t\tdragHelper,\n\t\t\t\t\t\t\t\".widget-item\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst innerElRect = dragHelperInnerEl?.getBoundingClientRect();\n\t\t\t\t\t\tconst dragHelperInnerElWidth = innerElRect?.width || 80;\n\n\t\t\t\t\t\tdragHelper.style.width = dragHelperInnerElWidth + \"px\";\n\n\t\t\t\t\t\te.dataTransfer?.setDragImage(dragHelper, 0, 0);\n\n\t\t\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\n\t\t\t\t\t\t}, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\titem.addEventListener(\"dragend\", (e) => {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\titem.classList.remove(\"is-dragging\");\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-dragging-widget\");\n\n\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\n\t\t\t\t\t\tdragHelper.innerHTML = \"\";\n\t\t\t\t\t\tdragHelper.removeAttribute(\"style\");\n\n\t\t\t\t\t\tcontrol.draggableData = undefined;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tinitDroppable: function () {\n\t\t\t\tif (!this.builderPanel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst builderDropZones = this.findHtmlEls?.(\n\t\t\t\t\tthis.builderPanel,\n\t\t\t\t\t\".active-widgets\",\n\t\t\t\t);\n\n\t\t\t\tif (!builderDropZones || !builderDropZones.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst control = this;\n\n\t\t\t\tbuilderDropZones.forEach((dropZone) => {\n\t\t\t\t\t// Skip premium-locked dropzones.\n\t\t\t\t\tconst isLockedDropzone =\n\t\t\t\t\t\tdropZone.classList.contains(\"wpbf-premium-locked-dropzone\");\n\n\t\t\t\t\tdropZone.addEventListener(\"dragenter\", (e) => {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t// Don't show dragover state for locked dropzones.\n\t\t\t\t\t\tif (isLockedDropzone) return;\n\n\t\t\t\t\t\tdropZone.classList.add(\"dragover\");\n\t\t\t\t\t});\n\n\t\t\t\t\t// This empty block is necessary to let the dropZone accept the drop event.\n\t\t\t\t\tdropZone.addEventListener(\"dragover\", (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t});\n\n\t\t\t\t\tdropZone.addEventListener(\"dragleave\", (e) => {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\n\t\t\t\t\t});\n\n\t\t\t\t\tdropZone.addEventListener(\"drop\", (e) => {\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\n\n\t\t\t\t\t\t// Block drops on premium-locked dropzones.\n\t\t\t\t\t\tif (isLockedDropzone) return;\n\n\t\t\t\t\t\tconst widgetItem = control.getWidgetItemFromDraggableData?.(e);\n\t\t\t\t\t\tif (!widgetItem) return;\n\n\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\n\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\tconst area = dropZone.closest(\".wpbf-builder-slots\");\n\t\t\t\t\t\tif (!(area instanceof HTMLElement)) return;\n\n\t\t\t\t\t\tconst device = area.dataset.device;\n\n\t\t\t\t\t\tif (!device || (device !== \"desktop\" && device !== \"mobile\")) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\n\t\t\t\t\t\t\twidgetKey,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tdevice,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!newWidgetItem) return;\n\n\t\t\t\t\t\tconst temporaryWidgetItem = dropZone.querySelector(\n\t\t\t\t\t\t\t\".ui-sortable-placeholder.from-available-widgets\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (temporaryWidgetItem) {\n\t\t\t\t\t\t\tdropZone.removeChild(temporaryWidgetItem);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (dropZone.classList.contains(\"column-end\")) {\n\t\t\t\t\t\t\tdropZone.insertBefore(newWidgetItem, dropZone.firstChild);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdropZone.appendChild(newWidgetItem);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst emptyWidgetItem =\n\t\t\t\t\t\t\tdropZone.querySelector(\".empty-widget-item\");\n\n\t\t\t\t\t\tif (emptyWidgetItem) {\n\t\t\t\t\t\t\temptyWidgetItem.remove();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Now refresh the sortable.\n\t\t\t\t\t\tjQuery(dropZone).sortable(\"refresh\");\n\n\t\t\t\t\t\twidgetItem.classList.add(\"disabled\");\n\t\t\t\t\t\tcontrol.draggableData = undefined;\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tparseDraggableData: function (e) {\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\n\t\t\t\tif (!data) return undefined;\n\n\t\t\t\tlet parsedJson: undefined | Record<string, any> = undefined;\n\n\t\t\t\ttry {\n\t\t\t\t\tparsedJson = JSON.parse(data);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"Error parsing JSON data:\", e);\n\t\t\t\t}\n\n\t\t\t\tif (!parsedJson) return undefined;\n\n\t\t\t\treturn parsedJson;\n\t\t\t},\n\n\t\t\tgetWidgetItemFromDraggableData: function (e) {\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\n\t\t\t\tif (!data) return undefined;\n\t\t\t\tif (!this.container) return undefined;\n\n\t\t\t\tconst parsedJson = this.parseDraggableData?.(e);\n\t\t\t\tif (!parsedJson) return undefined;\n\n\t\t\t\tconst widgetKey = parsedJson.widgetKey;\n\t\t\t\tif (!widgetKey) return undefined;\n\n\t\t\t\tconst widgetItem = this.findHtmlEl?.(\n\t\t\t\t\tthis.container[0],\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\n\t\t\t\t);\n\n\t\t\t\treturn widgetItem;\n\t\t\t},\n\n\t\t\tcreateWidgetItem: function (widgetKey, insideBuilderPanel, device) {\n\t\t\t\tif (!this.container) return undefined;\n\n\t\t\t\tconst widgetData = this.findWidgetByKey?.(widgetKey, device);\n\t\t\t\tif (!widgetData) return undefined;\n\n\t\t\t\tconst control = this;\n\n\t\t\t\tconst widgetItemToClone = this.findHtmlEl?.(\n\t\t\t\t\tthis.container[0],\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\n\t\t\t\t);\n\n\t\t\t\tif (!widgetItemToClone) return undefined;\n\n\t\t\t\tconst newWidgetItem = widgetItemToClone.cloneNode(true);\n\t\t\t\tif (!(newWidgetItem instanceof HTMLElement)) return undefined;\n\n\t\t\t\tnewWidgetItem.classList.remove(\"disabled\");\n\t\t\t\tnewWidgetItem.classList.remove(\"is-dragging\");\n\t\t\t\tnewWidgetItem.removeAttribute(\"draggable\");\n\n\t\t\t\tif (insideBuilderPanel) {\n\t\t\t\t\tconst deleteButton = document.createElement(\"button\");\n\t\t\t\t\tdeleteButton.type = \"button\";\n\t\t\t\t\tdeleteButton.className = \"widget-button delete-widget-button\";\n\t\t\t\t\tdeleteButton.innerHTML = '<i class=\"dashicons dashicons-no-alt\"></i>';\n\t\t\t\t\tnewWidgetItem.appendChild(deleteButton);\n\n\t\t\t\t\tdeleteButton.addEventListener(\"click\", (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tcontrol.handleDeleteActiveWidget?.(\n\t\t\t\t\t\t\tnewWidgetItem,\n\t\t\t\t\t\t\twidgetItemToClone,\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\tnewWidgetItem.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widgetData);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn newWidgetItem;\n\t\t\t},\n\n\t\t\tinitSortable: function () {\n\t\t\t\tconst control = this;\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\n\t\t\t\tif (!this.builderPanel) return;\n\t\t\t\tconst $builderPanel = jQuery(this.builderPanel);\n\n\t\t\t\t// Scope sortable to this specific builder panel only.\n\t\t\t\tconst $activeWidgets = $builderPanel.find(\n\t\t\t\t\t\".active-widgets:not(.wpbf-premium-locked-dropzone)\",\n\t\t\t\t);\n\n\t\t\t\t$activeWidgets.sortable({\n\t\t\t\t\tconnectWith: $activeWidgets,\n\t\t\t\t\tplaceholder: \"widget-item\",\n\t\t\t\t\tstart: function (e, ui) {\n\t\t\t\t\t\tdocument.body.classList.add(\"is-sorting-widget\");\n\n\t\t\t\t\t\tconst labelEl = control.findHtmlEl?.(ui.item[0], \".widget-label\");\n\n\t\t\t\t\t\tif (labelEl) {\n\t\t\t\t\t\t\tui.placeholder[0].appendChild(labelEl.cloneNode(true));\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tupdate: function (e, ui) {\n\t\t\t\t\t\tconst sortableEl = e.target;\n\t\t\t\t\t\tif (!(sortableEl instanceof HTMLElement)) return;\n\n\t\t\t\t\t\tcontrol.checkSortableContent?.(sortableEl);\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t\t\t},\n\t\t\t\t\tstop: function (e, ui) {\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-sorting-widget\");\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\t$builderPanel.find(\".builder-column.column-middle\").on(\n\t\t\t\t\t\"sortover\",\n\t\t\t\t\tfunction (e, ui) {\n\t\t\t\t\t\tconst target = e.target;\n\t\t\t\t\t\ttarget.classList.remove(emptyWidgetListClass);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\t$builderPanel\n\t\t\t\t\t.find(\".builder-column.column-middle\")\n\t\t\t\t\t.on(\"sortout\", function (e, ui) {\n\t\t\t\t\t\tcontrol.checkSortableContent?.(e.target);\n\t\t\t\t\t});\n\t\t\t},\n\n\t\t\thandleDeleteActiveWidget: function (activeWidgetEl, availableWidgetEl) {\n\t\t\t\tconst control = this;\n\n\t\t\t\tavailableWidgetEl?.classList.remove(\"disabled\");\n\n\t\t\t\tconst sortableEL = activeWidgetEl.closest(\".active-widgets\");\n\n\t\t\t\tactiveWidgetEl.remove();\n\n\t\t\t\tif (sortableEL instanceof HTMLElement) {\n\t\t\t\t\tcontrol.checkSortableContent?.(sortableEL);\n\t\t\t\t}\n\n\t\t\t\tif (sortableEL) {\n\t\t\t\t\tjQuery(sortableEL).sortable(\"refresh\");\n\t\t\t\t}\n\n\t\t\t\tcontrol.updateCustomizerSetting?.();\n\t\t\t},\n\n\t\t\tcheckSortableContent: function (sortableEl) {\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\n\t\t\t\tconst emptyWidgetItemClass = \"empty-widget-item\";\n\n\t\t\t\tconst emptyWidgetItem = sortableEl.querySelector(\n\t\t\t\t\t\".\" + emptyWidgetItemClass,\n\t\t\t\t);\n\n\t\t\t\tif (this.isSortableEmpty?.(sortableEl)) {\n\t\t\t\t\tsortableEl.classList.add(emptyWidgetListClass);\n\n\t\t\t\t\tif (!emptyWidgetItem) {\n\t\t\t\t\t\tjQuery(sortableEl).append(this.emptyWidgetItemMarkup ?? \"\");\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsortableEl.classList.remove(emptyWidgetListClass);\n\n\t\t\t\t\tif (emptyWidgetItem) {\n\t\t\t\t\t\temptyWidgetItem.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tdestroySortable: function () {\n\t\t\t\tif (!this.builderPanel) return;\n\t\t\t\tjQuery(\".wpbf-builder-panel .active-widgets\").sortable(\"destroy\");\n\t\t\t},\n\n\t\t\tupdateCustomizerSetting: function () {\n\t\t\t\tif (this.isSaving) return;\n\t\t\t\tthis.isSaving = true;\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (!this.availableWidgetsPanels) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newValue: ResponsiveBuilderValue = {\n\t\t\t\t\t\tdesktop: { offcanvas: [], rows: {} },\n\t\t\t\t\t\tmobile: { offcanvas: [], rows: {} },\n\t\t\t\t\t};\n\n\t\t\t\t\tfor (const device of allowedDevices) {\n\t\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deviceBuilderPanel = this.findHtmlEl?.(\n\t\t\t\t\t\t\tthis.builderPanel,\n\t\t\t\t\t\t\t`.wpbf-builder-slots[data-device=\"${device}\"]`,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!deviceBuilderPanel) return;\n\n\t\t\t\t\t\tconst sortableEl = this.findHtmlEl?.(\n\t\t\t\t\t\t\tdeviceBuilderPanel,\n\t\t\t\t\t\t\t\".builder-offcanvas .active-widgets\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst widgetItems = this.findHtmlEls?.(sortableEl, \".widget-item\");\n\n\t\t\t\t\t\twidgetItems?.forEach((widgetItem) => {\n\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"empty-widget-item\")) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"ui-sortable-placeholder\")) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\n\t\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\t\tif (!newValue[device].offcanvas) {\n\t\t\t\t\t\t\t\tnewValue[device].offcanvas = [];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnewValue[device].offcanvas.push(widgetKey);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst builderRows = this.findHtmlEls?.(\n\t\t\t\t\t\t\tdeviceBuilderPanel,\n\t\t\t\t\t\t\t\".builder-row\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (!builderRows || !builderRows.length) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbuilderRows.forEach((row) => {\n\t\t\t\t\t\t\tconst rowKey = row.dataset.rowKey;\n\t\t\t\t\t\t\tif (!rowKey) return;\n\n\t\t\t\t\t\t\tconst sortableColumns = this.findHtmlEls?.(\n\t\t\t\t\t\t\t\trow,\n\t\t\t\t\t\t\t\t\".active-widgets\",\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (!sortableColumns || !sortableColumns.length) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnewValue[device].rows[rowKey] = {};\n\n\t\t\t\t\t\t\tsortableColumns.forEach((column) => {\n\t\t\t\t\t\t\t\tconst columnKey = column.dataset.columnKey;\n\t\t\t\t\t\t\t\tif (!columnKey) return;\n\n\t\t\t\t\t\t\t\tnewValue[device].rows[rowKey][columnKey] = [];\n\n\t\t\t\t\t\t\t\tconst widgetItems = this.findHtmlEls?.(column, \".widget-item\");\n\n\t\t\t\t\t\t\t\tif (!widgetItems || !widgetItems.length) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twidgetItems.forEach((widgetItem) => {\n\t\t\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"empty-widget-item\")) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\twidgetItem.classList.contains(\"ui-sortable-placeholder\")\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\n\t\t\t\t\t\t\t\t\tif (!widgetKey) return;\n\n\t\t\t\t\t\t\t\t\tnewValue[device].rows[rowKey][columnKey].push(widgetKey);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setting?.set(newValue);\n\t\t\t\t\tthis.isSaving = false;\n\t\t\t\t}, 1);\n\t\t\t},\n\n\t\t\t// Update available-widgets & active-widgets.\n\t\t\tupdateComponentState: function (value) {},\n\t\t});\n})(window.wp.customize);\n"],"names":["isRuleSatisfied","actualValue","operator","expectedValue","trim","toLowerCase","compareInOperator","Array","isArray","expectedValueArray","found","actualValueArray","i","length","includes","_","isObject","actualValueObj","isUndefined","prop","hasOwnProperty","indexOf","wpbfInjectTooltip","control","each","wpbfCustomizerTooltips","tooltip","id","container","find","target","document","querySelector","classList","add","trigger","createElement","innerHTML","content","appendChild","customizer","forEachEl","selector","handler","NodeList","elms","querySelectorAll","elm","HTMLElement","switchPreviewButtons","device","el","HTMLButtonElement","dataset","wpbfDevice","remove","wpbfSetting","label","HTMLLabelElement","htmlFor","window","wp","customize","wpbfDynamicControl","Control","extend","initialize","params","this","type","className","splits","split","$content","jQuery","attr","replace","wrapperAttrs","val","key","propertyElements","prototype","call","hooks","doAction","_setUpSettingRootLinks","node","settingKey","customizeSettingLink","setting","element","Element","elements","push","sync","set","_setUpSettingPropertyLinks","nodes","propertyName","data","bind","newPropertyValue","newSetting","clone","newValue","get","ready","deferred","embedded","done","initWpbfControl","embed","sectionId","section","expanded","settings","autofocus","actuallyEmbed","isEmbedded","wasEmbedded","reinitialize","renderContent","resolve","focus","args","ctrl","on","value","destroy","off","updateCustomizerSetting","findHtmlEl","elOrSelector","result","findHtmlEls","from","filter","sectionNames","tooltipStyleTag","sidebarOverlay","head","forEach","sectionName","contentContainer","scrollHeight","clientHeight","wpbfSetupTooltips","wpbfCustomizerControlDependencies","globalControlDependencies","reversedControlDependencies","dependantControlId","controlDependencies","dependency","dependencySettingId","listenDependencyControl","rules","handleRulesCondition","ruleSet","hideControl","dependantDependencies","showControl","otherRulesSatisfied","dependantDependency","dependantDependencySettingId","controlId","wpbfParentTabId","contains","removeClass","addClass","onChangeActive","completeCallback","hasClass","setupControlDependencies","Value","to","_value","_setter","apply","arguments","validate","isEqual","_dirty","callbacks","fireWith","previewedDevice","e","controlConstructor","is","currentValue","values","field","HTMLInputElement","updateComponentState","checked","r","grad","turn","rad","Math","PI","t","n","pow","round","u","isFinite","a","g","b","o","s","toString","h","max","min","v","floor","l","d","f","c","p","m","y","string","exec","parseInt","substr","Number","object","N","M","H","$","j","parsed","x","rgba","isValid","brightness","isDark","isLight","toHex","toRgb","toRgbString","toHsl","toHslString","toHsv","invert","w","saturate","desaturate","grayscale","lighten","darken","rotate","hue","alpha","ColorPickerSwatches","props","colors","onClick","jsx","children","map","clr","index","color","style","backgroundColor","normalizeMaxValue","isNumeric","char","isNaN","parseFloat","improperNumeric","limitNumber","parsedValue","makeNumberUnitPair","number","unit","strValue","String","negativeSign","unitMatch","match","getUnit","numeric","hasTrailingDot","endsWith","hasTrailingDotBeforeUnit","makeLimitedNumberUnitPair","valueObject","limitNumberWithUnit","numberAndUnit","limitedNumber","colorBgImgData","parseHueModeValue","hueValue","colord","hexColorFromHueModeValue","ColorPickerInput","onChange","pickerComponent","useHueMode","setValue","useState","useEffect","handleInputChange","useCallback","pattern","RegExp","test","previewWrapperBgImg","jsxs","backgroundImage","spellCheck","useFocusOutside","ref","listener","current","addEventListener","removeEventListener","useClickOutside","pickerRef","resetRef","startedWhenMounted","startedInside","event","validateEventStart","Object","assign","keys","ownerDocument","defaultView","self","getBoundingClientRect","identifier","touches","left","pageX","pageXOffset","width","top","pageY","pageYOffset","height","preventDefault","memo","onMove","onKey","buttons","nativeEvent","changedTouches","which","keyCode","C","E","onTouchStart","onMouseDown","onKeyDown","tabIndex","role","Boolean","join","substring","q","k","I","O","A","z","L","B","D","K","S","T","hsva","F","P","Y","toHsva","equal","fromHsva","V","J","Map","Q","has","__webpack_nonce__","setAttribute","U","colorModel","defaultColor","W","Z","ee","re","oe","ae","le","ue","ce","ie","se","fe","ve","de","he","me","ge","pe","be","_e","xe","Ce","Ee","He","Me","Ne","we","ye","ColorPickerComponent","HexColorPicker","RgbColorPicker","RgbStringColorPicker","RgbaColorPicker","RgbaStringColorPicker","HslColorPicker","HslStringColorPicker","HslaColorPicker","HslaStringColorPicker","HsvColorPicker","HsvStringColorPicker","HsvaColorPicker","HsvaStringColorPicker","ColorPickerCirleTrigger","isPopupOpen","onResetButtonClick","onToggleButtonClick","triggerButtonBgImage","Fragment","ControlLabel","description","setNotificationContainer","dangerouslySetInnerHTML","__html","ControlHeader","labelStyle","renderLabel","renderTrigger","useTooltip","inputValue","togglePicker","convertColorForInput","formComponent","hsv","convertedValue","convertColorForPicker","ColorForm","useExternalPopupToggle","setInputValue","pickerValue","setPickerValue","currentInputValue","currentPickerValue","overrideUpdateComponentStateFn","valueForInput","shouldChangeInputValue","JSON","stringify","valueForPicker","shouldChangePickerValue","initialColor","default","formRef","useRef","setIsPopupOpen","pickerContainerStyle","setPickerContainerStyle","getPickerContainerStyle","rawPadding","getComputedStyle","parentNode","paddingLeft","padding","controlLeftOffset","offsetLeft","convertInputValueTo6Digits","closePopup","setTimeout","colorSwatches","wpColorPicker","wpColorPickerSwatches","options","palettes","removeHeader","openPopup","onReset","require$$0","client","createRoot","hydrateRoot","convertColorForCustomizer","ColorControl","handleOnRemoved","removedControl","unbind","notifications","render","mode","root","fn","unmount","MulticolorForm","choices","openedPopupKey","setOpenedPopupKey","title","circleColor","togglePopup","MulticolorControl","encodeJsonOrDefault","parseJsonOrUndefined","jsonStr","parse","makeDevicesValue","fieldType","devices","makeEmptyDevicesValue","devicesValue","startTypingDecimal","parseNumberValue","makeMarginPaddingFieldValue","makeObjValueWithoutUnit","dimensions","position","positionValue","makeObjValueWithoutUnitFromJson","makeEmptyValueObj","DeviceButtons","deviceClassName","MarginPaddingForm","inputValues","setInputValues","valueArray","defaultDefined","saveToCustomizerSetting","newVal","dontSaveUnit","singleValue","makeObjValueWithUnit","saveAsJson","makeMappable","items","dimension","renderFields","group","defaultValues","defaultArray","existingValues","handleResetButtonClick","item","inputClassName","inputId","unitRef","isResponsive","isActive","MarginPaddingControl","onRemoved","subtype","allowCollapse","_val","wpbfNotifications","allowUnitless","code","validateCssValue","Notification","message","wpbfDimensionControlL10n","valueStr","numericValue","multiples","multiplesValid","defaultParams","tinymce","wpautop","quicktags","mediaButtons","editor","tinyMCE","ed","save","getContent","instance","fieldValue","HTMLTextAreaElement","fields","settingProp","setupAssocArrayControl","existingValue","valueRecord","parent","customizerValue","saveAs","defaultSrc","valueSrc","box","preview","selectButton","changeButton","removeButton","defaultButton","handleButtonsDisplay","previewUrl","url","openMediaLibrary","selectedImage","media","multiple","open","jsonImg","state","first","toJSON","sizes","full","medium","thumbnail","i18n","__","RepeaterRow","constructor","rowIndex","__publicField","rowNum","updateLabel","toggleClass","header","slideUp","detach","rowLabelField","rowLabel","rowLabelRadioField","text","toggleMinimize","setRowIndex","SliderForm","sliderRef","valueRef","parseValue","safeValue","textContent","fieldId","defaultValue","renderedValue","step","makeValueForInput","isTypingDecimal","makeValueForSlider","InputSliderForm","setInputRefValue","setSliderRefValue","inputRef","sliderValue","valueToSave","limitedValue","numberValuePair","ResponsiveInputSliderForm","setActualValue","activeDevice","setActiveDevice","callback","deviceIndex","numberUnitPair","handleSliderChange","composeFontProperties","triggerPropertyName","triggerPropertyValue","triggerChange","variantValue","variant","maybeVariantControl","variantControl","variantChoices","fontFamily","googleFont","wpbfGoogleFonts","findGoogleFont","wpbfFontVariantOptions","googleFontVariants","variants","complete","fieldVariantKey","customVariantsGroup","wpbfFieldsFontVariants","variantFamily","standard","collectVariantChoices","active","activate","deactivate","some","variantFoundInChoices","$variantSelectbox","empty","append","choice","Option","rows","currentIndex","repeaterFieldsContainer","settingField","repeaterTemplate","settingValueFromParams","theNewRow","limit","addRow","initColorPicker","initSelect","$thisButton","openFrame","removeImage","removeFile","memoize","evaluate","interpolate","escape","variable","template","html","compiled","sortable","handle","update","sort","utils","isKeydownButNotEnterEvent","closest","initCropperFrame","initFrame","frame","libMediaType","getMimeType","states","controller","Library","library","query","date","onSelect","currentFieldId","siblings","attrs","isString","button","close","suggestedWidth","suggestedHeight","CustomizeImageCropper","imgSelectOptions","calculateImageSelectOptions","onSelectForCrop","onCropped","onSkippedCrop","attachment","setFileInRepeaterField","setImageInRepeaterField","flex_width","flex_height","setState","croppedImage","flexWidth","flexHeight","realWidth","realHeight","xInit","yInit","ratio","xImg","yImg","x1","y1","mustBeCropped","handles","persistent","imageWidth","imageHeight","aspectRatio","maxHeight","maxWidth","x2","y2","flexW","flexH","dstW","dstH","imgW","imgH","$targetDiv","hide","slideDown","show","filename","mime_type","$uploadButton","getValue","hiddenFieldValue","stringValue","decodeURI","refresh","filtering","filteredValue","idx","encodeURI","settingValue","newRowSetting","templateData","newRow","appendTo","deleteRow","fieldName","updateField","$rows","newOrder","newRows","newSettings","newPosition","oldPosition","currentSettings","row","$el","colorPicker","change","ui","currentPicker","_alpha","to_s","dropdown","dataField","currentDropdown","dispose","$picker","labelTemplate","labelDescriptionTemplate","headerTemplate","formTemplate","layoutStyle","notificationsContainer","$selectbox","selectedOptions","select2","option","choicesGlobalVar","choicesFromGlobalVar","selected","child","childIndex","placeholder","allowClear","clearable","maximumSelectionLength","maxSelections","setupSelectControl","SliderControl","InputSliderControl","ResponsiveInputSliderControl","initSortable","getNewValues","disableSelection","parents","$sortable","wpbfTypographyControlIds","addAction","controlInit","typographyControlId","wpbfFontProperties","property","propertyControlId","listenFontPropertyFieldsChange","setupTypographyFields","isSaving","form","draggableData","emptyWidgetItemMarkup","availableWidgetsPanel","builderPanel","buildAvailableWidgetsPanel","buildBuilderPanel","initDraggable","initDroppable","isSortableEmpty","sortableEl","isWidgetActive","widgetKey","builder","activeWidgetKeys","findWidgetByKey","availableWidgets","widget","body","$availableWidgetListEl","handleWidgetClick","availableRows","customizePreview","$builderPanel","insertAfter","$row","$innerRow","handleRowSettingClick","matchedRow","columns","column","columnIndex","columnPosClass","$widgetListEl","emptyWidgetListClass","matchedColumn","newWidgetItem","createWidgetItem","bindCustomizeSection","rowKey","expand","widgetEl","widgetData","connectedSection","dragHelper","availableWidgetItems","DragEvent","dataTransfer","setData","outerHTML","draggedElRect","draggedElFixedLeftPos","draggedElFixedTopPos","dragHelperInnerEl","innerElRect","dragHelperInnerElWidth","setDragImage","removeAttribute","builderDropZones","dropZone","widgetItem","getWidgetItemFromDraggableData","temporaryWidgetItem","removeChild","insertBefore","firstChild","emptyWidgetItem","parseDraggableData","getData","parsedJson","console","error","insideBuilderPanel","widgetItemToClone","cloneNode","deleteButton","stopPropagation","handleDeleteActiveWidget","$sortableWidgets","$builderColumns","connectWith","start","labelEl","checkSortableContent","stop","activeWidgetEl","availableWidgetEl","sortableEL","destroySortable","builderRows","sortableColumns","columnKey","widgetItems","allowedDevices","availableWidgetsPanels","desktop","mobile","controlForm","$availableWidgetPanel","$builderSlotsEl","$mobileBuilderRows","availableSlots","offcanvas","$builderOffcanvas","isLockedOffcanvas","isPremium","$builderInnerOffcanvas","$offcanvasWidgetsEl","$rowsWrapper","isLockedDropzone","area","$activeWidgets","deviceBuilderPanel"],"mappings":"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","x_google_ignoreList":[6,13,22]}