!function(){var e,t;function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}e=window.wp.customize,t=["desktop","mobile"],e&&(e.controlConstructor["wpbf-responsive-builder"]=e.wpbfDynamicControl.extend({isSaving:!1,draggableData:void 0,emptyWidgetItemMarkup:"<div class='widget-item empty-widget-item'>&nbsp;</div>",availableWidgetsPanels:{desktop:void 0,mobile:void 0},builderPanel:void 0,initWpbfControl:function(e){var t,i,a,l,n,d=null!=e?e:this;d&&(null===(t=d.setting)||void 0===t||t.bind(function(e){var t;null===(t=d.updateComponentState)||void 0===t||t.call(d,e)}),null===(i=d.buildAvailableWidgetsPanel)||void 0===i||i.call(d),null===(a=d.buildBuilderPanel)||void 0===a||a.call(d),null===(l=d.initDraggable)||void 0===l||l.call(d),null===(n=d.initDroppable)||void 0===n||n.call(d),window.setTimeout(function(){var e;null===(e=d.initSortable)||void 0===e||e.call(d)},1))},isSortableEmpty:function(e){var t,i=null===(t=this.findHtmlEls)||void 0===t?void 0:t.call(this,e,".widget-item");if(!i||!i.length)return!0;for(var a=0;a<i.length;a++){var l=i[a];if(!(l.classList.contains("empty-widget-item")||l.classList.contains("ui-sortable-placeholder"))&&!l.classList.contains("ui-sortable-helper"))return!1}return!0},isWidgetActive:function(e,t){if(!this.params||!t||"desktop"!==t&&"mobile"!==t)return!1;var i=this.params.builder[t].activeWidgetKeys;return!!i.length&&i.includes(e)},findWidgetByKey:function(e,t){if(this.params&&t&&("desktop"===t||"mobile"===t)){var i=this.params.builder[t].availableWidgets;if(i.length){var a=!0,l=!1,n=void 0;try{for(var d,r=i[Symbol.iterator]();!(a=(d=r.next()).done);a=!0){var o=d.value;if(o.key===e)return o}}catch(e){l=!0,n=e}finally{try{a||null==r.return||r.return()}finally{if(l)throw n}}}}},buildAvailableWidgetsPanel:function(){var e,t,i=function(e){if(!a.builder.hasOwnProperty(e)||"desktop"!==e&&"mobile"!==e||!a.builder[e].availableWidgets.length)return"continue";var i=jQuery("<div></div>").addClass("available-widgets-panel").attr("data-device",e).appendTo(l);t.availableWidgetsPanels[e]=i[0];var d=jQuery("<div></div>").addClass("builder-widgets available-widgets").appendTo(t.availableWidgetsPanels[e]);a.builder[e].availableWidgets.forEach(function(t){var i,a=t.key;jQuery("<div></div>").addClass("widget-item widget-item-".concat(a," ").concat((null===(i=n.isWidgetActive)||void 0===i?void 0:i.call(n,a,e))?"disabled":"")).attr("data-widget-key",a).attr("draggable","true").html('<span class="widget-label">'.concat(t.label,"</span>")).on("click",function(e){var i;null===(i=n.handleWidgetClick)||void 0===i||i.call(n,this,t)}).appendTo(d)})};if(this.container){var a=this.params;if(a){var l=null===(e=this.findHtmlEl)||void 0===e?void 0:e.call(this,this.container[0],".wpbf-control-form");if(l){var n=this;if(this.availableWidgetsPanels){for(var d in a.builder)t=this,i(d);jQuery(document.body).append('<div class="widget-drag-helper"></div>')}}}}},buildBuilderPanel:function(){var e,t=function(e){if(!l.builder.hasOwnProperty(e)||"desktop"!==e&&"mobile"!==e||!l.builder[e].availableWidgets.length)return"continue";var t=jQuery("<div></div>").addClass("wpbf-builder-slots").attr("data-device",e).appendTo(d);if(!l.builder[e].availableWidgets.length)return{v:void 0};var i=void 0;if("mobile"===e&&l.builder[e].availableSlots.sidebar){t.addClass("wpbf-flex wpbf-content-center");var n=jQuery("<div></div>").addClass("builder-sidebar").appendTo(t),o=jQuery("<div></div>").addClass("builder-inner-sidebar sortable-group").appendTo(n);jQuery("<button></button>").attr("type","button").addClass("row-setting-button").html('<i class="dashicons dashicons-admin-generic"></i><span class="button-label">'.concat(l.builder[e].availableSlots.sidebar.label,"</span>")).on("click",function(){var t;return null===(t=a.handleRowSettingClick)||void 0===t?void 0:t.call(a,l.builder[e].availableSlots.sidebar.key)}).appendTo(o);var s=jQuery("<div></div>").addClass("builder-widgets active-widgets dotted-border").appendTo(o);l.value&&l.value[e].sidebar.forEach(function(t){var i,l=null===(i=a.createWidgetItem)||void 0===i?void 0:i.call(a,t,!0,e);l&&s.append(l)}),i=jQuery("<div></div>").addClass("builder-rows").appendTo(t)}var c=l.builder[e].availableSlots;if(!c.rows.length)return"continue";var u="mobile"===e&&i?i:t;c.rows.forEach(function(t){var i,n=jQuery("<div></div>").addClass("builder-row sortable-group").attr("data-row-key",t.key).appendTo(u),d=jQuery("<div></div>").addClass("builder-inner-row dotted-border").appendTo(n);jQuery("<div></div>").addClass("row-label").attr("data-row-key",t.key).text(t.label).appendTo(n),jQuery("<button></button>").addClass("row-setting-button").attr("type","button").attr("data-row-key",t.key).html('<i class="dashicons dashicons-admin-generic"></i>').on("click",function(){var e;return null===(e=a.handleRowSettingClick)||void 0===e?void 0:e.call(a,t.key)}).appendTo(n);var o=l.value?l.value[e].rows[t.key]:void 0;t.columns.forEach(function(i,l){var n,s,c="";i.key.endsWith("_start")?c="wpbf-content-start":i.key.endsWith("_end")?c="wpbf-content-end":0!==l&&l!==t.columns.length-1&&(c="wpbf-content-center column-middle"),0===l?c+=" column-start wpbf-content-start":l===t.columns.length-1&&(c+=" column-end wpbf-content-end");var u=jQuery("<div></div>").addClass("builder-column builder-widgets active-widgets wpbf-flex ".concat(c)).attr("data-column-key",i.key).appendTo(d);if(!o||!Object.keys(o).length){u.addClass(r),u.html(null!==(n=a.emptyWidgetItemMarkup)&&void 0!==n?n:"");return}var v=o[i.key];if(!v||!v.length){u.addClass(r),u.html(null!==(s=a.emptyWidgetItemMarkup)&&void 0!==s?s:"");return}v.forEach(function(t){var i,l=null===(i=a.createWidgetItem)||void 0===i?void 0:i.call(a,t,!0,e);l&&u.append(l)})}),null===(i=a.bindCustomizeSection)||void 0===i||i.call(a,t.key)})},a=this,l=a.params;if(l){var n=null===(e=a.findHtmlEl)||void 0===e?void 0:e.call(a,"#customize-preview");if(n){var d=jQuery("<div></div>").addClass("wpbf-builder-panel ".concat(l.id,"-builder-panel")).attr("data-wpbf-builder-panel",l.id).insertAfter(n),r="empty-widget-list";for(var o in l.builder){var s=t(o);if("object"===i(s))return s.v}a.builderPanel=d[0]}}},handleRowSettingClick:function(t){null==e||e.section("wpbf_header_builder_".concat(t,"_section"),function(e){e.expand(e.params)})},bindCustomizeSection:function(t){null==e||e.section("wpbf_header_builder_".concat(t,"_section"),function(e){e.expanded.bind(function(e){var i=document.querySelector('.builder-row[data-row-key="'.concat(t,'"]'));i&&(e?i.classList.add("is-active"):i.classList.remove("is-active"))})})},handleWidgetClick:function(t,i){if((t.classList.contains("ui-sortable-handle")||t.classList.contains("disabled"))&&i.section){var a=null==e?void 0:e.section(i.section);a&&a.params&&a.expand(a.params)}},initDraggable:function(){if(this.params&&this.container&&this.builderPanel){var e,t,i=null===(e=this.findHtmlEl)||void 0===e?void 0:e.call(this,".widget-drag-helper");if(i){var a=null===(t=this.findHtmlEls)||void 0===t?void 0:t.call(this,this.container[0],".widget-item");if(a&&a.length){var l=this;a.forEach(function(e){e instanceof HTMLElement&&(e.addEventListener("dragstart",function(t){if(t instanceof DragEvent){document.body.classList.add("is-dragging-widget"),e.classList.add("is-dragging"),i.classList.add("is-shown");var a,n,d,r=e.dataset.widgetKey;if(r){l.draggableData={widgetKey:r},null===(a=t.dataTransfer)||void 0===a||a.setData("text",JSON.stringify({widgetKey:r})),i.innerHTML=e.outerHTML;var o=e.getBoundingClientRect(),s=o.left,c=o.top;i.style.left=s+"px",i.style.top=c+"px";var u=null===(n=l.findHtmlEl)||void 0===n?void 0:n.call(l,i,".widget-item"),v=null==u?void 0:u.getBoundingClientRect(),f=(null==v?void 0:v.width)||80;i.style.width=f+"px",null===(d=t.dataTransfer)||void 0===d||d.setDragImage(i,0,0),window.setTimeout(function(){i.classList.remove("is-shown")},10)}}}),e.addEventListener("dragend",function(t){t instanceof DragEvent&&(t.preventDefault(),e.classList.remove("is-dragging"),document.body.classList.remove("is-dragging-widget"),i.classList.remove("is-shown"),i.innerHTML="",i.removeAttribute("style"),l.draggableData=void 0)}))})}}}},initDroppable:function(){if(this.builderPanel){var e,t=null===(e=this.findHtmlEls)||void 0===e?void 0:e.call(this,this.builderPanel,".active-widgets");if(t&&t.length){var i=this;t.forEach(function(e){e.addEventListener("dragenter",function(t){t instanceof DragEvent&&(t.preventDefault(),e.classList.add("dragover"))}),e.addEventListener("dragover",function(e){e.preventDefault()}),e.addEventListener("dragleave",function(t){t instanceof DragEvent&&(t.preventDefault(),e.classList.remove("dragover"))}),e.addEventListener("drop",function(t){if(t instanceof DragEvent){t.preventDefault(),e.classList.remove("dragover");var a,l,n,d=null===(a=i.getWidgetItemFromDraggableData)||void 0===a?void 0:a.call(i,t);if(d){var r=d.dataset.widgetKey;if(r){var o=e.closest(".wpbf-builder-slots");if(o instanceof HTMLElement){var s=o.dataset.device;if(s&&("desktop"===s||"mobile"===s)){var c=null===(l=i.createWidgetItem)||void 0===l?void 0:l.call(i,r,!0,s);if(c){var u=e.querySelector(".ui-sortable-placeholder.from-available-widgets");u&&e.removeChild(u),e.classList.contains("column-end")?e.insertBefore(c,e.firstChild):e.appendChild(c);var v=e.querySelector(".empty-widget-item");v&&v.remove(),jQuery(e).sortable("refresh"),d.classList.add("disabled"),i.draggableData=void 0,null===(n=i.updateCustomizerSetting)||void 0===n||n.call(i)}}}}}}})})}}},parseDraggableData:function(e){var t,i=null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("text");if(i){var a=void 0;try{a=JSON.parse(i)}catch(e){console.error("Error parsing JSON data:",e)}if(a)return a}},getWidgetItemFromDraggableData:function(e){if((null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("text"))&&this.container){var t,i,a,l=null===(i=this.parseDraggableData)||void 0===i?void 0:i.call(this,e);if(l){var n=l.widgetKey;if(n)return null===(a=this.findHtmlEl)||void 0===a?void 0:a.call(this,this.container[0],'.widget-item[data-widget-key="'.concat(n,'"]'))}}},createWidgetItem:function(e,t,i){if(this.container){var a,l,n=null===(a=this.findWidgetByKey)||void 0===a?void 0:a.call(this,e,i);if(n){var d=this,r=null===(l=this.findHtmlEl)||void 0===l?void 0:l.call(this,this.container[0],'.widget-item[data-widget-key="'.concat(e,'"]'));if(r){var o=r.cloneNode(!0);if(o instanceof HTMLElement){if(o.classList.remove("disabled"),o.classList.remove("is-dragging"),o.removeAttribute("draggable"),t){var s=document.createElement("button");s.type="button",s.className="widget-button delete-widget-button",s.innerHTML='<i class="dashicons dashicons-no-alt"></i>',o.appendChild(s),s.addEventListener("click",function(e){var t;e.preventDefault(),e.stopPropagation(),null===(t=d.handleDeleteActiveWidget)||void 0===t||t.call(d,o,r)}),o.addEventListener("click",function(e){var t;e.preventDefault(),null===(t=d.handleWidgetClick)||void 0===t||t.call(d,this,n)})}return o}}}}},initSortable:function(){var e=this;jQuery(".active-widgets").sortable({connectWith:".active-widgets",placeholder:"widget-item",start:function(t,i){document.body.classList.add("is-sorting-widget");var a,l=null===(a=e.findHtmlEl)||void 0===a?void 0:a.call(e,i.item[0],".widget-label");l&&i.placeholder[0].appendChild(l.cloneNode(!0))},update:function(t,i){var a,l,n=t.target;n instanceof HTMLElement&&(null===(a=e.checkSortableContent)||void 0===a||a.call(e,n),null===(l=e.updateCustomizerSetting)||void 0===l||l.call(e))},stop:function(e,t){document.body.classList.remove("is-sorting-widget")}}),jQuery(".builder-column.column-middle").on("sortover",function(e,t){e.target.classList.remove("empty-widget-list")}),jQuery(".builder-column.column-middle").on("sortout",function(t,i){var a;null===(a=e.checkSortableContent)||void 0===a||a.call(e,t.target)})},handleDeleteActiveWidget:function(e,t){null==t||t.classList.remove("disabled");var i,a,l=e.closest(".active-widgets");e.remove(),l instanceof HTMLElement&&(null===(i=this.checkSortableContent)||void 0===i||i.call(this,l)),l&&jQuery(l).sortable("refresh"),null===(a=this.updateCustomizerSetting)||void 0===a||a.call(this)},checkSortableContent:function(e){var t,i,a="empty-widget-list",l=e.querySelector(".empty-widget-item");(null===(t=this.isSortableEmpty)||void 0===t?void 0:t.call(this,e))?(e.classList.add(a),l||jQuery(e).append(null!==(i=this.emptyWidgetItemMarkup)&&void 0!==i?i:"")):(e.classList.remove(a),l&&l.remove())},destroySortable:function(){this.builderPanel&&jQuery(".wpbf-builder-panel .active-widgets").sortable("destroy")},updateCustomizerSetting:function(){var e=this;this.isSaving||(this.isSaving=!0,setTimeout(function(){if(e.availableWidgetsPanels){var a={desktop:{rows:{}},mobile:{sidebar:[],rows:{}}},l=!0,n=!1,d=void 0;try{for(var r,o,s=t[Symbol.iterator]();!(l=(o=s.next()).done);l=!0){var c=function(){var t=o.value;if("desktop"!==t&&"mobile"!==t)return"continue";var i=null===(l=e.findHtmlEl)||void 0===l?void 0:l.call(e,e.builderPanel,'.wpbf-builder-slots[data-device="'.concat(t,'"]'));if(!i)return{v:void 0};if("mobile"===t){var l,n,d,r,s=null===(d=e.findHtmlEl)||void 0===d?void 0:d.call(e,i,".builder-sidebar .active-widgets"),c=null===(r=e.findHtmlEls)||void 0===r?void 0:r.call(e,s,".widget-item");null==c||c.forEach(function(e){if(!(e.classList.contains("empty-widget-item")||e.classList.contains("ui-sortable-placeholder"))){var i=e.dataset.widgetKey;i&&a[t].sidebar.push(i)}})}var u=null===(n=e.findHtmlEls)||void 0===n?void 0:n.call(e,i,".builder-row");if(!u||!u.length)return"continue";u.forEach(function(i){var l,n=i.dataset.rowKey;if(n){var d=null===(l=e.findHtmlEls)||void 0===l?void 0:l.call(e,i,".active-widgets");d&&d.length&&(a[t].rows[n]={},d.forEach(function(i){var l,d=i.dataset.columnKey;if(d){a[t].rows[n][d]=[];var r=null===(l=e.findHtmlEls)||void 0===l?void 0:l.call(e,i,".widget-item");r&&r.length&&r.forEach(function(e){if(!(e.classList.contains("empty-widget-item")||e.classList.contains("ui-sortable-placeholder"))){var i=e.dataset.widgetKey;i&&a[t].rows[n][d].push(i)}})}}))}})}();if("object"===i(c))return c.v}}catch(e){n=!0,d=e}finally{try{l||null==s.return||s.return()}finally{if(n)throw d}}null===(r=e.setting)||void 0===r||r.set(a),e.isSaving=!1}},1))},updateComponentState:function(e){}}))}();
//# sourceMappingURL=responsive-builder-control-min.js.map
