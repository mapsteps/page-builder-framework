{"version":3,"file":"responsive-builder-control-min.js","sources":["../src/responsive-builder-control.ts"],"sourcesContent":["import {\r\n\tResponsiveBuilderValue,\r\n\tWpbfResponsiveBuilderControl,\r\n} from \"./builder-interface\";\r\n\r\n(function (customizer: WpbfCustomize | undefined) {\r\n\tconst allowedDevices = [\"desktop\", \"mobile\"];\r\n\r\n\tif (!customizer) return;\r\n\r\n\tcustomizer.controlConstructor[\"wpbf-responsive-builder\"] =\r\n\t\tcustomizer.wpbfDynamicControl.extend<WpbfResponsiveBuilderControl>({\r\n\t\t\tisSaving: false,\r\n\r\n\t\t\tdraggableData: undefined,\r\n\r\n\t\t\temptyWidgetItemMarkup:\r\n\t\t\t\t\"<div class='widget-item empty-widget-item'>&nbsp;</div>\",\r\n\r\n\t\t\tavailableWidgetsPanels: {\r\n\t\t\t\tdesktop: undefined,\r\n\t\t\t\tmobile: undefined,\r\n\t\t\t},\r\n\r\n\t\t\tbuilderPanel: undefined,\r\n\r\n\t\t\tinitWpbfControl: function (ctrl) {\r\n\t\t\t\tconst control = ctrl ?? this;\r\n\t\t\t\tif (!control) return;\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Listen to customizer setting change event.\r\n\t\t\t\t * Update component state when customizer setting changed.\r\n\t\t\t\t */\r\n\t\t\t\tcontrol.setting?.bind((value) => {\r\n\t\t\t\t\tcontrol.updateComponentState?.(value);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcontrol.buildAvailableWidgetsPanel?.();\r\n\t\t\t\tcontrol.buildBuilderPanel?.();\r\n\t\t\t\tcontrol.initDraggable?.();\r\n\t\t\t\tcontrol.initDroppable?.();\r\n\r\n\t\t\t\t// Timeout to wait for the elements to be rendered.\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tcontrol.initSortable?.();\r\n\t\t\t\t}, 1);\r\n\t\t\t},\r\n\r\n\t\t\tisSortableEmpty: function (sortableEl) {\r\n\t\t\t\tconst children = this.findHtmlEls?.(sortableEl, \".widget-item\");\r\n\r\n\t\t\t\tif (!children || !children.length) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\r\n\t\t\t\t\tconst child = children[i];\r\n\r\n\t\t\t\t\tif (child.classList.contains(\"empty-widget-item\")) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-placeholder\")) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (child.classList.contains(\"ui-sortable-helper\")) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tisWidgetActive: function (widgetKey, device) {\r\n\t\t\t\tif (\r\n\t\t\t\t\t!this.params ||\r\n\t\t\t\t\t!device ||\r\n\t\t\t\t\t(device !== \"desktop\" && device !== \"mobile\")\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst activeWidgetKeys = this.params.builder[device].activeWidgetKeys;\r\n\t\t\t\tif (!activeWidgetKeys.length) return false;\r\n\r\n\t\t\t\treturn activeWidgetKeys.includes(widgetKey);\r\n\t\t\t},\r\n\r\n\t\t\tfindWidgetByKey: function (widgetKey, device) {\r\n\t\t\t\tif (\r\n\t\t\t\t\t!this.params ||\r\n\t\t\t\t\t!device ||\r\n\t\t\t\t\t(device !== \"desktop\" && device !== \"mobile\")\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst availableWidgets = this.params.builder[device].availableWidgets;\r\n\t\t\t\tif (!availableWidgets.length) return undefined;\r\n\r\n\t\t\t\tfor (const widget of availableWidgets) {\r\n\t\t\t\t\tif (widget.key === widgetKey) {\r\n\t\t\t\t\t\treturn widget;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn undefined;\r\n\t\t\t},\r\n\r\n\t\t\tbuildAvailableWidgetsPanel: function () {\r\n\t\t\t\tif (!this.container) return;\r\n\r\n\t\t\t\tconst params = this.params;\r\n\t\t\t\tif (!params) return;\r\n\r\n\t\t\t\tconst controlForm = this.findHtmlEl?.(\r\n\t\t\t\t\tthis.container[0],\r\n\t\t\t\t\t\".wpbf-control-form\",\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!controlForm) return;\r\n\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tif (!this.availableWidgetsPanels) return;\r\n\r\n\t\t\t\tfor (const device in params.builder) {\r\n\t\t\t\t\tif (!params.builder.hasOwnProperty(device)) continue;\r\n\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") continue;\r\n\t\t\t\t\tif (!params.builder[device].availableWidgets.length) continue;\r\n\r\n\t\t\t\t\tconst $availableWidgetPanel = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t.addClass(\"available-widgets-panel\")\r\n\t\t\t\t\t\t.attr(\"data-device\", device)\r\n\t\t\t\t\t\t.appendTo(controlForm);\r\n\r\n\t\t\t\t\tthis.availableWidgetsPanels[device] = $availableWidgetPanel[0];\r\n\r\n\t\t\t\t\tconst $availableWidgetListEl = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t.addClass(\"builder-widgets available-widgets\")\r\n\t\t\t\t\t\t.appendTo(this.availableWidgetsPanels[device]);\r\n\r\n\t\t\t\t\tconst availableWidgets = params.builder[device].availableWidgets;\r\n\r\n\t\t\t\t\t// Build the available widgets list based on `availableWidgets`.\r\n\t\t\t\t\tavailableWidgets.forEach((widget) => {\r\n\t\t\t\t\t\tconst widgetKey = widget.key;\r\n\r\n\t\t\t\t\t\tjQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t`widget-item widget-item-${widgetKey} ${control.isWidgetActive?.(widgetKey, device) ? \"disabled\" : \"\"}`,\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.attr(\"data-widget-key\", widgetKey)\r\n\t\t\t\t\t\t\t.attr(\"draggable\", \"true\")\r\n\t\t\t\t\t\t\t.html(`<span class=\"widget-label\">${widget.label}</span>`)\r\n\t\t\t\t\t\t\t.on(\"click\", function (e) {\r\n\t\t\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widget);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.appendTo($availableWidgetListEl);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tjQuery(document.body).append('<div class=\"widget-drag-helper\"></div>');\r\n\t\t\t},\r\n\r\n\t\t\tbuildBuilderPanel: function () {\r\n\t\t\t\tconst control = this;\r\n\t\t\t\tconst params = control.params;\r\n\t\t\t\tif (!params) return;\r\n\r\n\t\t\t\tconst customizePreview = control.findHtmlEl?.(\"#customize-preview\");\r\n\t\t\t\tif (!customizePreview) return;\r\n\r\n\t\t\t\t// Create the panel.\r\n\t\t\t\tconst $builderPanel = jQuery(\"<div></div>\")\r\n\t\t\t\t\t.addClass(`wpbf-builder-panel ${params.id}-builder-panel`)\r\n\t\t\t\t\t.attr(\"data-wpbf-builder-panel\", params.id)\r\n\t\t\t\t\t.insertAfter(customizePreview);\r\n\r\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\r\n\r\n\t\t\t\tfor (const device in params.builder) {\r\n\t\t\t\t\tif (!params.builder.hasOwnProperty(device)) continue;\r\n\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") continue;\r\n\t\t\t\t\tif (!params.builder[device].availableWidgets.length) continue;\r\n\r\n\t\t\t\t\tconst $builderSlotsEl = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t.addClass(\"wpbf-builder-slots\")\r\n\t\t\t\t\t\t.attr(\"data-device\", device)\r\n\t\t\t\t\t\t.appendTo($builderPanel);\r\n\r\n\t\t\t\t\tconst availableWidgets = params.builder[device].availableWidgets;\r\n\t\t\t\t\tif (!availableWidgets.length) return;\r\n\r\n\t\t\t\t\tlet $mobileBuilderRows: JQuery<HTMLElement> | undefined = undefined;\r\n\r\n\t\t\t\t\tif (params.builder[device].availableSlots.offcanvas) {\r\n\t\t\t\t\t\t$builderSlotsEl.addClass(`wpbf-flex wpbf-content-center`);\r\n\r\n\t\t\t\t\t\tconst $builderOffcanvas = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\"builder-offcanvas\")\r\n\t\t\t\t\t\t\t.appendTo($builderSlotsEl);\r\n\r\n\t\t\t\t\t\tconst $builderInnerOffcanvas = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\"builder-inner-offcanvas sortable-group\")\r\n\t\t\t\t\t\t\t.appendTo($builderOffcanvas);\r\n\r\n\t\t\t\t\t\t// Build the row setting button.\r\n\t\t\t\t\t\tjQuery(\"<button></button>\")\r\n\t\t\t\t\t\t\t.attr(\"type\", \"button\")\r\n\t\t\t\t\t\t\t.addClass(\"row-setting-button\")\r\n\t\t\t\t\t\t\t.html(\r\n\t\t\t\t\t\t\t\t`<i class=\"dashicons dashicons-admin-generic\"></i><span class=\"button-label\">${params.builder[device].availableSlots.offcanvas.label}</span>`,\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.on(\"click\", () =>\r\n\t\t\t\t\t\t\t\tcontrol.handleRowSettingClick?.(\r\n\t\t\t\t\t\t\t\t\tparams.builder[device].availableSlots.offcanvas.key,\r\n\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.appendTo($builderInnerOffcanvas);\r\n\r\n\t\t\t\t\t\tconst $offcanvasWidgetsEl = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\"builder-widgets active-widgets dotted-border\")\r\n\t\t\t\t\t\t\t.appendTo($builderInnerOffcanvas);\r\n\r\n\t\t\t\t\t\tif (params.value) {\r\n\t\t\t\t\t\t\t// Build the widget list based on `params.value`.\r\n\t\t\t\t\t\t\tparams.value[device].offcanvas?.forEach((widgetKey) => {\r\n\t\t\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\r\n\t\t\t\t\t\t\t\t\twidgetKey,\r\n\t\t\t\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t\t\t\tdevice,\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (!newWidgetItem) return;\r\n\r\n\t\t\t\t\t\t\t\t$offcanvasWidgetsEl.append(newWidgetItem);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$mobileBuilderRows = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\"builder-rows\")\r\n\t\t\t\t\t\t\t.appendTo($builderSlotsEl);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst availableSlots = params.builder[device].availableSlots;\r\n\t\t\t\t\tif (!availableSlots.rows.length) continue;\r\n\r\n\t\t\t\t\tconst $rowsWrapper = $mobileBuilderRows\r\n\t\t\t\t\t\t? $mobileBuilderRows\r\n\t\t\t\t\t\t: $builderSlotsEl;\r\n\r\n\t\t\t\t\tavailableSlots.rows.forEach((row) => {\r\n\t\t\t\t\t\t// Build the row.\r\n\t\t\t\t\t\tconst $row = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(`builder-row sortable-group`)\r\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\r\n\t\t\t\t\t\t\t.appendTo($rowsWrapper);\r\n\r\n\t\t\t\t\t\t// Build the inner row.\r\n\t\t\t\t\t\tconst $innerRow = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(`builder-inner-row dotted-border`)\r\n\t\t\t\t\t\t\t.appendTo($row);\r\n\r\n\t\t\t\t\t\t// Build the row label (tooltip)\r\n\t\t\t\t\t\tjQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t.addClass(\"row-label\")\r\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\r\n\t\t\t\t\t\t\t.text(row.label)\r\n\t\t\t\t\t\t\t.appendTo($row);\r\n\r\n\t\t\t\t\t\t// Build the row setting button.\r\n\t\t\t\t\t\tjQuery(\"<button></button>\")\r\n\t\t\t\t\t\t\t.addClass(\"row-setting-button\")\r\n\t\t\t\t\t\t\t.attr(\"type\", \"button\")\r\n\t\t\t\t\t\t\t.attr(\"data-row-key\", row.key)\r\n\t\t\t\t\t\t\t.html('<i class=\"dashicons dashicons-admin-generic\"></i>')\r\n\t\t\t\t\t\t\t.on(\"click\", () => control.handleRowSettingClick?.(row.key))\r\n\t\t\t\t\t\t\t.appendTo($row);\r\n\r\n\t\t\t\t\t\tconst matchedRow = params.value\r\n\t\t\t\t\t\t\t? params.value[device].rows[row.key]\r\n\t\t\t\t\t\t\t: undefined;\r\n\r\n\t\t\t\t\t\trow.columns.forEach((column, columnIndex) => {\r\n\t\t\t\t\t\t\tlet columnPosClass = \"\";\r\n\r\n\t\t\t\t\t\t\tif (column.key.endsWith(\"_start\")) {\r\n\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-start\";\r\n\t\t\t\t\t\t\t} else if (column.key.endsWith(\"_end\")) {\r\n\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-end\";\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\tcolumnIndex !== 0 &&\r\n\t\t\t\t\t\t\t\t\tcolumnIndex !== row.columns.length - 1\r\n\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\tcolumnPosClass = \"wpbf-content-center column-middle\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (columnIndex === 0) {\r\n\t\t\t\t\t\t\t\tcolumnPosClass += \" column-start wpbf-content-start\";\r\n\t\t\t\t\t\t\t} else if (columnIndex === row.columns.length - 1) {\r\n\t\t\t\t\t\t\t\tcolumnPosClass += \" column-end wpbf-content-end\";\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst $widgetListEl = jQuery(\"<div></div>\")\r\n\t\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t\t`builder-column builder-widgets active-widgets wpbf-flex ${columnPosClass}`,\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t.attr(\"data-column-key\", column.key)\r\n\t\t\t\t\t\t\t\t.appendTo($innerRow);\r\n\r\n\t\t\t\t\t\t\tif (!matchedRow || !Object.keys(matchedRow).length) {\r\n\t\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\r\n\t\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst matchedColumn = matchedRow[column.key];\r\n\r\n\t\t\t\t\t\t\tif (!matchedColumn || !matchedColumn.length) {\r\n\t\t\t\t\t\t\t\t$widgetListEl.addClass(emptyWidgetListClass);\r\n\t\t\t\t\t\t\t\t$widgetListEl.html(control.emptyWidgetItemMarkup ?? \"\");\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Build the widget list based on `matchedColumn`.\r\n\t\t\t\t\t\t\tmatchedColumn.forEach((widgetKey) => {\r\n\t\t\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\r\n\t\t\t\t\t\t\t\t\twidgetKey,\r\n\t\t\t\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t\t\t\tdevice,\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (!newWidgetItem) return;\r\n\r\n\t\t\t\t\t\t\t\t$widgetListEl.append(newWidgetItem);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tcontrol.bindCustomizeSection?.(row.key);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontrol.builderPanel = $builderPanel[0];\r\n\t\t\t},\r\n\r\n\t\t\thandleRowSettingClick: function (rowKey) {\r\n\t\t\t\tcustomizer?.section(\r\n\t\t\t\t\t`wpbf_header_builder_${rowKey}_section`,\r\n\t\t\t\t\tfunction (section) {\r\n\t\t\t\t\t\tsection.expand(section.params);\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\tbindCustomizeSection: function (rowKey) {\r\n\t\t\t\tcustomizer?.section(\r\n\t\t\t\t\t`wpbf_header_builder_${rowKey}_section`,\r\n\t\t\t\t\tfunction (section) {\r\n\t\t\t\t\t\tsection.expanded.bind(function (expanded) {\r\n\t\t\t\t\t\t\tconst row = document.querySelector(\r\n\t\t\t\t\t\t\t\t`.builder-row[data-row-key=\"${rowKey}\"]`,\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tif (!row) return;\r\n\r\n\t\t\t\t\t\t\tif (expanded) {\r\n\t\t\t\t\t\t\t\trow.classList.add(\"is-active\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\trow.classList.remove(\"is-active\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\t\t\t},\r\n\r\n\t\t\thandleWidgetClick: function (widgetEl, widgetData) {\r\n\t\t\t\t// If this is from the available widgets panel.\r\n\t\t\t\tif (!widgetEl.classList.contains(\"ui-sortable-handle\")) {\r\n\t\t\t\t\tif (!widgetEl.classList.contains(\"disabled\")) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!widgetData.section) return;\r\n\r\n\t\t\t\tconst connectedSection = customizer?.section(widgetData.section);\r\n\t\t\t\tif (!connectedSection || !connectedSection.params) return;\r\n\r\n\t\t\t\tconnectedSection.expand(connectedSection.params);\r\n\t\t\t},\r\n\r\n\t\t\tinitDraggable: function () {\r\n\t\t\t\tif (!this.params || !this.container || !this.builderPanel) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst dragHelper = this.findHtmlEl?.(\".widget-drag-helper\");\r\n\t\t\t\tif (!dragHelper) return;\r\n\r\n\t\t\t\tconst availableWidgetItems = this.findHtmlEls?.(\r\n\t\t\t\t\tthis.container[0],\r\n\t\t\t\t\t\".widget-item\",\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!availableWidgetItems || !availableWidgetItems.length) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tavailableWidgetItems.forEach((item) => {\r\n\t\t\t\t\tif (!(item instanceof HTMLElement)) return;\r\n\r\n\t\t\t\t\titem.addEventListener(\"dragstart\", (e) => {\r\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\r\n\r\n\t\t\t\t\t\tdocument.body.classList.add(\"is-dragging-widget\");\r\n\t\t\t\t\t\titem.classList.add(\"is-dragging\");\r\n\t\t\t\t\t\tdragHelper.classList.add(\"is-shown\");\r\n\r\n\t\t\t\t\t\tconst widgetKey = item.dataset.widgetKey;\r\n\t\t\t\t\t\tif (!widgetKey) return;\r\n\r\n\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t * Set the data to be transferred.\r\n\t\t\t\t\t\t * We use both e.dataTransfer and control.draggableData to store the data.\r\n\t\t\t\t\t\t * Because e.dataTransfer can't be accessed from \"dragenter\" and \"dragover\" event.\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tcontrol.draggableData = { widgetKey };\r\n\t\t\t\t\t\te.dataTransfer?.setData(\"text\", JSON.stringify({ widgetKey }));\r\n\r\n\t\t\t\t\t\tdragHelper.innerHTML = item.outerHTML;\r\n\r\n\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t * The visualDragHelper is a direct body child element with position: fixed, left: 0, and top: 0.\r\n\t\t\t\t\t\t * We need to set the position of the dragVisualHelper to be in the same position of current `item` (.wiget-item).\r\n\t\t\t\t\t\t * Meaning, we need to get the top and left position of the current event element and set the fixed position of the dragVisualHelper.\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tconst draggedElRect = item.getBoundingClientRect();\r\n\t\t\t\t\t\tconst draggedElFixedLeftPos = draggedElRect.left;\r\n\t\t\t\t\t\tconst draggedElFixedTopPos = draggedElRect.top;\r\n\r\n\t\t\t\t\t\tdragHelper.style.left = draggedElFixedLeftPos + \"px\";\r\n\t\t\t\t\t\tdragHelper.style.top = draggedElFixedTopPos + \"px\";\r\n\r\n\t\t\t\t\t\tconst dragHelperInnerEl = control.findHtmlEl?.(\r\n\t\t\t\t\t\t\tdragHelper,\r\n\t\t\t\t\t\t\t\".widget-item\",\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tconst innerElRect = dragHelperInnerEl?.getBoundingClientRect();\r\n\t\t\t\t\t\tconst dragHelperInnerElWidth = innerElRect?.width || 80;\r\n\r\n\t\t\t\t\t\tdragHelper.style.width = dragHelperInnerElWidth + \"px\";\r\n\r\n\t\t\t\t\t\te.dataTransfer?.setDragImage(dragHelper, 0, 0);\r\n\r\n\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\r\n\t\t\t\t\t\t}, 10);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\titem.addEventListener(\"dragend\", (e) => {\r\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\r\n\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\titem.classList.remove(\"is-dragging\");\r\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-dragging-widget\");\r\n\r\n\t\t\t\t\t\tdragHelper.classList.remove(\"is-shown\");\r\n\t\t\t\t\t\tdragHelper.innerHTML = \"\";\r\n\t\t\t\t\t\tdragHelper.removeAttribute(\"style\");\r\n\r\n\t\t\t\t\t\tcontrol.draggableData = undefined;\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tinitDroppable: function () {\r\n\t\t\t\tif (!this.builderPanel) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst builderDropZones = this.findHtmlEls?.(\r\n\t\t\t\t\tthis.builderPanel,\r\n\t\t\t\t\t\".active-widgets\",\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!builderDropZones || !builderDropZones.length) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tbuilderDropZones.forEach((dropZone) => {\r\n\t\t\t\t\tdropZone.addEventListener(\"dragenter\", (e) => {\r\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tdropZone.classList.add(\"dragover\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// This empty block is necessary to let the dropZone accept the drop event.\r\n\t\t\t\t\tdropZone.addEventListener(\"dragover\", (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdropZone.addEventListener(\"dragleave\", (e) => {\r\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdropZone.addEventListener(\"drop\", (e) => {\r\n\t\t\t\t\t\tif (!(e instanceof DragEvent)) return;\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tdropZone.classList.remove(\"dragover\");\r\n\r\n\t\t\t\t\t\tconst widgetItem = control.getWidgetItemFromDraggableData?.(e);\r\n\t\t\t\t\t\tif (!widgetItem) return;\r\n\r\n\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\r\n\t\t\t\t\t\tif (!widgetKey) return;\r\n\r\n\t\t\t\t\t\tconst area = dropZone.closest(\".wpbf-builder-slots\");\r\n\t\t\t\t\t\tif (!(area instanceof HTMLElement)) return;\r\n\r\n\t\t\t\t\t\tconst device = area.dataset.device;\r\n\r\n\t\t\t\t\t\tif (!device || (device !== \"desktop\" && device !== \"mobile\")) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst newWidgetItem = control.createWidgetItem?.(\r\n\t\t\t\t\t\t\twidgetKey,\r\n\t\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t\tdevice,\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (!newWidgetItem) return;\r\n\r\n\t\t\t\t\t\tconst temporaryWidgetItem = dropZone.querySelector(\r\n\t\t\t\t\t\t\t\".ui-sortable-placeholder.from-available-widgets\",\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (temporaryWidgetItem) {\r\n\t\t\t\t\t\t\tdropZone.removeChild(temporaryWidgetItem);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (dropZone.classList.contains(\"column-end\")) {\r\n\t\t\t\t\t\t\tdropZone.insertBefore(newWidgetItem, dropZone.firstChild);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdropZone.appendChild(newWidgetItem);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst emptyWidgetItem =\r\n\t\t\t\t\t\t\tdropZone.querySelector(\".empty-widget-item\");\r\n\r\n\t\t\t\t\t\tif (emptyWidgetItem) {\r\n\t\t\t\t\t\t\temptyWidgetItem.remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Now refresh the sortable.\r\n\t\t\t\t\t\tjQuery(dropZone).sortable(\"refresh\");\r\n\r\n\t\t\t\t\t\twidgetItem.classList.add(\"disabled\");\r\n\t\t\t\t\t\tcontrol.draggableData = undefined;\r\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tparseDraggableData: function (e) {\r\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\r\n\t\t\t\tif (!data) return undefined;\r\n\r\n\t\t\t\tlet parsedJson: undefined | Record<string, any> = undefined;\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tparsedJson = JSON.parse(data);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error(\"Error parsing JSON data:\", e);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!parsedJson) return undefined;\r\n\r\n\t\t\t\treturn parsedJson;\r\n\t\t\t},\r\n\r\n\t\t\tgetWidgetItemFromDraggableData: function (e) {\r\n\t\t\t\tconst data = e.dataTransfer?.getData(\"text\");\r\n\t\t\t\tif (!data) return undefined;\r\n\t\t\t\tif (!this.container) return undefined;\r\n\r\n\t\t\t\tconst parsedJson = this.parseDraggableData?.(e);\r\n\t\t\t\tif (!parsedJson) return undefined;\r\n\r\n\t\t\t\tconst widgetKey = parsedJson.widgetKey;\r\n\t\t\t\tif (!widgetKey) return undefined;\r\n\r\n\t\t\t\tconst widgetItem = this.findHtmlEl?.(\r\n\t\t\t\t\tthis.container[0],\r\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn widgetItem;\r\n\t\t\t},\r\n\r\n\t\t\tcreateWidgetItem: function (widgetKey, insideBuilderPanel, device) {\r\n\t\t\t\tif (!this.container) return undefined;\r\n\r\n\t\t\t\tconst widgetData = this.findWidgetByKey?.(widgetKey, device);\r\n\t\t\t\tif (!widgetData) return undefined;\r\n\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tconst widgetItemToClone = this.findHtmlEl?.(\r\n\t\t\t\t\tthis.container[0],\r\n\t\t\t\t\t`.widget-item[data-widget-key=\"${widgetKey}\"]`,\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!widgetItemToClone) return undefined;\r\n\r\n\t\t\t\tconst newWidgetItem = widgetItemToClone.cloneNode(true);\r\n\t\t\t\tif (!(newWidgetItem instanceof HTMLElement)) return undefined;\r\n\r\n\t\t\t\tnewWidgetItem.classList.remove(\"disabled\");\r\n\t\t\t\tnewWidgetItem.classList.remove(\"is-dragging\");\r\n\t\t\t\tnewWidgetItem.removeAttribute(\"draggable\");\r\n\r\n\t\t\t\tif (insideBuilderPanel) {\r\n\t\t\t\t\tconst deleteButton = document.createElement(\"button\");\r\n\t\t\t\t\tdeleteButton.type = \"button\";\r\n\t\t\t\t\tdeleteButton.className = \"widget-button delete-widget-button\";\r\n\t\t\t\t\tdeleteButton.innerHTML = '<i class=\"dashicons dashicons-no-alt\"></i>';\r\n\t\t\t\t\tnewWidgetItem.appendChild(deleteButton);\r\n\r\n\t\t\t\t\tdeleteButton.addEventListener(\"click\", (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t\t\tcontrol.handleDeleteActiveWidget?.(\r\n\t\t\t\t\t\t\tnewWidgetItem,\r\n\t\t\t\t\t\t\twidgetItemToClone,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tnewWidgetItem.addEventListener(\"click\", function (e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tcontrol.handleWidgetClick?.(this, widgetData);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn newWidgetItem;\r\n\t\t\t},\r\n\r\n\t\t\tinitSortable: function () {\r\n\t\t\t\tconst control = this;\r\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\r\n\r\n\t\t\t\tjQuery(\".active-widgets\").sortable({\r\n\t\t\t\t\tconnectWith: \".active-widgets\",\r\n\t\t\t\t\tplaceholder: \"widget-item\",\r\n\t\t\t\t\tstart: function (e, ui) {\r\n\t\t\t\t\t\tdocument.body.classList.add(\"is-sorting-widget\");\r\n\r\n\t\t\t\t\t\tconst labelEl = control.findHtmlEl?.(ui.item[0], \".widget-label\");\r\n\r\n\t\t\t\t\t\tif (labelEl) {\r\n\t\t\t\t\t\t\tui.placeholder[0].appendChild(labelEl.cloneNode(true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tupdate: function (e, ui) {\r\n\t\t\t\t\t\tconst sortableEl = e.target;\r\n\t\t\t\t\t\tif (!(sortableEl instanceof HTMLElement)) return;\r\n\r\n\t\t\t\t\t\tcontrol.checkSortableContent?.(sortableEl);\r\n\t\t\t\t\t\tcontrol.updateCustomizerSetting?.();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tstop: function (e, ui) {\r\n\t\t\t\t\t\tdocument.body.classList.remove(\"is-sorting-widget\");\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\r\n\t\t\t\tjQuery(\".builder-column.column-middle\").on(\r\n\t\t\t\t\t\"sortover\",\r\n\t\t\t\t\tfunction (e, ui) {\r\n\t\t\t\t\t\tconst target = e.target;\r\n\t\t\t\t\t\ttarget.classList.remove(emptyWidgetListClass);\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\r\n\t\t\t\tjQuery(\".builder-column.column-middle\").on(\"sortout\", function (e, ui) {\r\n\t\t\t\t\tcontrol.checkSortableContent?.(e.target);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\thandleDeleteActiveWidget: function (activeWidgetEl, availableWidgetEl) {\r\n\t\t\t\tconst control = this;\r\n\r\n\t\t\t\tavailableWidgetEl?.classList.remove(\"disabled\");\r\n\r\n\t\t\t\tconst sortableEL = activeWidgetEl.closest(\".active-widgets\");\r\n\r\n\t\t\t\tactiveWidgetEl.remove();\r\n\r\n\t\t\t\tif (sortableEL instanceof HTMLElement) {\r\n\t\t\t\t\tcontrol.checkSortableContent?.(sortableEL);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sortableEL) {\r\n\t\t\t\t\tjQuery(sortableEL).sortable(\"refresh\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontrol.updateCustomizerSetting?.();\r\n\t\t\t},\r\n\r\n\t\t\tcheckSortableContent: function (sortableEl) {\r\n\t\t\t\tconst emptyWidgetListClass = \"empty-widget-list\";\r\n\t\t\t\tconst emptyWidgetItemClass = \"empty-widget-item\";\r\n\r\n\t\t\t\tconst emptyWidgetItem = sortableEl.querySelector(\r\n\t\t\t\t\t\".\" + emptyWidgetItemClass,\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (this.isSortableEmpty?.(sortableEl)) {\r\n\t\t\t\t\tsortableEl.classList.add(emptyWidgetListClass);\r\n\r\n\t\t\t\t\tif (!emptyWidgetItem) {\r\n\t\t\t\t\t\tjQuery(sortableEl).append(this.emptyWidgetItemMarkup ?? \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsortableEl.classList.remove(emptyWidgetListClass);\r\n\r\n\t\t\t\t\tif (emptyWidgetItem) {\r\n\t\t\t\t\t\temptyWidgetItem.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tdestroySortable: function () {\r\n\t\t\t\tif (!this.builderPanel) return;\r\n\t\t\t\tjQuery(\".wpbf-builder-panel .active-widgets\").sortable(\"destroy\");\r\n\t\t\t},\r\n\r\n\t\t\tupdateCustomizerSetting: function () {\r\n\t\t\t\tif (this.isSaving) return;\r\n\t\t\t\tthis.isSaving = true;\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (!this.availableWidgetsPanels) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst newValue: ResponsiveBuilderValue = {\r\n\t\t\t\t\t\tdesktop: { offcanvas: [], rows: {} },\r\n\t\t\t\t\t\tmobile: { offcanvas: [], rows: {} },\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tfor (const device of allowedDevices) {\r\n\t\t\t\t\t\tif (device !== \"desktop\" && device !== \"mobile\") {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst deviceBuilderPanel = this.findHtmlEl?.(\r\n\t\t\t\t\t\t\tthis.builderPanel,\r\n\t\t\t\t\t\t\t`.wpbf-builder-slots[data-device=\"${device}\"]`,\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (!deviceBuilderPanel) return;\r\n\r\n\t\t\t\t\t\tconst sortableEl = this.findHtmlEl?.(\r\n\t\t\t\t\t\t\tdeviceBuilderPanel,\r\n\t\t\t\t\t\t\t\".builder-offcanvas .active-widgets\",\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tconst widgetItems = this.findHtmlEls?.(sortableEl, \".widget-item\");\r\n\r\n\t\t\t\t\t\twidgetItems?.forEach((widgetItem) => {\r\n\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"empty-widget-item\")) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"ui-sortable-placeholder\")) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\r\n\t\t\t\t\t\t\tif (!widgetKey) return;\r\n\r\n\t\t\t\t\t\t\tif (!newValue[device].offcanvas) {\r\n\t\t\t\t\t\t\t\tnewValue[device].offcanvas = [];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnewValue[device].offcanvas.push(widgetKey);\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tconst builderRows = this.findHtmlEls?.(\r\n\t\t\t\t\t\t\tdeviceBuilderPanel,\r\n\t\t\t\t\t\t\t\".builder-row\",\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (!builderRows || !builderRows.length) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbuilderRows.forEach((row) => {\r\n\t\t\t\t\t\t\tconst rowKey = row.dataset.rowKey;\r\n\t\t\t\t\t\t\tif (!rowKey) return;\r\n\r\n\t\t\t\t\t\t\tconst sortableColumns = this.findHtmlEls?.(\r\n\t\t\t\t\t\t\t\trow,\r\n\t\t\t\t\t\t\t\t\".active-widgets\",\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (!sortableColumns || !sortableColumns.length) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tnewValue[device].rows[rowKey] = {};\r\n\r\n\t\t\t\t\t\t\tsortableColumns.forEach((column) => {\r\n\t\t\t\t\t\t\t\tconst columnKey = column.dataset.columnKey;\r\n\t\t\t\t\t\t\t\tif (!columnKey) return;\r\n\r\n\t\t\t\t\t\t\t\tnewValue[device].rows[rowKey][columnKey] = [];\r\n\r\n\t\t\t\t\t\t\t\tconst widgetItems = this.findHtmlEls?.(column, \".widget-item\");\r\n\r\n\t\t\t\t\t\t\t\tif (!widgetItems || !widgetItems.length) {\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\twidgetItems.forEach((widgetItem) => {\r\n\t\t\t\t\t\t\t\t\tif (widgetItem.classList.contains(\"empty-widget-item\")) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\twidgetItem.classList.contains(\"ui-sortable-placeholder\")\r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst widgetKey = widgetItem.dataset.widgetKey;\r\n\t\t\t\t\t\t\t\t\tif (!widgetKey) return;\r\n\r\n\t\t\t\t\t\t\t\t\tnewValue[device].rows[rowKey][columnKey].push(widgetKey);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.setting?.set(newValue);\r\n\t\t\t\t\tthis.isSaving = false;\r\n\t\t\t\t}, 1);\r\n\t\t\t},\r\n\r\n\t\t\t// Update available-widgets & active-widgets.\r\n\t\t\tupdateComponentState: function (value) {},\r\n\t\t});\r\n})(window.wp.customize);\r\n"],"names":["customizer","allowedDevices","controlConstructor","wpbfDynamicControl","extend","isSaving","draggableData","emptyWidgetItemMarkup","availableWidgetsPanels","desktop","mobile","builderPanel","initWpbfControl","ctrl","control","this","setting","bind","value","updateComponentState","buildAvailableWidgetsPanel","buildBuilderPanel","initDraggable","initDroppable","window","setTimeout","initSortable","isSortableEmpty","sortableEl","children","findHtmlEls","length","i","child","classList","contains","isWidgetActive","widgetKey","device","params","activeWidgetKeys","builder","includes","findWidgetByKey","availableWidgets","widget","key","container","controlForm","findHtmlEl","hasOwnProperty","$availableWidgetPanel","jQuery","addClass","attr","appendTo","$availableWidgetListEl","forEach","html","label","on","e","handleWidgetClick","document","body","append","customizePreview","$builderPanel","id","insertAfter","emptyWidgetListClass","$builderSlotsEl","$mobileBuilderRows","availableSlots","offcanvas","$builderOffcanvas","$builderInnerOffcanvas","handleRowSettingClick","$offcanvasWidgetsEl","newWidgetItem","createWidgetItem","rows","$rowsWrapper","row","$row","$innerRow","text","matchedRow","columns","column","columnIndex","columnPosClass","endsWith","$widgetListEl","Object","keys","matchedColumn","bindCustomizeSection","rowKey","section","expand","expanded","querySelector","add","remove","widgetEl","widgetData","connectedSection","dragHelper","availableWidgetItems","item","HTMLElement","addEventListener","DragEvent","dataset","dataTransfer","setData","JSON","stringify","innerHTML","outerHTML","draggedElRect","getBoundingClientRect","draggedElFixedLeftPos","left","draggedElFixedTopPos","top","style","dragHelperInnerEl","innerElRect","dragHelperInnerElWidth","width","setDragImage","preventDefault","removeAttribute","builderDropZones","dropZone","widgetItem","getWidgetItemFromDraggableData","area","closest","temporaryWidgetItem","removeChild","insertBefore","firstChild","appendChild","emptyWidgetItem","sortable","updateCustomizerSetting","parseDraggableData","data","getData","parsedJson","parse","console","error","insideBuilderPanel","widgetItemToClone","cloneNode","deleteButton","createElement","type","className","stopPropagation","handleDeleteActiveWidget","connectWith","placeholder","start","ui","labelEl","update","target","checkSortableContent","stop","activeWidgetEl","availableWidgetEl","sortableEL","destroySortable","newValue","deviceBuilderPanel","widgetItems","push","builderRows","sortableColumns","columnKey","set","wp","customize"],"mappings":"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"}